"use strict";(globalThis.webpackChunkgithub_docs=globalThis.webpackChunkgithub_docs||[]).push([[4930],{590:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>t,frontMatter:()=>i,metadata:()=>d,toc:()=>h});const d=JSON.parse('{"id":"alembic/basic/upgrade-downgrade","title":"Upgrade\uc640 Downgrade","description":"\ub9c8\uc774\uadf8\ub808\uc774\uc158\uc744 \uc2e4\ud589\ud558\uace0 \ub864\ubc31\ud558\ub294 \ubc29\ubc95\uc744 \ubc30\uc6cc\ubd05\uc2dc\ub2e4!","source":"@site/docs/alembic/basic/upgrade-downgrade.md","sourceDirName":"alembic/basic","slug":"/alembic/basic/upgrade-downgrade","permalink":"/tobias-docs/comp-2/docs/alembic/basic/upgrade-downgrade","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/alembic/basic/upgrade-downgrade.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"alembicSidebar","previous":{"title":"\uccab \ubc88\uc9f8 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ub9cc\ub4e4\uae30","permalink":"/tobias-docs/comp-2/docs/alembic/basic/first-migration"},"next":{"title":"\ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud788\uc2a4\ud1a0\ub9ac","permalink":"/tobias-docs/comp-2/docs/alembic/basic/history"}}');var l=a(4848),r=a(8453);const i={sidebar_position:4},s="Upgrade\uc640 Downgrade",c={},h=[{value:"\ud83c\udfaf \ud559\uc2b5 \ubaa9\ud45c",id:"-\ud559\uc2b5-\ubaa9\ud45c",level:2},{value:"\u2b06\ufe0f Upgrade: \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5c5\uadf8\ub808\uc774\ub4dc",id:"\ufe0f-upgrade-\ub370\uc774\ud130\ubca0\uc774\uc2a4-\uc5c5\uadf8\ub808\uc774\ub4dc",level:2},{value:"\uae30\ubcf8 \uba85\ub839\uc5b4",id:"\uae30\ubcf8-\uba85\ub839\uc5b4",level:3},{value:"\uc2e4\ud589 \uc608\uc2dc",id:"\uc2e4\ud589-\uc608\uc2dc",level:3},{value:"\u2b07\ufe0f Downgrade: \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc",id:"\ufe0f-downgrade-\ub370\uc774\ud130\ubca0\uc774\uc2a4-\ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc",level:2},{value:"\uae30\ubcf8 \uba85\ub839\uc5b4",id:"\uae30\ubcf8-\uba85\ub839\uc5b4-1",level:3},{value:"\uc2e4\ud589 \uc608\uc2dc",id:"\uc2e4\ud589-\uc608\uc2dc-1",level:3},{value:"\ud83d\udcca \ud604\uc7ac \uc0c1\ud0dc \ud655\uc778",id:"-\ud604\uc7ac-\uc0c1\ud0dc-\ud655\uc778",level:2},{value:"current: \ud604\uc7ac \ub9ac\ube44\uc804 \ud655\uc778",id:"current-\ud604\uc7ac-\ub9ac\ube44\uc804-\ud655\uc778",level:3},{value:"show: \ud2b9\uc815 \ub9ac\ube44\uc804 \uc815\ubcf4 \ubcf4\uae30",id:"show-\ud2b9\uc815-\ub9ac\ube44\uc804-\uc815\ubcf4-\ubcf4\uae30",level:3},{value:"\ud83d\udd04 \uc2e4\uc804 \uc2dc\ub098\ub9ac\uc624",id:"-\uc2e4\uc804-\uc2dc\ub098\ub9ac\uc624",level:2},{value:"\uc2dc\ub098\ub9ac\uc624 1: \uc0c8 \uae30\ub2a5 \ubc30\ud3ec",id:"\uc2dc\ub098\ub9ac\uc624-1-\uc0c8-\uae30\ub2a5-\ubc30\ud3ec",level:3},{value:"\uc2dc\ub098\ub9ac\uc624 2: \uae34\uae09 \ub864\ubc31",id:"\uc2dc\ub098\ub9ac\uc624-2-\uae34\uae09-\ub864\ubc31",level:3},{value:"\uc2dc\ub098\ub9ac\uc624 3: \ud2b9\uc815 \ubc84\uc804\uc73c\ub85c \uc810\ud504",id:"\uc2dc\ub098\ub9ac\uc624-3-\ud2b9\uc815-\ubc84\uc804\uc73c\ub85c-\uc810\ud504",level:3},{value:"\ud83c\udf93 \ubc84\uc804 \uc9c0\uc815 \ubc29\ubc95",id:"-\ubc84\uc804-\uc9c0\uc815-\ubc29\ubc95",level:2},{value:"\uc808\ub300 \ubc84\uc804",id:"\uc808\ub300-\ubc84\uc804",level:3},{value:"\uc0c1\ub300 \ubc84\uc804",id:"\uc0c1\ub300-\ubc84\uc804",level:3},{value:"\ubc94\uc704 \uc9c0\uc815",id:"\ubc94\uc704-\uc9c0\uc815",level:3},{value:"\ud83e\uddea \ud14c\uc2a4\ud2b8 \ud328\ud134",id:"-\ud14c\uc2a4\ud2b8-\ud328\ud134",level:2},{value:"\uc5c5\uadf8\ub808\uc774\ub4dc/\ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc \uc0ac\uc774\ud074 \ud14c\uc2a4\ud2b8",id:"\uc5c5\uadf8\ub808\uc774\ub4dc\ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc-\uc0ac\uc774\ud074-\ud14c\uc2a4\ud2b8",level:3},{value:"SQL \ubaa8\ub4dc\ub85c \ubbf8\ub9ac \ud655\uc778",id:"sql-\ubaa8\ub4dc\ub85c-\ubbf8\ub9ac-\ud655\uc778",level:3},{value:"\ud83d\udcdd \uc2e4\uc804 \uc608\uc81c: \ub2e8\uacc4\ubcc4 \ub9c8\uc774\uadf8\ub808\uc774\uc158",id:"-\uc2e4\uc804-\uc608\uc81c-\ub2e8\uacc4\ubcc4-\ub9c8\uc774\uadf8\ub808\uc774\uc158",level:2},{value:"1. \uccab \ubc88\uc9f8 \ub9c8\uc774\uadf8\ub808\uc774\uc158",id:"1-\uccab-\ubc88\uc9f8-\ub9c8\uc774\uadf8\ub808\uc774\uc158",level:3},{value:"2. \ub450 \ubc88\uc9f8 \ub9c8\uc774\uadf8\ub808\uc774\uc158",id:"2-\ub450-\ubc88\uc9f8-\ub9c8\uc774\uadf8\ub808\uc774\uc158",level:3},{value:"3. \uc138 \ubc88\uc9f8 \ub9c8\uc774\uadf8\ub808\uc774\uc158",id:"3-\uc138-\ubc88\uc9f8-\ub9c8\uc774\uadf8\ub808\uc774\uc158",level:3},{value:"\uc774\ub3d9 \ud14c\uc2a4\ud2b8",id:"\uc774\ub3d9-\ud14c\uc2a4\ud2b8",level:3},{value:"\u26a0\ufe0f \uc8fc\uc758\uc0ac\ud56d",id:"\ufe0f-\uc8fc\uc758\uc0ac\ud56d",level:2},{value:"1. \ub370\uc774\ud130 \uc190\uc2e4 \uc704\ud5d8",id:"1-\ub370\uc774\ud130-\uc190\uc2e4-\uc704\ud5d8",level:3},{value:"2. \ud504\ub85c\ub355\uc158 \ub864\ubc31",id:"2-\ud504\ub85c\ub355\uc158-\ub864\ubc31",level:3},{value:"3. \ub3d9\uc2dc\uc131 \uc774\uc288",id:"3-\ub3d9\uc2dc\uc131-\uc774\uc288",level:3},{value:"\ud83d\udd0d \ud2b8\ub7ec\ube14\uc288\ud305",id:"-\ud2b8\ub7ec\ube14\uc288\ud305",level:2},{value:"\ubb38\uc81c 1: revision\uc774 \uaf2c\uc778 \uacbd\uc6b0",id:"\ubb38\uc81c-1-revision\uc774-\uaf2c\uc778-\uacbd\uc6b0",level:3},{value:"\ubb38\uc81c 2: downgrade \ubd88\uac00\ub2a5",id:"\ubb38\uc81c-2-downgrade-\ubd88\uac00\ub2a5",level:3},{value:"\ud83d\udcda \ubca0\uc2a4\ud2b8 \ud504\ub799\ud2f0\uc2a4",id:"-\ubca0\uc2a4\ud2b8-\ud504\ub799\ud2f0\uc2a4",level:2},{value:"1. \ud56d\uc0c1 \ud14c\uc2a4\ud2b8 \uba3c\uc800",id:"1-\ud56d\uc0c1-\ud14c\uc2a4\ud2b8-\uba3c\uc800",level:3},{value:"2. \uc791\uc740 \ub2e8\uc704\ub85c \ub9c8\uc774\uadf8\ub808\uc774\uc158",id:"2-\uc791\uc740-\ub2e8\uc704\ub85c-\ub9c8\uc774\uadf8\ub808\uc774\uc158",level:3},{value:"3. \ud504\ub85c\ub355\uc158 \ubc30\ud3ec \uccb4\ud06c\ub9ac\uc2a4\ud2b8",id:"3-\ud504\ub85c\ub355\uc158-\ubc30\ud3ec-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",level:3},{value:"\u2705 \ud575\uc2ec \uc815\ub9ac",id:"-\ud575\uc2ec-\uc815\ub9ac",level:2},{value:"\ud83d\udcda \ub2e4\uc74c \ub2e8\uacc4",id:"-\ub2e4\uc74c-\ub2e8\uacc4",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"upgrade\uc640-downgrade",children:"Upgrade\uc640 Downgrade"})}),"\n",(0,l.jsx)(n.p,{children:"\ub9c8\uc774\uadf8\ub808\uc774\uc158\uc744 \uc2e4\ud589\ud558\uace0 \ub864\ubc31\ud558\ub294 \ubc29\ubc95\uc744 \ubc30\uc6cc\ubd05\uc2dc\ub2e4!"}),"\n",(0,l.jsx)(n.h2,{id:"-\ud559\uc2b5-\ubaa9\ud45c",children:"\ud83c\udfaf \ud559\uc2b5 \ubaa9\ud45c"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"upgrade\uc640 downgrade\uc758 \ucc28\uc774\uc810 \uc774\ud574"}),"\n",(0,l.jsx)(n.li,{children:"\ub2e4\uc591\ud55c \ubc84\uc804 \uc774\ub3d9 \ubc29\ubc95"}),"\n",(0,l.jsx)(n.li,{children:"\ub9c8\uc774\uadf8\ub808\uc774\uc158 \uc0c1\ud0dc \ud655\uc778"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\ufe0f-upgrade-\ub370\uc774\ud130\ubca0\uc774\uc2a4-\uc5c5\uadf8\ub808\uc774\ub4dc",children:"\u2b06\ufe0f Upgrade: \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5c5\uadf8\ub808\uc774\ub4dc"}),"\n",(0,l.jsx)(n.h3,{id:"\uae30\ubcf8-\uba85\ub839\uc5b4",children:"\uae30\ubcf8 \uba85\ub839\uc5b4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \ucd5c\uc2e0 \ubc84\uc804\uc73c\ub85c \uc5c5\uadf8\ub808\uc774\ub4dc (\uac00\uc7a5 \ub9ce\uc774 \uc0ac\uc6a9)\nalembic upgrade head\n\n# \ud2b9\uc815 \ub9ac\ube44\uc804\uc73c\ub85c \uc5c5\uadf8\ub808\uc774\ub4dc\nalembic upgrade 2f8b9c3d1a5e\n\n# \uc0c1\ub300\uc801\uc73c\ub85c N\uac1c \ubc84\uc804 \uc62c\ub9ac\uae30\nalembic upgrade +2\n\n# \ub2e4\uc74c \ubc84\uc804 \ud558\ub098\ub9cc\nalembic upgrade +1\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\uc2e4\ud589-\uc608\uc2dc",children:"\uc2e4\ud589 \uc608\uc2dc"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"$ alembic upgrade head\nINFO  [alembic.runtime.migration] Context impl SQLiteImpl.\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\nINFO  [alembic.runtime.migration] Running upgrade  -> 2f8b9c3d1a5e, create users table\nINFO  [alembic.runtime.migration] Running upgrade 2f8b9c3d1a5e -> 3a7c4e8f2b1d, create posts table\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\ufe0f-downgrade-\ub370\uc774\ud130\ubca0\uc774\uc2a4-\ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc",children:"\u2b07\ufe0f Downgrade: \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc"}),"\n",(0,l.jsx)(n.h3,{id:"\uae30\ubcf8-\uba85\ub839\uc5b4-1",children:"\uae30\ubcf8 \uba85\ub839\uc5b4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \uc774\uc804 \ubc84\uc804\uc73c\ub85c \ub864\ubc31\nalembic downgrade -1\n\n# \ud2b9\uc815 \ub9ac\ube44\uc804\uc73c\ub85c \ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc\nalembic downgrade 2f8b9c3d1a5e\n\n# \ubaa8\ub4e0 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ub418\ub3cc\ub9ac\uae30\nalembic downgrade base\n\n# \uc0c1\ub300\uc801\uc73c\ub85c N\uac1c \ubc84\uc804 \ub0b4\ub9ac\uae30\nalembic downgrade -2\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\uc2e4\ud589-\uc608\uc2dc-1",children:"\uc2e4\ud589 \uc608\uc2dc"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"$ alembic downgrade -1\nINFO  [alembic.runtime.migration] Context impl SQLiteImpl.\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\nINFO  [alembic.runtime.migration] Running downgrade 3a7c4e8f2b1d -> 2f8b9c3d1a5e, create posts table\n"})}),"\n",(0,l.jsx)(n.h2,{id:"-\ud604\uc7ac-\uc0c1\ud0dc-\ud655\uc778",children:"\ud83d\udcca \ud604\uc7ac \uc0c1\ud0dc \ud655\uc778"}),"\n",(0,l.jsx)(n.h3,{id:"current-\ud604\uc7ac-\ub9ac\ube44\uc804-\ud655\uc778",children:"current: \ud604\uc7ac \ub9ac\ube44\uc804 \ud655\uc778"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"alembic current\n\n# \ucd9c\ub825 \uc608\uc2dc:\n# 2f8b9c3d1a5e (head)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"show-\ud2b9\uc815-\ub9ac\ube44\uc804-\uc815\ubcf4-\ubcf4\uae30",children:"show: \ud2b9\uc815 \ub9ac\ube44\uc804 \uc815\ubcf4 \ubcf4\uae30"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"alembic show 2f8b9c3d1a5e\n\n# \ucd9c\ub825 \uc608\uc2dc:\n# Rev: 2f8b9c3d1a5e\n# Parent: <base>\n# Path: /path/to/versions/2f8b9c3d1a5e_create_users_table.py\n#\n#     create users table\n#\n#     Revision ID: 2f8b9c3d1a5e\n#     Revises:\n#     Create Date: 2024-01-15 10:30:45.123456\n"})}),"\n",(0,l.jsx)(n.h2,{id:"-\uc2e4\uc804-\uc2dc\ub098\ub9ac\uc624",children:"\ud83d\udd04 \uc2e4\uc804 \uc2dc\ub098\ub9ac\uc624"}),"\n",(0,l.jsx)(n.h3,{id:"\uc2dc\ub098\ub9ac\uc624-1-\uc0c8-\uae30\ub2a5-\ubc30\ud3ec",children:"\uc2dc\ub098\ub9ac\uc624 1: \uc0c8 \uae30\ub2a5 \ubc30\ud3ec"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# 1. \uc0c8 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uc0dd\uc131\nalembic revision -m "add user profile fields"\n\n# 2. \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud30c\uc77c \uc791\uc131\n# ... (upgrade/downgrade \ud568\uc218 \uad6c\ud604)\n\n# 3. \ub85c\uceec \ud14c\uc2a4\ud2b8\nalembic upgrade head\n\n# 4. \ubb38\uc81c \uc5c6\uc73c\uba74 Git \ucee4\ubc0b\ngit add alembic/versions/*.py\ngit commit -m "Add user profile fields migration"\n\n# 5. \ud504\ub85c\ub355\uc158 \ubc30\ud3ec\n# (\uc11c\ubc84\uc5d0\uc11c)\nalembic upgrade head\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\uc2dc\ub098\ub9ac\uc624-2-\uae34\uae09-\ub864\ubc31",children:"\uc2dc\ub098\ub9ac\uc624 2: \uae34\uae09 \ub864\ubc31"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \ud504\ub85c\ub355\uc158\uc5d0\uc11c \ubb38\uc81c \ubc1c\uacac!\n\n# 1. \ud604\uc7ac \uc0c1\ud0dc \ud655\uc778\nalembic current\n# 3a7c4e8f2b1d (head)\n\n# 2. \uc774\uc804 \ubc84\uc804\uc73c\ub85c \ub864\ubc31\nalembic downgrade -1\n\n# 3. \ud655\uc778\nalembic current\n# 2f8b9c3d1a5e\n\n# 4. \uc560\ud50c\ub9ac\ucf00\uc774\uc158\ub3c4 \uc774\uc804 \ubc84\uc804\uc73c\ub85c \ubc30\ud3ec\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\uc2dc\ub098\ub9ac\uc624-3-\ud2b9\uc815-\ubc84\uc804\uc73c\ub85c-\uc810\ud504",children:"\uc2dc\ub098\ub9ac\uc624 3: \ud2b9\uc815 \ubc84\uc804\uc73c\ub85c \uc810\ud504"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \ud604\uc7ac: 5\ubc88\uc9f8 \ub9c8\uc774\uadf8\ub808\uc774\uc158\n# \ubaa9\ud45c: 2\ubc88\uc9f8 \ub9c8\uc774\uadf8\ub808\uc774\uc158\uc73c\ub85c \uc774\ub3d9\n\n# \ubc29\ubc95 1: \ub9ac\ube44\uc804 ID \uc0ac\uc6a9\nalembic downgrade 2f8b9c3d1a5e\n\n# \ubc29\ubc95 2: \uc0c1\ub300\uc801 \uc774\ub3d9\nalembic downgrade -3\n\n# \ub2e4\uc2dc \ucd5c\uc2e0\uc73c\ub85c\nalembic upgrade head\n"})}),"\n",(0,l.jsx)(n.h2,{id:"-\ubc84\uc804-\uc9c0\uc815-\ubc29\ubc95",children:"\ud83c\udf93 \ubc84\uc804 \uc9c0\uc815 \ubc29\ubc95"}),"\n",(0,l.jsx)(n.h3,{id:"\uc808\ub300-\ubc84\uc804",children:"\uc808\ub300 \ubc84\uc804"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \ud2b9\uc815 \ub9ac\ube44\uc804 ID\nalembic upgrade 2f8b9c3d1a5e\n\n# head (\ucd5c\uc2e0)\nalembic upgrade head\n\n# base (\ucd08\uae30 \uc0c1\ud0dc)\nalembic downgrade base\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\uc0c1\ub300-\ubc84\uc804",children:"\uc0c1\ub300 \ubc84\uc804"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \ud604\uc7ac\uc5d0\uc11c +N \ubc84\uc804 \uc62c\ub9ac\uae30\nalembic upgrade +1\nalembic upgrade +2\n\n# \ud604\uc7ac\uc5d0\uc11c -N \ubc84\uc804 \ub0b4\ub9ac\uae30\nalembic downgrade -1\nalembic downgrade -2\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\ubc94\uc704-\uc9c0\uc815",children:"\ubc94\uc704 \uc9c0\uc815"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# from:to \ud615\uc2dd\uc73c\ub85c \ubc94\uc704 \uc9c0\uc815\nalembic upgrade 2f8b9c3d1a5e:head\nalembic downgrade head:2f8b9c3d1a5e\n"})}),"\n",(0,l.jsx)(n.h2,{id:"-\ud14c\uc2a4\ud2b8-\ud328\ud134",children:"\ud83e\uddea \ud14c\uc2a4\ud2b8 \ud328\ud134"}),"\n",(0,l.jsx)(n.h3,{id:"\uc5c5\uadf8\ub808\uc774\ub4dc\ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc-\uc0ac\uc774\ud074-\ud14c\uc2a4\ud2b8",children:"\uc5c5\uadf8\ub808\uc774\ub4dc/\ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc \uc0ac\uc774\ud074 \ud14c\uc2a4\ud2b8"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# 1. \ud604\uc7ac \uc0c1\ud0dc \uc800\uc7a5\nalembic current > current_revision.txt\n\n# 2. \uc5c5\uadf8\ub808\uc774\ub4dc \ud14c\uc2a4\ud2b8\nalembic upgrade head\n\n# 3. \ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc \ud14c\uc2a4\ud2b8\nalembic downgrade base\n\n# 4. \ub2e4\uc2dc \uc5c5\uadf8\ub808\uc774\ub4dc\nalembic upgrade head\n\n# 5. \ub370\uc774\ud130 \ubb34\uacb0\uc131 \ud655\uc778\n# (\uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ud14c\uc2a4\ud2b8 \uc2e4\ud589)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"sql-\ubaa8\ub4dc\ub85c-\ubbf8\ub9ac-\ud655\uc778",children:"SQL \ubaa8\ub4dc\ub85c \ubbf8\ub9ac \ud655\uc778"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# SQL\ub9cc \ucd9c\ub825 (\uc2e4\uc81c \uc2e4\ud589 \uc548 \ud568)\nalembic upgrade head --sql\n\n# \uacb0\uacfc\ub97c \ud30c\uc77c\ub85c \uc800\uc7a5\nalembic upgrade head --sql > migration.sql\n\n# SQL \uac80\ud1a0 \ud6c4 \uc9c1\uc811 \uc2e4\ud589\npsql -d mydb -f migration.sql\n"})}),"\n",(0,l.jsx)(n.h2,{id:"-\uc2e4\uc804-\uc608\uc81c-\ub2e8\uacc4\ubcc4-\ub9c8\uc774\uadf8\ub808\uc774\uc158",children:"\ud83d\udcdd \uc2e4\uc804 \uc608\uc81c: \ub2e8\uacc4\ubcc4 \ub9c8\uc774\uadf8\ub808\uc774\uc158"}),"\n",(0,l.jsx)(n.p,{children:"3\uac1c\uc758 \ub9c8\uc774\uadf8\ub808\uc774\uc158\uc744 \ub9cc\ub4e4\uace0 \uc774\ub3d9\ud574\ubd05\uc2dc\ub2e4."}),"\n",(0,l.jsx)(n.h3,{id:"1-\uccab-\ubc88\uc9f8-\ub9c8\uc774\uadf8\ub808\uc774\uc158",children:"1. \uccab \ubc88\uc9f8 \ub9c8\uc774\uadf8\ub808\uc774\uc158"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'alembic revision -m "create users table"\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"# versions/aaa_create_users_table.py\ndef upgrade():\n    op.create_table('users',\n        sa.Column('id', sa.Integer(), primary_key=True),\n        sa.Column('username', sa.String(50), nullable=False)\n    )\n\ndef downgrade():\n    op.drop_table('users')\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"alembic upgrade head\n# Running upgrade  -> aaa, create users table\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-\ub450-\ubc88\uc9f8-\ub9c8\uc774\uadf8\ub808\uc774\uc158",children:"2. \ub450 \ubc88\uc9f8 \ub9c8\uc774\uadf8\ub808\uc774\uc158"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'alembic revision -m "add email to users"\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"# versions/bbb_add_email_to_users.py\ndef upgrade():\n    op.add_column('users', sa.Column('email', sa.String(100)))\n\ndef downgrade():\n    op.drop_column('users', 'email')\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"alembic upgrade head\n# Running upgrade aaa -> bbb, add email to users\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-\uc138-\ubc88\uc9f8-\ub9c8\uc774\uadf8\ub808\uc774\uc158",children:"3. \uc138 \ubc88\uc9f8 \ub9c8\uc774\uadf8\ub808\uc774\uc158"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'alembic revision -m "create posts table"\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"# versions/ccc_create_posts_table.py\ndef upgrade():\n    op.create_table('posts',\n        sa.Column('id', sa.Integer(), primary_key=True),\n        sa.Column('title', sa.String(200), nullable=False),\n        sa.Column('author_id', sa.Integer(), nullable=False),\n        sa.ForeignKeyConstraint(['author_id'], ['users.id'])\n    )\n\ndef downgrade():\n    op.drop_table('posts')\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"alembic upgrade head\n# Running upgrade bbb -> ccc, create posts table\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\uc774\ub3d9-\ud14c\uc2a4\ud2b8",children:"\uc774\ub3d9 \ud14c\uc2a4\ud2b8"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \ud604\uc7ac \uc704\uce58 \ud655\uc778\nalembic current\n# ccc (head)\n\n# \ud55c \ub2e8\uacc4 \ub4a4\ub85c\nalembic downgrade -1\nalembic current\n# bbb\n\n# \ub450 \ub2e8\uacc4 \ub4a4\ub85c\nalembic downgrade -2\nalembic current\n# aaa (base)\n\n# \ub2e4\uc2dc \ucd5c\uc2e0\uc73c\ub85c\nalembic upgrade head\nalembic current\n# ccc (head)\n\n# \ubaa8\ub450 \ub418\ub3cc\ub9ac\uae30\nalembic downgrade base\nalembic current\n# (empty)\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\ufe0f-\uc8fc\uc758\uc0ac\ud56d",children:"\u26a0\ufe0f \uc8fc\uc758\uc0ac\ud56d"}),"\n",(0,l.jsx)(n.h3,{id:"1-\ub370\uc774\ud130-\uc190\uc2e4-\uc704\ud5d8",children:"1. \ub370\uc774\ud130 \uc190\uc2e4 \uc704\ud5d8"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"# \u274c \uc704\ud5d8\ud55c \ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc\ndef downgrade():\n    op.drop_table('users')  # \ubaa8\ub4e0 \uc0ac\uc6a9\uc790 \ub370\uc774\ud130 \uc0ad\uc81c!\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"# \u2705 \uc548\uc804\ud55c \ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc (\ubc31\uc5c5 \ud3ec\ud568)\ndef upgrade():\n    op.create_table('users_new', ...)\n    op.execute('INSERT INTO users_new SELECT * FROM users')\n    op.drop_table('users')\n    op.rename_table('users_new', 'users')\n\ndef downgrade():\n    # \ubc31\uc5c5 \ud14c\uc774\ube14\uc774 \uc788\ub2e4\uba74 \ubcf5\uc6d0 \uac00\ub2a5\n    pass\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-\ud504\ub85c\ub355\uc158-\ub864\ubc31",children:"2. \ud504\ub85c\ub355\uc158 \ub864\ubc31"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u274c \uc808\ub300 \ud558\uc9c0 \ub9d0 \uac83\nalembic downgrade base  # \ubaa8\ub4e0 \ub370\uc774\ud130 \uc0ad\uc81c \uc704\ud5d8!\n\n# \u2705 \uc548\uc804\ud55c \ub864\ubc31\nalembic downgrade -1    # \ud55c \ub2e8\uacc4\ub9cc\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-\ub3d9\uc2dc\uc131-\uc774\uc288",children:"3. \ub3d9\uc2dc\uc131 \uc774\uc288"}),"\n",(0,l.jsx)(n.p,{children:"\uc5ec\ub7ec \uc11c\ubc84\uc5d0\uc11c \ub3d9\uc2dc\uc5d0 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uc2e4\ud589 \ubc29\uc9c0:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \ub77d \uba54\ucee4\ub2c8\uc998 \uc0ac\uc6a9\n# alembic\uc740 alembic_version \ud14c\uc774\ube14\ub85c \uc0c1\ud0dc \uad00\ub9ac\n# \ub3d9\uc2dc \uc2e4\ud589 \uc2dc \uc790\ub3d9\uc73c\ub85c \uc5d0\ub7ec \ubc1c\uc0dd\n"})}),"\n",(0,l.jsx)(n.h2,{id:"-\ud2b8\ub7ec\ube14\uc288\ud305",children:"\ud83d\udd0d \ud2b8\ub7ec\ube14\uc288\ud305"}),"\n",(0,l.jsx)(n.h3,{id:"\ubb38\uc81c-1-revision\uc774-\uaf2c\uc778-\uacbd\uc6b0",children:"\ubb38\uc81c 1: revision\uc774 \uaf2c\uc778 \uacbd\uc6b0"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"$ alembic upgrade head\nError: Can't locate revision identified by 'xxxxx'\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\ud574\uacb0\ubc29\ubc95"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# 1. \ud604\uc7ac DB \ubc84\uc804 \ud655\uc778\nSELECT * FROM alembic_version;\n\n# 2. versions \ub514\ub809\ud1a0\ub9ac \ud30c\uc77c \ud655\uc778\nls alembic/versions/\n\n# 3. \ubc84\uc804 \ud14c\uc774\ube14 \uc218\ub3d9 \uc218\uc815 (\uc8fc\uc758!)\nUPDATE alembic_version SET version_num = 'correct_revision_id';\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\ubb38\uc81c-2-downgrade-\ubd88\uac00\ub2a5",children:"\ubb38\uc81c 2: downgrade \ubd88\uac00\ub2a5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"$ alembic downgrade -1\nError: Target database is not up to date.\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\ud574\uacb0\ubc29\ubc95"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \ud604\uc7ac \uc0c1\ud0dc \ud655\uc778\nalembic current\n\n# \ud788\uc2a4\ud1a0\ub9ac \ud655\uc778\nalembic history\n\n# \uac15\uc81c \ubc84\uc804 \uc124\uc815 (\ub9e4\uc6b0 \uc8fc\uc758!)\nalembic stamp head\n"})}),"\n",(0,l.jsx)(n.h2,{id:"-\ubca0\uc2a4\ud2b8-\ud504\ub799\ud2f0\uc2a4",children:"\ud83d\udcda \ubca0\uc2a4\ud2b8 \ud504\ub799\ud2f0\uc2a4"}),"\n",(0,l.jsx)(n.h3,{id:"1-\ud56d\uc0c1-\ud14c\uc2a4\ud2b8-\uba3c\uc800",children:"1. \ud56d\uc0c1 \ud14c\uc2a4\ud2b8 \uba3c\uc800"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \ub85c\uceec/\uac1c\ubc1c \ud658\uacbd\uc5d0\uc11c \uba3c\uc800 \ud14c\uc2a4\ud2b8\nalembic upgrade head\nalembic downgrade -1\nalembic upgrade head\n# \ubaa8\ub4e0 \ud14c\uc2a4\ud2b8 \ud1b5\uacfc \ud6c4 \ubc30\ud3ec\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-\uc791\uc740-\ub2e8\uc704\ub85c-\ub9c8\uc774\uadf8\ub808\uc774\uc158",children:"2. \uc791\uc740 \ub2e8\uc704\ub85c \ub9c8\uc774\uadf8\ub808\uc774\uc158"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# \u274c \ub098\uc05c \uc608: \ud55c \ubc88\uc5d0 \ub9ce\uc740 \ubcc0\uacbd\nalembic revision -m "add 10 tables and modify 5 columns"\n\n# \u2705 \uc88b\uc740 \uc608: \ub17c\ub9ac\uc801 \ub2e8\uc704\ub85c \ubd84\ub9ac\nalembic revision -m "add users table"\nalembic revision -m "add posts table"\nalembic revision -m "add email column to users"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"3-\ud504\ub85c\ub355\uc158-\ubc30\ud3ec-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",children:"3. \ud504\ub85c\ub355\uc158 \ubc30\ud3ec \uccb4\ud06c\ub9ac\uc2a4\ud2b8"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# 1. \ubc31\uc5c5\npg_dump mydb > backup_$(date +%Y%m%d).sql\n\n# 2. \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud14c\uc2a4\ud2b8 (SQL \ubaa8\ub4dc)\nalembic upgrade head --sql > migration.sql\n# SQL \uac80\ud1a0\n\n# 3. \uc2e4\ud589\nalembic upgrade head\n\n# 4. \uac80\uc99d\nalembic current\n# \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ud14c\uc2a4\ud2b8\n\n# 5. \ubb38\uc81c \ubc1c\uc0dd \uc2dc \ub864\ubc31 \uc900\ube44\nalembic downgrade -1\n"})}),"\n",(0,l.jsx)(n.h2,{id:"-\ud575\uc2ec-\uc815\ub9ac",children:"\u2705 \ud575\uc2ec \uc815\ub9ac"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\uba85\ub839\uc5b4"}),(0,l.jsx)(n.th,{children:"\uc124\uba85"}),(0,l.jsx)(n.th,{children:"\uc0ac\uc6a9 \uc608\uc2dc"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"upgrade head"})}),(0,l.jsx)(n.td,{children:"\ucd5c\uc2e0 \ubc84\uc804\uc73c\ub85c"}),(0,l.jsx)(n.td,{children:"\ubc30\ud3ec \uc2dc"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"downgrade -1"})}),(0,l.jsx)(n.td,{children:"\ud55c \ub2e8\uacc4 \ub4a4\ub85c"}),(0,l.jsx)(n.td,{children:"\ub864\ubc31 \uc2dc"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"current"})}),(0,l.jsx)(n.td,{children:"\ud604\uc7ac \ubc84\uc804 \ud655\uc778"}),(0,l.jsx)(n.td,{children:"\uc0c1\ud0dc \ud655\uc778"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"upgrade +N"})}),(0,l.jsx)(n.td,{children:"N\ub2e8\uacc4 \uc55e\uc73c\ub85c"}),(0,l.jsx)(n.td,{children:"\ubd80\ubd84 \uc5c5\uadf8\ub808\uc774\ub4dc"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"downgrade base"})}),(0,l.jsx)(n.td,{children:"\ubaa8\ub450 \ub418\ub3cc\ub9ac\uae30"}),(0,l.jsx)(n.td,{children:"\uac1c\ubc1c \ud658\uacbd \ucd08\uae30\ud654"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"-\ub2e4\uc74c-\ub2e8\uacc4",children:"\ud83d\udcda \ub2e4\uc74c \ub2e8\uacc4"}),"\n",(0,l.jsx)(n.p,{children:"\ub9c8\uc774\uadf8\ub808\uc774\uc158 \uc2e4\ud589 \ubc29\ubc95\uc744 \ubc30\uc6e0\uc73c\ub2c8, \uc774\uc81c \ud788\uc2a4\ud1a0\ub9ac\ub97c \uad00\ub9ac\ud558\ub294 \ubc29\ubc95\uc744 \uc54c\uc544\ubd05\uc2dc\ub2e4!"}),"\n",(0,l.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,l.jsx)(n.a,{href:"./history",children:"\ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud788\uc2a4\ud1a0\ub9ac"})]})]})}function t(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>i,x:()=>s});var d=a(6540);const l={},r=d.createContext(l);function i(e){const n=d.useContext(r);return d.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),d.createElement(r.Provider,{value:n},e.children)}}}]);