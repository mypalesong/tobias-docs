"use strict";(globalThis.webpackChunkgithub_docs=globalThis.webpackChunkgithub_docs||[]).push([[7162],{2448:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"webapp/security","title":"11. \ubcf4\uc548","description":"\uc6f9 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ubcf4\uc548\uc740 \uc0ac\uc6a9\uc790 \ub370\uc774\ud130\ub97c \ubcf4\ud638\ud558\uace0 \uc2dc\uc2a4\ud15c\uc758 \ubb34\uacb0\uc131\uc744 \uc720\uc9c0\ud558\ub294 \ub370 \ud544\uc218\uc801\uc785\ub2c8\ub2e4. \uc774 \ubb38\uc11c\uc5d0\uc11c\ub294 \uc8fc\uc694 \ubcf4\uc548 \uc704\ud611\uacfc \ubc29\uc5b4 \uae30\ubc95\uc744 \ub2e4\ub8f9\ub2c8\ub2e4.","source":"@site/docs/webapp/security.md","sourceDirName":"webapp","slug":"/webapp/security","permalink":"/tobias-docs/comp-2/docs/webapp/security","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/webapp/security.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12},"sidebar":"webappSidebar","previous":{"title":"10. \uc5d0\ub7ec \ucc98\ub9ac \ubc0f \ub85c\uae45","permalink":"/tobias-docs/comp-2/docs/webapp/error-handling"},"next":{"title":"12. \uc131\ub2a5 \ucd5c\uc801\ud654","permalink":"/tobias-docs/comp-2/docs/webapp/performance"}}');var t=s(4848),i=s(8453);const a={sidebar_position:12},o="11. \ubcf4\uc548",c={},l=[{value:"11.1 \uc6f9 \ubcf4\uc548 \uac1c\uc694",id:"111-\uc6f9-\ubcf4\uc548-\uac1c\uc694",level:2},{value:"11.1.1 \ubcf4\uc548\uc758 \uc911\uc694\uc131",id:"1111-\ubcf4\uc548\uc758-\uc911\uc694\uc131",level:3},{value:"11.1.2 \ubcf4\uc548\uc758 3\ub300 \uc6d0\uce59 (CIA Triad)",id:"1112-\ubcf4\uc548\uc758-3\ub300-\uc6d0\uce59-cia-triad",level:3},{value:"11.1.3 \ubcf4\uc548 \uc124\uacc4 \uc6d0\uce59",id:"1113-\ubcf4\uc548-\uc124\uacc4-\uc6d0\uce59",level:3},{value:"11.2 OWASP Top 10 \uc124\uba85",id:"112-owasp-top-10-\uc124\uba85",level:2},{value:"11.2.1 OWASP Top 10 (2021)",id:"1121-owasp-top-10-2021",level:3},{value:"11.2.2 A01: Broken Access Control",id:"1122-a01-broken-access-control",level:3},{value:"11.2.3 A02: Cryptographic Failures",id:"1123-a02-cryptographic-failures",level:3},{value:"11.3 SQL Injection \ubc29\uc5b4",id:"113-sql-injection-\ubc29\uc5b4",level:2},{value:"11.3.1 SQL Injection \uacf5\uaca9 \uc608\uc2dc",id:"1131-sql-injection-\uacf5\uaca9-\uc608\uc2dc",level:3},{value:"11.3.2 Prepared Statements \uc0ac\uc6a9",id:"1132-prepared-statements-\uc0ac\uc6a9",level:3},{value:"11.3.3 ORM \uc0ac\uc6a9",id:"1133-orm-\uc0ac\uc6a9",level:3},{value:"11.4 XSS (Cross-Site Scripting) \ubc29\uc5b4",id:"114-xss-cross-site-scripting-\ubc29\uc5b4",level:2},{value:"11.4.1 XSS \uacf5\uaca9 \uc720\ud615",id:"1141-xss-\uacf5\uaca9-\uc720\ud615",level:3},{value:"Reflected XSS (\ubc18\uc0ac\ud615)",id:"reflected-xss-\ubc18\uc0ac\ud615",level:4},{value:"Stored XSS (\uc800\uc7a5\ud615)",id:"stored-xss-\uc800\uc7a5\ud615",level:4},{value:"11.4.2 XSS \ubc29\uc5b4 \ubc29\ubc95",id:"1142-xss-\ubc29\uc5b4-\ubc29\ubc95",level:3},{value:"11.4.3 React\uc5d0\uc11c\uc758 XSS \ubc29\uc5b4",id:"1143-react\uc5d0\uc11c\uc758-xss-\ubc29\uc5b4",level:3},{value:"11.5 CSRF (Cross-Site Request Forgery) \ubc29\uc5b4",id:"115-csrf-cross-site-request-forgery-\ubc29\uc5b4",level:2},{value:"11.5.1 CSRF \uacf5\uaca9 \uc608\uc2dc",id:"1151-csrf-\uacf5\uaca9-\uc608\uc2dc",level:3},{value:"11.5.2 CSRF Token \uc0ac\uc6a9",id:"1152-csrf-token-\uc0ac\uc6a9",level:3},{value:"11.5.3 \ud074\ub77c\uc774\uc5b8\ud2b8 \uce21 \uad6c\ud604",id:"1153-\ud074\ub77c\uc774\uc5b8\ud2b8-\uce21-\uad6c\ud604",level:3},{value:"11.5.4 SameSite Cookie \uc18d\uc131",id:"1154-samesite-cookie-\uc18d\uc131",level:3},{value:"11.6 CORS \ubcf4\uc548 \uc124\uc815",id:"116-cors-\ubcf4\uc548-\uc124\uc815",level:2},{value:"11.6.1 CORS \uae30\ubcf8 \uc124\uc815",id:"1161-cors-\uae30\ubcf8-\uc124\uc815",level:3},{value:"11.6.2 \ub3d9\uc801 CORS \uc124\uc815",id:"1162-\ub3d9\uc801-cors-\uc124\uc815",level:3},{value:"11.6.3 Preflight \uc694\uccad \ucc98\ub9ac",id:"1163-preflight-\uc694\uccad-\ucc98\ub9ac",level:3},{value:"11.7 Rate Limiting \uad6c\ud604",id:"117-rate-limiting-\uad6c\ud604",level:2},{value:"11.7.1 \uae30\ubcf8 Rate Limiting",id:"1171-\uae30\ubcf8-rate-limiting",level:3},{value:"11.7.2 \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ubcc4 Rate Limiting",id:"1172-\uc5d4\ub4dc\ud3ec\uc778\ud2b8\ubcc4-rate-limiting",level:3},{value:"11.7.3 Redis\ub97c \uc0ac\uc6a9\ud55c \ubd84\uc0b0 Rate Limiting",id:"1173-redis\ub97c-\uc0ac\uc6a9\ud55c-\ubd84\uc0b0-rate-limiting",level:3},{value:"11.7.4 \uc0ac\uc6a9\uc790\ubcc4 Rate Limiting",id:"1174-\uc0ac\uc6a9\uc790\ubcc4-rate-limiting",level:3},{value:"11.7.5 Rate Limiting \ubaa8\ub2c8\ud130\ub9c1",id:"1175-rate-limiting-\ubaa8\ub2c8\ud130\ub9c1",level:3},{value:"11.8 Input Sanitization",id:"118-input-sanitization",level:2},{value:"11.8.1 \uc785\ub825 \uac80\uc99d \ub77c\uc774\ube0c\ub7ec\ub9ac",id:"1181-\uc785\ub825-\uac80\uc99d-\ub77c\uc774\ube0c\ub7ec\ub9ac",level:3},{value:"11.8.2 \ud30c\uc77c \uc5c5\ub85c\ub4dc \uac80\uc99d",id:"1182-\ud30c\uc77c-\uc5c5\ub85c\ub4dc-\uac80\uc99d",level:3},{value:"11.8.3 Path Traversal \ubc29\uc5b4",id:"1183-path-traversal-\ubc29\uc5b4",level:3},{value:"11.8.4 JSON Schema \uac80\uc99d",id:"1184-json-schema-\uac80\uc99d",level:3},{value:"11.9 HTTPS \ubc0f SSL/TLS",id:"119-https-\ubc0f-ssltls",level:2},{value:"11.9.1 HTTPS \uc11c\ubc84 \uc124\uc815",id:"1191-https-\uc11c\ubc84-\uc124\uc815",level:3},{value:"11.9.2 HSTS (HTTP Strict Transport Security)",id:"1192-hsts-http-strict-transport-security",level:3},{value:"11.9.3 Let&#39;s Encrypt \uc790\ub3d9 \uac31\uc2e0",id:"1193-lets-encrypt-\uc790\ub3d9-\uac31\uc2e0",level:3},{value:"11.9.4 SSL/TLS \uccb4\ud06c\ub9ac\uc2a4\ud2b8",id:"1194-ssltls-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",level:3},{value:"11.10 \ubcf4\uc548 \ud5e4\ub354 \uc124\uc815",id:"1110-\ubcf4\uc548-\ud5e4\ub354-\uc124\uc815",level:2},{value:"11.10.1 Helmet\uc744 \uc0ac\uc6a9\ud55c \ubcf4\uc548 \ud5e4\ub354",id:"11101-helmet\uc744-\uc0ac\uc6a9\ud55c-\ubcf4\uc548-\ud5e4\ub354",level:3},{value:"11.10.2 \uac1c\ubcc4 \ubcf4\uc548 \ud5e4\ub354 \uc124\uc815",id:"11102-\uac1c\ubcc4-\ubcf4\uc548-\ud5e4\ub354-\uc124\uc815",level:3},{value:"11.10.3 CSP Nonce \uc0ac\uc6a9",id:"11103-csp-nonce-\uc0ac\uc6a9",level:3},{value:"11.10.4 \ubcf4\uc548 \ud5e4\ub354 \uac80\uc99d",id:"11104-\ubcf4\uc548-\ud5e4\ub354-\uac80\uc99d",level:3},{value:"11.11 \ubbfc\uac10 \uc815\ubcf4 \ubcf4\ud638 (\ud658\uacbd\ubcc0\uc218, \uc2dc\ud06c\ub9bf)",id:"1111-\ubbfc\uac10-\uc815\ubcf4-\ubcf4\ud638-\ud658\uacbd\ubcc0\uc218-\uc2dc\ud06c\ub9bf",level:2},{value:"11.11.1 \ud658\uacbd\ubcc0\uc218 \uad00\ub9ac",id:"11111-\ud658\uacbd\ubcc0\uc218-\uad00\ub9ac",level:3},{value:"11.11.2 \uc2dc\ud06c\ub9bf \uac80\uc99d",id:"11112-\uc2dc\ud06c\ub9bf-\uac80\uc99d",level:3},{value:"11.11.3 .gitignore \uc124\uc815",id:"11113-gitignore-\uc124\uc815",level:3},{value:"11.11.4 \ud558\ub4dc\ucf54\ub529 \ubc29\uc9c0",id:"11114-\ud558\ub4dc\ucf54\ub529-\ubc29\uc9c0",level:3},{value:"11.12 API \ud0a4 \uad00\ub9ac",id:"1112-api-\ud0a4-\uad00\ub9ac",level:2},{value:"11.12.1 API \ud0a4 \uc0dd\uc131",id:"11121-api-\ud0a4-\uc0dd\uc131",level:3},{value:"11.12.2 API \ud0a4 \uc778\uc99d \ubbf8\ub4e4\uc6e8\uc5b4",id:"11122-api-\ud0a4-\uc778\uc99d-\ubbf8\ub4e4\uc6e8\uc5b4",level:3},{value:"11.12.3 API \ud0a4 \uad8c\ud55c \uad00\ub9ac",id:"11123-api-\ud0a4-\uad8c\ud55c-\uad00\ub9ac",level:3},{value:"11.12.4 API \ud0a4 \uad00\ub9ac \uae30\ub2a5",id:"11124-api-\ud0a4-\uad00\ub9ac-\uae30\ub2a5",level:3},{value:"11.12.5 API \ud0a4 \uc0ac\uc6a9\ub7c9 \ucd94\uc801",id:"11125-api-\ud0a4-\uc0ac\uc6a9\ub7c9-\ucd94\uc801",level:3},{value:"11.13 \ubcf4\uc548 \uccb4\ud06c\ub9ac\uc2a4\ud2b8",id:"1113-\ubcf4\uc548-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",level:2},{value:"11.13.1 \uac1c\ubc1c \ub2e8\uacc4 \uccb4\ud06c\ub9ac\uc2a4\ud2b8",id:"11131-\uac1c\ubc1c-\ub2e8\uacc4-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",level:3},{value:"11.13.2 \ubc30\ud3ec \uc804 \uccb4\ud06c\ub9ac\uc2a4\ud2b8",id:"11132-\ubc30\ud3ec-\uc804-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",level:3},{value:"11.13.3 \uc815\uae30 \ubcf4\uc548 \uc810\uac80",id:"11133-\uc815\uae30-\ubcf4\uc548-\uc810\uac80",level:3},{value:"11.14 \uc2e4\uc2b5 \ubb38\uc81c",id:"1114-\uc2e4\uc2b5-\ubb38\uc81c",level:2},{value:"\ubb38\uc81c 1: \uc548\uc804\ud55c \ub85c\uadf8\uc778 API \uad6c\ud604",id:"\ubb38\uc81c-1-\uc548\uc804\ud55c-\ub85c\uadf8\uc778-api-\uad6c\ud604",level:3},{value:"\ubb38\uc81c 2: XSS \ubc29\uc5b4 \ub313\uae00 \uc2dc\uc2a4\ud15c",id:"\ubb38\uc81c-2-xss-\ubc29\uc5b4-\ub313\uae00-\uc2dc\uc2a4\ud15c",level:3},{value:"\ubb38\uc81c 3: CSRF \ubc29\uc5b4 \uad6c\ud604",id:"\ubb38\uc81c-3-csrf-\ubc29\uc5b4-\uad6c\ud604",level:3},{value:"\ubb38\uc81c 4: \ubcf4\uc548 \ud5e4\ub354 \ubc0f HTTPS \uc124\uc815",id:"\ubb38\uc81c-4-\ubcf4\uc548-\ud5e4\ub354-\ubc0f-https-\uc124\uc815",level:3},{value:"\ucc38\uace0 \uc790\ub8cc",id:"\ucc38\uace0-\uc790\ub8cc",level:2},{value:"\ub2e4\uc74c \ub2e8\uacc4",id:"\ub2e4\uc74c-\ub2e8\uacc4",level:2}];function d(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components},{Details:s}=e;return s||function(n,e){throw new Error("Expected "+(e?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"11-\ubcf4\uc548",children:"11. \ubcf4\uc548"})}),"\n",(0,t.jsx)(e.p,{children:"\uc6f9 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ubcf4\uc548\uc740 \uc0ac\uc6a9\uc790 \ub370\uc774\ud130\ub97c \ubcf4\ud638\ud558\uace0 \uc2dc\uc2a4\ud15c\uc758 \ubb34\uacb0\uc131\uc744 \uc720\uc9c0\ud558\ub294 \ub370 \ud544\uc218\uc801\uc785\ub2c8\ub2e4. \uc774 \ubb38\uc11c\uc5d0\uc11c\ub294 \uc8fc\uc694 \ubcf4\uc548 \uc704\ud611\uacfc \ubc29\uc5b4 \uae30\ubc95\uc744 \ub2e4\ub8f9\ub2c8\ub2e4."}),"\n",(0,t.jsx)(e.h2,{id:"111-\uc6f9-\ubcf4\uc548-\uac1c\uc694",children:"11.1 \uc6f9 \ubcf4\uc548 \uac1c\uc694"}),"\n",(0,t.jsx)(e.h3,{id:"1111-\ubcf4\uc548\uc758-\uc911\uc694\uc131",children:"11.1.1 \ubcf4\uc548\uc758 \uc911\uc694\uc131"}),"\n",(0,t.jsx)(e.p,{children:"\uc6f9 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ubcf4\uc548\uc740 \ub2e4\uc74c\uacfc \uac19\uc740 \uc774\uc720\ub85c \uc911\uc694\ud569\ub2c8\ub2e4:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\ub370\uc774\ud130 \ubcf4\ud638"}),": \uc0ac\uc6a9\uc790\uc758 \uac1c\uc778\uc815\ubcf4 \ubc0f \ubbfc\uac10\ud55c \ub370\uc774\ud130 \ubcf4\ud638"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\uc11c\ube44\uc2a4 \uac00\uc6a9\uc131"}),": DDoS \ubc0f \uc545\uc758\uc801\uc778 \uacf5\uaca9\uc73c\ub85c\ubd80\ud130 \uc11c\ube44\uc2a4 \ubcf4\ud638"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\uc2e0\ub8b0\uc131"}),": \uc0ac\uc6a9\uc790 \uc2e0\ub8b0 \uc720\uc9c0 \ubc0f \ube0c\ub79c\ub4dc \uc774\ubbf8\uc9c0 \ubcf4\ud638"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\ubc95\uc801 \uc900\uc218"}),": GDPR, \uac1c\uc778\uc815\ubcf4\ubcf4\ud638\ubc95 \ub4f1 \uaddc\uc815 \uc900\uc218"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\uc7ac\uc815\uc801 \uc190\uc2e4 \ubc29\uc9c0"}),": \ubcf4\uc548 \uce68\ud574\ub85c \uc778\ud55c \uae08\uc804\uc801 \ud53c\ud574 \ubc29\uc9c0"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"1112-\ubcf4\uc548\uc758-3\ub300-\uc6d0\uce59-cia-triad",children:"11.1.2 \ubcf4\uc548\uc758 3\ub300 \uc6d0\uce59 (CIA Triad)"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-mermaid",children:"graph TD\n    A[\ubcf4\uc548\uc758 3\ub300 \uc6d0\uce59] --\x3e B[\uae30\ubc00\uc131 Confidentiality]\n    A --\x3e C[\ubb34\uacb0\uc131 Integrity]\n    A --\x3e D[\uac00\uc6a9\uc131 Availability]\n    B --\x3e E[\uc778\uac00\ub41c \uc0ac\uc6a9\uc790\ub9cc \uc811\uadfc]\n    C --\x3e F[\ub370\uc774\ud130 \ubcc0\uc870 \ubc29\uc9c0]\n    D --\x3e G[\uc11c\ube44\uc2a4 \uc9c0\uc18d\uc131 \ubcf4\uc7a5]\n"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\uae30\ubc00\uc131 (Confidentiality)"}),": \uc778\uac00\ub41c \uc0ac\uc6a9\uc790\ub9cc \uc815\ubcf4\uc5d0 \uc811\uadfc"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\ubb34\uacb0\uc131 (Integrity)"}),": \ub370\uc774\ud130\uac00 \ubb34\ub2e8\uc73c\ub85c \ubcc0\uc870\ub418\uc9c0 \uc54a\ub3c4\ub85d \ubcf4\ud638"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\uac00\uc6a9\uc131 (Availability)"}),": \ud544\uc694\ud560 \ub54c \uc2dc\uc2a4\ud15c\uacfc \ub370\uc774\ud130\uc5d0 \uc811\uadfc \uac00\ub2a5"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"1113-\ubcf4\uc548-\uc124\uacc4-\uc6d0\uce59",children:"11.1.3 \ubcf4\uc548 \uc124\uacc4 \uc6d0\uce59"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// Defense in Depth (\ub2e4\uce35 \ubc29\uc5b4)\nconst securityLayers = {\n  network: ['Firewall', 'IDS/IPS'],\n  application: ['Input Validation', 'Authentication', 'Authorization'],\n  data: ['Encryption', 'Access Control'],\n  physical: ['Server Room Security', 'Backup']\n};\n\n// Principle of Least Privilege (\ucd5c\uc18c \uad8c\ud55c \uc6d0\uce59)\nconst userPermissions = {\n  admin: ['read', 'write', 'delete', 'admin'],\n  editor: ['read', 'write'],\n  viewer: ['read']\n};\n\n// Fail Securely (\uc548\uc804\ud55c \uc2e4\ud328)\ntry {\n  authenticateUser(credentials);\n} catch (error) {\n  // \uc5d0\ub7ec \ubc1c\uc0dd \uc2dc \uc811\uadfc \uac70\ubd80 (\uae30\ubcf8\uc801\uc73c\ub85c \uc548\uc804\ud55c \uc0c1\ud0dc)\n  logger.error('Authentication failed', error);\n  return { authenticated: false, message: 'Authentication failed' };\n  // \uc0c1\uc138\ud55c \uc5d0\ub7ec \uc815\ubcf4\ub97c \ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0 \ub178\ucd9c\ud558\uc9c0 \uc54a\uc74c\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"112-owasp-top-10-\uc124\uba85",children:"11.2 OWASP Top 10 \uc124\uba85"}),"\n",(0,t.jsx)(e.p,{children:"OWASP(Open Web Application Security Project) Top 10\uc740 \uc6f9 \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc758 \uac00\uc7a5 \uc911\uc694\ud55c \ubcf4\uc548 \uc704\ud5d8\uc744 \uc815\ub9ac\ud55c \ubaa9\ub85d\uc785\ub2c8\ub2e4."}),"\n",(0,t.jsx)(e.h3,{id:"1121-owasp-top-10-2021",children:"11.2.1 OWASP Top 10 (2021)"}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"\uc21c\uc704"}),(0,t.jsx)(e.th,{children:"\ucde8\uc57d\uc810"}),(0,t.jsx)(e.th,{children:"\uc124\uba85"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"A01"}),(0,t.jsx)(e.td,{children:"Broken Access Control"}),(0,t.jsx)(e.td,{children:"\uc778\uc99d\ub418\uc9c0 \uc54a\uc740 \uc811\uadfc \uc81c\uc5b4"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"A02"}),(0,t.jsx)(e.td,{children:"Cryptographic Failures"}),(0,t.jsx)(e.td,{children:"\uc554\ud638\ud654 \uc2e4\ud328"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"A03"}),(0,t.jsx)(e.td,{children:"Injection"}),(0,t.jsx)(e.td,{children:"\uc778\uc81d\uc158 \uacf5\uaca9"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"A04"}),(0,t.jsx)(e.td,{children:"Insecure Design"}),(0,t.jsx)(e.td,{children:"\ubd88\uc548\uc804\ud55c \uc124\uacc4"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"A05"}),(0,t.jsx)(e.td,{children:"Security Misconfiguration"}),(0,t.jsx)(e.td,{children:"\ubcf4\uc548 \uc124\uc815 \uc624\ub958"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"A06"}),(0,t.jsx)(e.td,{children:"Vulnerable Components"}),(0,t.jsx)(e.td,{children:"\ucde8\uc57d\ud55c \uad6c\uc131\uc694\uc18c"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"A07"}),(0,t.jsx)(e.td,{children:"Authentication Failures"}),(0,t.jsx)(e.td,{children:"\uc778\uc99d \uc2e4\ud328"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"A08"}),(0,t.jsx)(e.td,{children:"Software and Data Integrity"}),(0,t.jsx)(e.td,{children:"\uc18c\ud504\ud2b8\uc6e8\uc5b4 \ubc0f \ub370\uc774\ud130 \ubb34\uacb0\uc131 \uc2e4\ud328"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"A09"}),(0,t.jsx)(e.td,{children:"Security Logging Failures"}),(0,t.jsx)(e.td,{children:"\ubcf4\uc548 \ub85c\uae45 \ubc0f \ubaa8\ub2c8\ud130\ub9c1 \uc2e4\ud328"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"A10"}),(0,t.jsx)(e.td,{children:"Server-Side Request Forgery"}),(0,t.jsx)(e.td,{children:"\uc11c\ubc84 \uce21 \uc694\uccad \uc704\uc870"})]})]})]}),"\n",(0,t.jsx)(e.h3,{id:"1122-a01-broken-access-control",children:"11.2.2 A01: Broken Access Control"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u274c \ucde8\uc57d\ud55c \ucf54\ub4dc\napp.get('/api/user/:id/profile', async (req, res) => {\n  const userId = req.params.id;\n  const profile = await getUserProfile(userId);\n  res.json(profile); // \ub204\uad6c\ub098 \ub2e4\ub978 \uc0ac\uc6a9\uc790\uc758 \ud504\ub85c\ud544 \uc870\ud68c \uac00\ub2a5\n});\n\n// \u2705 \uc548\uc804\ud55c \ucf54\ub4dc\napp.get('/api/user/:id/profile', authenticateToken, async (req, res) => {\n  const requestedUserId = req.params.id;\n  const authenticatedUserId = req.user.id;\n\n  // \uc790\uc2e0\uc758 \ud504\ub85c\ud544\ub9cc \uc870\ud68c \uac00\ub2a5\ud558\ub3c4\ub85d \uac80\uc99d\n  if (requestedUserId !== authenticatedUserId && !req.user.isAdmin) {\n    return res.status(403).json({ error: 'Access denied' });\n  }\n\n  const profile = await getUserProfile(requestedUserId);\n  res.json(profile);\n});\n"})}),"\n",(0,t.jsx)(e.admonition,{type:"warning",children:(0,t.jsxs)(e.p,{children:["\uc811\uadfc \uc81c\uc5b4\ub294 \ud074\ub77c\uc774\uc5b8\ud2b8 \uce21\uc774 \uc544\ub2cc ",(0,t.jsx)(e.strong,{children:"\uc11c\ubc84 \uce21\uc5d0\uc11c \ubc18\ub4dc\uc2dc \uac80\uc99d"}),"\ud574\uc57c \ud569\ub2c8\ub2e4. \ud074\ub77c\uc774\uc5b8\ud2b8 \uce21 \uac80\uc99d\uc740 \uc27d\uac8c \uc6b0\ud68c\ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]})}),"\n",(0,t.jsx)(e.h3,{id:"1123-a02-cryptographic-failures",children:"11.2.3 A02: Cryptographic Failures"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const bcrypt = require('bcrypt');\nconst crypto = require('crypto');\n\n// \u2705 \ube44\ubc00\ubc88\ud638 \ud574\uc2f1\nasync function hashPassword(password) {\n  const saltRounds = 12; // \ucda9\ubd84\ud55c \uac15\ub3c4\uc758 salt\n  return await bcrypt.hash(password, saltRounds);\n}\n\nasync function verifyPassword(password, hash) {\n  return await bcrypt.compare(password, hash);\n}\n\n// \u2705 \ubbfc\uac10\ud55c \ub370\uc774\ud130 \uc554\ud638\ud654\nfunction encryptData(data, key) {\n  const algorithm = 'aes-256-gcm';\n  const iv = crypto.randomBytes(16);\n  const cipher = crypto.createCipheriv(algorithm, key, iv);\n\n  let encrypted = cipher.update(data, 'utf8', 'hex');\n  encrypted += cipher.final('hex');\n\n  const authTag = cipher.getAuthTag();\n\n  return {\n    encrypted,\n    iv: iv.toString('hex'),\n    authTag: authTag.toString('hex')\n  };\n}\n\n// \u274c \uc808\ub300 \uc0ac\uc6a9\ud558\uc9c0 \ub9d0 \uac83\n// - MD5, SHA1 (\ud574\uc2dc \ud568\uc218\ub85c \ube44\ubc00\ubc88\ud638 \uc800\uc7a5)\n// - Base64 \uc778\ucf54\ub529\ub9cc\uc73c\ub85c \ubbfc\uac10\ud55c \ub370\uc774\ud130 \uc800\uc7a5\n// - \ud558\ub4dc\ucf54\ub529\ub41c \uc554\ud638\ud654 \ud0a4\n"})}),"\n",(0,t.jsx)(e.h2,{id:"113-sql-injection-\ubc29\uc5b4",children:"11.3 SQL Injection \ubc29\uc5b4"}),"\n",(0,t.jsx)(e.p,{children:"SQL Injection\uc740 \uc545\uc758\uc801\uc778 SQL \ucf54\ub4dc\ub97c \uc8fc\uc785\ud558\uc5ec \ub370\uc774\ud130\ubca0\uc774\uc2a4\ub97c \uc870\uc791\ud558\ub294 \uacf5\uaca9\uc785\ub2c8\ub2e4."}),"\n",(0,t.jsx)(e.h3,{id:"1131-sql-injection-\uacf5\uaca9-\uc608\uc2dc",children:"11.3.1 SQL Injection \uacf5\uaca9 \uc608\uc2dc"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u274c \ucde8\uc57d\ud55c \ucf54\ub4dc (SQL Injection \uac00\ub2a5)\napp.get('/api/users', async (req, res) => {\n  const username = req.query.username;\n\n  // \uc0ac\uc6a9\uc790 \uc785\ub825\uc744 \uc9c1\uc811 \ucffc\ub9ac\uc5d0 \uc0bd\uc785\n  const query = `SELECT * FROM users WHERE username = '${username}'`;\n  const result = await db.query(query);\n\n  res.json(result);\n});\n\n/*\n\uacf5\uaca9 \uc608\uc2dc:\nGET /api/users?username=admin' OR '1'='1\n\n\uc2e4\ud589\ub418\ub294 \ucffc\ub9ac:\nSELECT * FROM users WHERE username = 'admin' OR '1'='1'\n\u2192 \ubaa8\ub4e0 \uc0ac\uc6a9\uc790 \uc815\ubcf4 \ub178\ucd9c\n*/\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1132-prepared-statements-\uc0ac\uc6a9",children:"11.3.2 Prepared Statements \uc0ac\uc6a9"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 \uc548\uc804\ud55c \ucf54\ub4dc (Prepared Statements)\nconst mysql = require('mysql2/promise');\n\napp.get('/api/users', async (req, res) => {\n  const username = req.query.username;\n\n  try {\n    // Parameterized query \uc0ac\uc6a9\n    const [rows] = await db.execute(\n      'SELECT id, username, email FROM users WHERE username = ?',\n      [username]\n    );\n\n    res.json(rows);\n  } catch (error) {\n    logger.error('Database error', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1133-orm-\uc0ac\uc6a9",children:"11.3.3 ORM \uc0ac\uc6a9"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 Sequelize ORM \uc0ac\uc6a9\nconst { User } = require('./models');\n\napp.get('/api/users', async (req, res) => {\n  const { username } = req.query;\n\n  try {\n    const users = await User.findAll({\n      where: { username },\n      attributes: ['id', 'username', 'email'] // \ud544\uc694\ud55c \ud544\ub4dc\ub9cc \uc120\ud0dd\n    });\n\n    res.json(users);\n  } catch (error) {\n    logger.error('Database error', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n});\n\n// \u2705 Prisma ORM \uc0ac\uc6a9\nconst { PrismaClient } = require('@prisma/client');\nconst prisma = new PrismaClient();\n\napp.get('/api/users', async (req, res) => {\n  const { username } = req.query;\n\n  try {\n    const users = await prisma.user.findMany({\n      where: { username },\n      select: { id: true, username: true, email: true }\n    });\n\n    res.json(users);\n  } catch (error) {\n    logger.error('Database error', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n});\n"})}),"\n",(0,t.jsxs)(e.admonition,{type:"warning",children:[(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\uc808\ub300 \ud558\uc9c0 \ub9d0\uc544\uc57c \ud560 \uac83:"})}),(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\uc0ac\uc6a9\uc790 \uc785\ub825\uc744 \uc9c1\uc811 SQL \ucffc\ub9ac\uc5d0 \uc5f0\uacb0"}),"\n",(0,t.jsx)(e.li,{children:"\ubb38\uc790\uc5f4 \ud15c\ud50c\ub9bf/\uc5f0\uacb0\ub85c \ucffc\ub9ac \uc0dd\uc131"}),"\n",(0,t.jsx)(e.li,{children:"\uc785\ub825 \uac80\uc99d \uc5c6\uc774 \ub3d9\uc801 \ucffc\ub9ac \uc0dd\uc131"}),"\n"]})]}),"\n",(0,t.jsx)(e.h2,{id:"114-xss-cross-site-scripting-\ubc29\uc5b4",children:"11.4 XSS (Cross-Site Scripting) \ubc29\uc5b4"}),"\n",(0,t.jsx)(e.p,{children:"XSS\ub294 \uc545\uc758\uc801\uc778 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc6f9 \ud398\uc774\uc9c0\uc5d0 \uc8fc\uc785\ud558\uc5ec \uc2e4\ud589\ud558\ub294 \uacf5\uaca9\uc785\ub2c8\ub2e4."}),"\n",(0,t.jsx)(e.h3,{id:"1141-xss-\uacf5\uaca9-\uc720\ud615",children:"11.4.1 XSS \uacf5\uaca9 \uc720\ud615"}),"\n",(0,t.jsx)(e.h4,{id:"reflected-xss-\ubc18\uc0ac\ud615",children:"Reflected XSS (\ubc18\uc0ac\ud615)"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u274c \ucde8\uc57d\ud55c \ucf54\ub4dc\napp.get('/search', (req, res) => {\n  const query = req.query.q;\n  res.send(`<h1>\uac80\uc0c9 \uacb0\uacfc: ${query}</h1>`);\n});\n\n/*\n\uacf5\uaca9 \uc608\uc2dc:\n/search?q=<script>alert(document.cookie)<\/script>\n\n\uacb0\uacfc: \uc0ac\uc6a9\uc790\uc758 \ucfe0\ud0a4\uac00 \ub178\ucd9c\ub428\n*/\n"})}),"\n",(0,t.jsx)(e.h4,{id:"stored-xss-\uc800\uc7a5\ud615",children:"Stored XSS (\uc800\uc7a5\ud615)"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u274c \ucde8\uc57d\ud55c \ucf54\ub4dc\napp.post('/api/comments', async (req, res) => {\n  const { content } = req.body;\n\n  // \uac80\uc99d \uc5c6\uc774 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc800\uc7a5\n  await db.execute(\n    'INSERT INTO comments (content) VALUES (?)',\n    [content]\n  );\n\n  res.json({ success: true });\n});\n\n// \ub313\uae00\uc744 \uc870\ud68c\ud560 \ub54c \uc2a4\ud06c\ub9bd\ud2b8\uac00 \uc2e4\ud589\ub428\napp.get('/comments', async (req, res) => {\n  const [comments] = await db.execute('SELECT * FROM comments');\n  res.send(comments.map(c => `<p>${c.content}</p>`).join(''));\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1142-xss-\ubc29\uc5b4-\ubc29\ubc95",children:"11.4.2 XSS \ubc29\uc5b4 \ubc29\ubc95"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const createDOMPurify = require('dompurify');\nconst { JSDOM } = require('jsdom');\nconst window = new JSDOM('').window;\nconst DOMPurify = createDOMPurify(window);\n\n// \u2705 1. HTML \uc774\uc2a4\ucf00\uc774\ud504\nfunction escapeHtml(unsafe) {\n  return unsafe\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#039;\");\n}\n\napp.get('/search', (req, res) => {\n  const query = escapeHtml(req.query.q);\n  res.send(`<h1>\uac80\uc0c9 \uacb0\uacfc: ${query}</h1>`);\n});\n\n// \u2705 2. DOMPurify\ub97c \uc0ac\uc6a9\ud55c HTML \uc815\uc81c\napp.post('/api/comments', async (req, res) => {\n  const { content } = req.body;\n\n  // HTML\uc744 \uc815\uc81c\ud558\uc5ec \uc545\uc758\uc801\uc778 \uc2a4\ud06c\ub9bd\ud2b8 \uc81c\uac70\n  const sanitizedContent = DOMPurify.sanitize(content, {\n    ALLOWED_TAGS: ['b', 'i', 'em', 'strong', 'a', 'p'],\n    ALLOWED_ATTR: ['href']\n  });\n\n  await db.execute(\n    'INSERT INTO comments (content) VALUES (?)',\n    [sanitizedContent]\n  );\n\n  res.json({ success: true });\n});\n\n// \u2705 3. Content Security Policy (CSP) \uc124\uc815\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:;\"\n  );\n  next();\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1143-react\uc5d0\uc11c\uc758-xss-\ubc29\uc5b4",children:"11.4.3 React\uc5d0\uc11c\uc758 XSS \ubc29\uc5b4"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-jsx",children:"// \u2705 React\ub294 \uae30\ubcf8\uc801\uc73c\ub85c XSS \ubc29\uc5b4\nfunction SearchResults({ query }) {\n  // React\uac00 \uc790\ub3d9\uc73c\ub85c \uc774\uc2a4\ucf00\uc774\ud504 \ucc98\ub9ac\n  return <h1>\uac80\uc0c9 \uacb0\uacfc: {query}</h1>;\n}\n\n// \u26a0\ufe0f dangerouslySetInnerHTML \uc0ac\uc6a9 \uc2dc \uc8fc\uc758\nfunction Comment({ content }) {\n  // \u274c \uc704\ud5d8: \uac80\uc99d\ub418\uc9c0 \uc54a\uc740 HTML \uc0bd\uc785\n  return <div dangerouslySetInnerHTML={{ __html: content }} />;\n}\n\n// \u2705 \uc548\uc804: DOMPurify\ub85c \uc815\uc81c \ud6c4 \uc0ac\uc6a9\nimport DOMPurify from 'dompurify';\n\nfunction SafeComment({ content }) {\n  const sanitizedContent = DOMPurify.sanitize(content, {\n    ALLOWED_TAGS: ['b', 'i', 'em', 'strong', 'a', 'p'],\n    ALLOWED_ATTR: ['href']\n  });\n\n  return <div dangerouslySetInnerHTML={{ __html: sanitizedContent }} />;\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"115-csrf-cross-site-request-forgery-\ubc29\uc5b4",children:"11.5 CSRF (Cross-Site Request Forgery) \ubc29\uc5b4"}),"\n",(0,t.jsx)(e.p,{children:"CSRF\ub294 \uc0ac\uc6a9\uc790\uac00 \uc758\ub3c4\ud558\uc9c0 \uc54a\uc740 \uc694\uccad\uc744 \uac15\uc81c\ub85c \uc2e4\ud589\uc2dc\ud0a4\ub294 \uacf5\uaca9\uc785\ub2c8\ub2e4."}),"\n",(0,t.jsx)(e.h3,{id:"1151-csrf-\uacf5\uaca9-\uc608\uc2dc",children:"11.5.1 CSRF \uacf5\uaca9 \uc608\uc2dc"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'\x3c!-- \uacf5\uaca9\uc790\uc758 \uc6f9\uc0ac\uc774\ud2b8 --\x3e\n<html>\n<body>\n  <h1>\ubb34\ub8cc \uacbd\ud488 \ub2f9\ucca8!</h1>\n  \x3c!-- \uc0ac\uc6a9\uc790 \ubaa8\ub974\uac8c \uc1a1\uae08 \uc694\uccad \uc2e4\ud589 --\x3e\n  <img src="https://bank.com/transfer?to=attacker&amount=1000000" style="display:none">\n\n  <form action="https://bank.com/transfer" method="POST" id="csrf-form">\n    <input type="hidden" name="to" value="attacker">\n    <input type="hidden" name="amount" value="1000000">\n  </form>\n  <script>\n    document.getElementById(\'csrf-form\').submit();\n  <\/script>\n</body>\n</html>\n'})}),"\n",(0,t.jsx)(e.h3,{id:"1152-csrf-token-\uc0ac\uc6a9",children:"11.5.2 CSRF Token \uc0ac\uc6a9"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const csrf = require('csurf');\nconst cookieParser = require('cookie-parser');\n\n// \u2705 CSRF \ubcf4\ud638 \ubbf8\ub4e4\uc6e8\uc5b4 \uc124\uc815\napp.use(cookieParser());\napp.use(csrf({ cookie: true }));\n\n// CSRF \ud1a0\ud070\uc744 \ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0 \uc804\ub2ec\napp.get('/form', (req, res) => {\n  res.render('form', { csrfToken: req.csrfToken() });\n});\n\n// POST \uc694\uccad \uc2dc CSRF \ud1a0\ud070 \uac80\uc99d\napp.post('/api/transfer', (req, res) => {\n  // csrf \ubbf8\ub4e4\uc6e8\uc5b4\uac00 \uc790\ub3d9\uc73c\ub85c \ud1a0\ud070 \uac80\uc99d\n  const { to, amount } = req.body;\n\n  // \uc1a1\uae08 \ucc98\ub9ac\n  processTransfer(req.user.id, to, amount);\n  res.json({ success: true });\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1153-\ud074\ub77c\uc774\uc5b8\ud2b8-\uce21-\uad6c\ud604",children:"11.5.3 \ud074\ub77c\uc774\uc5b8\ud2b8 \uce21 \uad6c\ud604"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'\x3c!-- HTML \ud3fc --\x3e\n<form action="/api/transfer" method="POST">\n  <input type="hidden" name="_csrf" value="<%= csrfToken %>">\n  <input type="text" name="to" placeholder="\ubc1b\ub294 \uc0ac\ub78c">\n  <input type="number" name="amount" placeholder="\uae08\uc561">\n  <button type="submit">\uc1a1\uae08</button>\n</form>\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// JavaScript (Fetch API)\nasync function transferMoney(to, amount) {\n  // CSRF \ud1a0\ud070\uc744 \ucfe0\ud0a4\uc5d0\uc11c \uac00\uc838\uc624\uae30\n  const csrfToken = getCookie('XSRF-TOKEN');\n\n  const response = await fetch('/api/transfer', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'CSRF-Token': csrfToken\n    },\n    credentials: 'include',\n    body: JSON.stringify({ to, amount })\n  });\n\n  return response.json();\n}\n\nfunction getCookie(name) {\n  const value = `; ${document.cookie}`;\n  const parts = value.split(`; ${name}=`);\n  if (parts.length === 2) return parts.pop().split(';').shift();\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1154-samesite-cookie-\uc18d\uc131",children:"11.5.4 SameSite Cookie \uc18d\uc131"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 SameSite \uc18d\uc131\uc73c\ub85c CSRF \ubc29\uc5b4 \uac15\ud654\napp.use(session({\n  secret: process.env.SESSION_SECRET,\n  resave: false,\n  saveUninitialized: false,\n  cookie: {\n    httpOnly: true,\n    secure: true, // HTTPS\uc5d0\uc11c\ub9cc \uc804\uc1a1\n    sameSite: 'strict', // \ud06c\ub85c\uc2a4 \uc0ac\uc774\ud2b8 \uc694\uccad\uc5d0\uc11c \ucfe0\ud0a4 \uc804\uc1a1 \ucc28\ub2e8\n    maxAge: 3600000 // 1\uc2dc\uac04\n  }\n}));\n\n// SameSite \uc635\uc158:\n// - 'strict': \ubaa8\ub4e0 \ud06c\ub85c\uc2a4 \uc0ac\uc774\ud2b8 \uc694\uccad\uc5d0\uc11c \ucfe0\ud0a4 \ucc28\ub2e8\n// - 'lax': GET \uc694\uccad\uc740 \ud5c8\uc6a9, POST\ub294 \ucc28\ub2e8 (\uae30\ubcf8\uac12)\n// - 'none': \ubaa8\ub4e0 \uc694\uccad \ud5c8\uc6a9 (secure: true \ud544\uc218)\n"})}),"\n",(0,t.jsxs)(e.admonition,{type:"warning",children:[(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"CSRF \ubc29\uc5b4 \uccb4\ud06c\ub9ac\uc2a4\ud2b8:"})}),(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u2705 \uc0c1\ud0dc \ubcc0\uacbd \uc694\uccad(POST, PUT, DELETE)\uc5d0 CSRF \ud1a0\ud070 \uc0ac\uc6a9"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 SameSite \ucfe0\ud0a4 \uc18d\uc131 \uc124\uc815"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \uc911\uc694\ud55c \uc791\uc5c5\uc5d0 \uc7ac\uc778\uc99d \uc694\uad6c"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 Origin/Referer \ud5e4\ub354 \uac80\uc99d"}),"\n"]})]}),"\n",(0,t.jsx)(e.h2,{id:"116-cors-\ubcf4\uc548-\uc124\uc815",children:"11.6 CORS \ubcf4\uc548 \uc124\uc815"}),"\n",(0,t.jsx)(e.p,{children:"CORS(Cross-Origin Resource Sharing)\ub294 \ub2e4\ub978 \ub3c4\uba54\uc778\uc5d0\uc11c\uc758 \ub9ac\uc18c\uc2a4 \uc811\uadfc\uc744 \uc81c\uc5b4\ud569\ub2c8\ub2e4."}),"\n",(0,t.jsx)(e.h3,{id:"1161-cors-\uae30\ubcf8-\uc124\uc815",children:"11.6.1 CORS \uae30\ubcf8 \uc124\uc815"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const cors = require('cors');\n\n// \u274c \ubaa8\ub4e0 \ub3c4\uba54\uc778 \ud5c8\uc6a9 (\ud504\ub85c\ub355\uc158\uc5d0\uc11c \uc704\ud5d8)\napp.use(cors());\n\n// \u2705 \ud2b9\uc815 \ub3c4\uba54\uc778\ub9cc \ud5c8\uc6a9\nconst corsOptions = {\n  origin: function (origin, callback) {\n    const allowedOrigins = [\n      'https://myapp.com',\n      'https://www.myapp.com',\n      'https://admin.myapp.com'\n    ];\n\n    // \uac1c\ubc1c \ud658\uacbd\uc5d0\uc11c\ub9cc localhost \ud5c8\uc6a9\n    if (process.env.NODE_ENV === 'development') {\n      allowedOrigins.push('http://localhost:3000');\n      allowedOrigins.push('http://localhost:5173');\n    }\n\n    if (!origin || allowedOrigins.indexOf(origin) !== -1) {\n      callback(null, true);\n    } else {\n      callback(new Error('Not allowed by CORS'));\n    }\n  },\n  credentials: true, // \ucfe0\ud0a4 \ud3ec\ud568 \ud5c8\uc6a9\n  methods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],\n  allowedHeaders: ['Content-Type', 'Authorization', 'X-Requested-With'],\n  exposedHeaders: ['Content-Range', 'X-Content-Range'],\n  maxAge: 600 // Preflight \uc694\uccad \uce90\uc2dc \uc2dc\uac04 (\ucd08)\n};\n\napp.use(cors(corsOptions));\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1162-\ub3d9\uc801-cors-\uc124\uc815",children:"11.6.2 \ub3d9\uc801 CORS \uc124\uc815"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 \ub77c\uc6b0\ud2b8\ubcc4\ub85c \ub2e4\ub978 CORS \uc815\ucc45 \uc801\uc6a9\nconst publicCorsOptions = {\n  origin: '*', // \uacf5\uac1c API\n  credentials: false\n};\n\nconst privateCorsOptions = {\n  origin: ['https://myapp.com'], // \uc778\uc99d\uc774 \ud544\uc694\ud55c API\n  credentials: true\n};\n\n// \uacf5\uac1c API\napp.get('/api/public/posts', cors(publicCorsOptions), (req, res) => {\n  res.json({ posts: [] });\n});\n\n// \uc778\uc99d \ud544\uc694 API\napp.post('/api/private/posts',\n  cors(privateCorsOptions),\n  authenticateToken,\n  (req, res) => {\n    res.json({ success: true });\n  }\n);\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1163-preflight-\uc694\uccad-\ucc98\ub9ac",children:"11.6.3 Preflight \uc694\uccad \ucc98\ub9ac"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 OPTIONS \uc694\uccad \ucc98\ub9ac\napp.options('*', cors(corsOptions));\n\n// \ub610\ub294 \uc218\ub3d9\uc73c\ub85c \ucc98\ub9ac\napp.options('/api/posts', (req, res) => {\n  res.header('Access-Control-Allow-Origin', 'https://myapp.com');\n  res.header('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE');\n  res.header('Access-Control-Allow-Headers', 'Content-Type, Authorization');\n  res.header('Access-Control-Max-Age', '600');\n  res.sendStatus(204);\n});\n"})}),"\n",(0,t.jsxs)(e.admonition,{type:"warning",children:[(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"CORS \ubcf4\uc548 \uc8fc\uc758\uc0ac\ud56d:"})}),(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\u274c \ud504\ub85c\ub355\uc158\uc5d0\uc11c ",(0,t.jsx)(e.code,{children:"origin: '*'"})," \uc0ac\uc6a9 \uae08\uc9c0 (\ud2b9\ud788 credentials: true\uc640 \ud568\uaed8)"]}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \ud5c8\uc6a9\ud560 \ub3c4\uba54\uc778\uc744 \uba85\uc2dc\uc801\uc73c\ub85c \uc9c0\uc815"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \ud544\uc694\ud55c HTTP \uba54\uc11c\ub4dc\ub9cc \ud5c8\uc6a9"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \ubbfc\uac10\ud55c \ud5e4\ub354\ub294 \ub178\ucd9c\ud558\uc9c0 \uc54a\uae30"}),"\n"]})]}),"\n",(0,t.jsx)(e.h2,{id:"117-rate-limiting-\uad6c\ud604",children:"11.7 Rate Limiting \uad6c\ud604"}),"\n",(0,t.jsx)(e.p,{children:"Rate Limiting\uc740 API \ub0a8\uc6a9\uc744 \ubc29\uc9c0\ud558\uace0 DDoS \uacf5\uaca9\uc744 \uc644\ud654\ud569\ub2c8\ub2e4."}),"\n",(0,t.jsx)(e.h3,{id:"1171-\uae30\ubcf8-rate-limiting",children:"11.7.1 \uae30\ubcf8 Rate Limiting"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const rateLimit = require('express-rate-limit');\n\n// \u2705 \uc804\uc5ed Rate Limiter\nconst globalLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15\ubd84\n  max: 100, // \ucd5c\ub300 100\uac1c \uc694\uccad\n  message: '\ub108\ubb34 \ub9ce\uc740 \uc694\uccad\uc744 \ubcf4\ub0c8\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.',\n  standardHeaders: true, // RateLimit-* \ud5e4\ub354 \ubc18\ud658\n  legacyHeaders: false, // X-RateLimit-* \ud5e4\ub354 \ube44\ud65c\uc131\ud654\n  handler: (req, res) => {\n    logger.warn('Rate limit exceeded', {\n      ip: req.ip,\n      path: req.path\n    });\n    res.status(429).json({\n      error: 'Too many requests',\n      retryAfter: req.rateLimit.resetTime\n    });\n  }\n});\n\napp.use(globalLimiter);\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1172-\uc5d4\ub4dc\ud3ec\uc778\ud2b8\ubcc4-rate-limiting",children:"11.7.2 \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ubcc4 Rate Limiting"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 \ub85c\uadf8\uc778 API - \uc5c4\uaca9\ud55c \uc81c\ud55c\nconst loginLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15\ubd84\n  max: 5, // \ucd5c\ub300 5\ubc88 \uc2dc\ub3c4\n  skipSuccessfulRequests: true, // \uc131\uacf5\ud55c \uc694\uccad\uc740 \uce74\uc6b4\ud2b8\ud558\uc9c0 \uc54a\uc74c\n  message: '\ub85c\uadf8\uc778 \uc2dc\ub3c4 \ud69f\uc218\ub97c \ucd08\uacfc\ud588\uc2b5\ub2c8\ub2e4. 15\ubd84 \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.'\n});\n\napp.post('/api/auth/login', loginLimiter, async (req, res) => {\n  // \ub85c\uadf8\uc778 \ucc98\ub9ac\n});\n\n// \u2705 \ud68c\uc6d0\uac00\uc785 API\nconst registrationLimiter = rateLimit({\n  windowMs: 60 * 60 * 1000, // 1\uc2dc\uac04\n  max: 3, // \ucd5c\ub300 3\uac1c \uacc4\uc815\n  message: '\ud68c\uc6d0\uac00\uc785 \uc2dc\ub3c4 \ud69f\uc218\ub97c \ucd08\uacfc\ud588\uc2b5\ub2c8\ub2e4.'\n});\n\napp.post('/api/auth/register', registrationLimiter, async (req, res) => {\n  // \ud68c\uc6d0\uac00\uc785 \ucc98\ub9ac\n});\n\n// \u2705 API \ud0a4 \ubc1c\uae09\nconst apiKeyLimiter = rateLimit({\n  windowMs: 24 * 60 * 60 * 1000, // 24\uc2dc\uac04\n  max: 10,\n  message: 'API \ud0a4 \uc0dd\uc131 \ud55c\ub3c4\ub97c \ucd08\uacfc\ud588\uc2b5\ub2c8\ub2e4.'\n});\n\napp.post('/api/keys', authenticateToken, apiKeyLimiter, async (req, res) => {\n  // API \ud0a4 \uc0dd\uc131\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1173-redis\ub97c-\uc0ac\uc6a9\ud55c-\ubd84\uc0b0-rate-limiting",children:"11.7.3 Redis\ub97c \uc0ac\uc6a9\ud55c \ubd84\uc0b0 Rate Limiting"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const RedisStore = require('rate-limit-redis');\nconst Redis = require('ioredis');\n\nconst redisClient = new Redis({\n  host: process.env.REDIS_HOST,\n  port: process.env.REDIS_PORT,\n  password: process.env.REDIS_PASSWORD\n});\n\n// \u2705 Redis \uae30\ubc18 Rate Limiter (\ubd84\uc0b0 \ud658\uacbd\uc5d0\uc11c \uc0ac\uc6a9)\nconst distributedLimiter = rateLimit({\n  store: new RedisStore({\n    client: redisClient,\n    prefix: 'rate-limit:'\n  }),\n  windowMs: 15 * 60 * 1000,\n  max: 100\n});\n\napp.use('/api/', distributedLimiter);\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1174-\uc0ac\uc6a9\uc790\ubcc4-rate-limiting",children:"11.7.4 \uc0ac\uc6a9\uc790\ubcc4 Rate Limiting"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 IP \ub300\uc2e0 \uc0ac\uc6a9\uc790 ID\ub85c Rate Limiting\nconst userLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: 100,\n  keyGenerator: (req) => {\n    // \uc778\uc99d\ub41c \uc0ac\uc6a9\uc790\ub294 \uc0ac\uc6a9\uc790 ID \uc0ac\uc6a9\n    if (req.user) {\n      return `user:${req.user.id}`;\n    }\n    // \ube44\uc778\uc99d \uc0ac\uc6a9\uc790\ub294 IP \uc0ac\uc6a9\n    return req.ip;\n  }\n});\n\n// \u2705 \uacc4\uce35\ubcc4 \ub2e4\ub978 \uc81c\ud55c\nconst tieredLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: (req) => {\n    if (req.user?.plan === 'premium') {\n      return 1000; // \ud504\ub9ac\ubbf8\uc5c4 \uc0ac\uc6a9\uc790\n    } else if (req.user?.plan === 'basic') {\n      return 100; // \uae30\ubcf8 \uc0ac\uc6a9\uc790\n    }\n    return 10; // \ube44\uc778\uc99d \uc0ac\uc6a9\uc790\n  }\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1175-rate-limiting-\ubaa8\ub2c8\ud130\ub9c1",children:"11.7.5 Rate Limiting \ubaa8\ub2c8\ud130\ub9c1"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 Rate Limiting \uba54\ud2b8\ub9ad \uc218\uc9d1\nconst rateLimitMonitor = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: 100,\n  handler: (req, res) => {\n    // \uba54\ud2b8\ub9ad \uae30\ub85d\n    metrics.increment('rate_limit.exceeded', {\n      path: req.path,\n      ip: req.ip,\n      user: req.user?.id\n    });\n\n    // \uc758\uc2ec\uc2a4\ub7ec\uc6b4 \ud65c\ub3d9 \uac10\uc9c0\n    if (req.rateLimit.current > 200) {\n      logger.alert('Potential DDoS attack detected', {\n        ip: req.ip,\n        attempts: req.rateLimit.current\n      });\n    }\n\n    res.status(429).json({ error: 'Too many requests' });\n  }\n});\n"})}),"\n",(0,t.jsx)(e.h2,{id:"118-input-sanitization",children:"11.8 Input Sanitization"}),"\n",(0,t.jsx)(e.p,{children:"\uc785\ub825 \uac80\uc99d \ubc0f \uc815\uc81c\ub294 \ubaa8\ub4e0 \ubcf4\uc548\uc758 \uae30\ucd08\uc785\ub2c8\ub2e4."}),"\n",(0,t.jsx)(e.h3,{id:"1181-\uc785\ub825-\uac80\uc99d-\ub77c\uc774\ube0c\ub7ec\ub9ac",children:"11.8.1 \uc785\ub825 \uac80\uc99d \ub77c\uc774\ube0c\ub7ec\ub9ac"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const { body, query, param, validationResult } = require('express-validator');\nconst validator = require('validator');\n\n// \u2705 express-validator \uc0ac\uc6a9\napp.post('/api/users',\n  [\n    body('email')\n      .isEmail()\n      .normalizeEmail()\n      .withMessage('\uc720\ud6a8\ud55c \uc774\uba54\uc77c\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694'),\n    body('username')\n      .isLength({ min: 3, max: 20 })\n      .matches(/^[a-zA-Z0-9_]+$/)\n      .withMessage('\uc0ac\uc6a9\uc790\uba85\uc740 3-20\uc790\uc758 \uc601\ubb38, \uc22b\uc790, \uc5b8\ub354\uc2a4\ucf54\uc5b4\ub9cc \uac00\ub2a5\ud569\ub2c8\ub2e4'),\n    body('password')\n      .isLength({ min: 8 })\n      .matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]/)\n      .withMessage('\ube44\ubc00\ubc88\ud638\ub294 8\uc790 \uc774\uc0c1, \ub300\uc18c\ubb38\uc790, \uc22b\uc790, \ud2b9\uc218\ubb38\uc790\ub97c \ud3ec\ud568\ud574\uc57c \ud569\ub2c8\ub2e4'),\n    body('age')\n      .optional()\n      .isInt({ min: 0, max: 150 })\n      .withMessage('\ub098\uc774\ub294 0-150 \uc0ac\uc774\uc758 \uc815\uc218\uc5ec\uc57c \ud569\ub2c8\ub2e4'),\n    body('website')\n      .optional()\n      .isURL()\n      .withMessage('\uc720\ud6a8\ud55c URL\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694')\n  ],\n  async (req, res) => {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return res.status(400).json({ errors: errors.array() });\n    }\n\n    // \uac80\uc99d\ub41c \ub370\uc774\ud130 \ucc98\ub9ac\n    const { email, username, password } = req.body;\n    // ...\n  }\n);\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1182-\ud30c\uc77c-\uc5c5\ub85c\ub4dc-\uac80\uc99d",children:"11.8.2 \ud30c\uc77c \uc5c5\ub85c\ub4dc \uac80\uc99d"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const multer = require('multer');\nconst path = require('path');\n\n// \u2705 \uc548\uc804\ud55c \ud30c\uc77c \uc5c5\ub85c\ub4dc \uc124\uc815\nconst storage = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, 'uploads/');\n  },\n  filename: (req, file, cb) => {\n    // \uc6d0\ubcf8 \ud30c\uc77c\uba85 \uc0ac\uc6a9 \uae08\uc9c0 (\uacbd\ub85c \uc870\uc791 \uacf5\uaca9 \ubc29\uc9c0)\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    cb(null, uniqueSuffix + path.extname(file.originalname));\n  }\n});\n\nconst fileFilter = (req, file, cb) => {\n  // \ud5c8\uc6a9\ub41c MIME \ud0c0\uc785\n  const allowedMimeTypes = [\n    'image/jpeg',\n    'image/png',\n    'image/gif',\n    'image/webp'\n  ];\n\n  if (allowedMimeTypes.includes(file.mimetype)) {\n    cb(null, true);\n  } else {\n    cb(new Error('\uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ud30c\uc77c \ud615\uc2dd\uc785\ub2c8\ub2e4.'));\n  }\n};\n\nconst upload = multer({\n  storage: storage,\n  fileFilter: fileFilter,\n  limits: {\n    fileSize: 5 * 1024 * 1024, // 5MB\n    files: 5 // \ucd5c\ub300 5\uac1c \ud30c\uc77c\n  }\n});\n\napp.post('/api/upload', upload.array('photos', 5), (req, res) => {\n  res.json({\n    success: true,\n    files: req.files.map(f => ({\n      filename: f.filename,\n      size: f.size,\n      mimetype: f.mimetype\n    }))\n  });\n});\n\n// \uc5d0\ub7ec \ud578\ub4e4\ub9c1\napp.use((error, req, res, next) => {\n  if (error instanceof multer.MulterError) {\n    if (error.code === 'LIMIT_FILE_SIZE') {\n      return res.status(400).json({ error: '\ud30c\uc77c \ud06c\uae30\uac00 \ub108\ubb34 \ud07d\ub2c8\ub2e4.' });\n    }\n    if (error.code === 'LIMIT_FILE_COUNT') {\n      return res.status(400).json({ error: '\ud30c\uc77c \uac1c\uc218\uac00 \ub108\ubb34 \ub9ce\uc2b5\ub2c8\ub2e4.' });\n    }\n  }\n  res.status(500).json({ error: error.message });\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1183-path-traversal-\ubc29\uc5b4",children:"11.8.3 Path Traversal \ubc29\uc5b4"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const path = require('path');\nconst fs = require('fs').promises;\n\n// \u274c \ucde8\uc57d\ud55c \ucf54\ub4dc\napp.get('/api/files/:filename', async (req, res) => {\n  const filename = req.params.filename;\n  const filePath = `./uploads/${filename}`;\n  // \uacf5\uaca9: /api/files/../../etc/passwd\n  res.sendFile(filePath);\n});\n\n// \u2705 \uc548\uc804\ud55c \ucf54\ub4dc\napp.get('/api/files/:filename', async (req, res) => {\n  const filename = req.params.filename;\n\n  // \ud30c\uc77c\uba85 \uac80\uc99d\n  if (filename.includes('..') || filename.includes('/') || filename.includes('\\\\')) {\n    return res.status(400).json({ error: 'Invalid filename' });\n  }\n\n  const uploadDir = path.resolve('./uploads');\n  const filePath = path.join(uploadDir, filename);\n\n  // \uacbd\ub85c\uac00 uploads \ub514\ub809\ud1a0\ub9ac \ub0b4\ubd80\uc778\uc9c0 \ud655\uc778\n  if (!filePath.startsWith(uploadDir)) {\n    return res.status(403).json({ error: 'Access denied' });\n  }\n\n  try {\n    await fs.access(filePath);\n    res.sendFile(filePath);\n  } catch (error) {\n    res.status(404).json({ error: 'File not found' });\n  }\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1184-json-schema-\uac80\uc99d",children:"11.8.4 JSON Schema \uac80\uc99d"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const Ajv = require('ajv');\nconst ajv = new Ajv();\n\n// \u2705 JSON Schema \uc815\uc758\nconst userSchema = {\n  type: 'object',\n  properties: {\n    username: {\n      type: 'string',\n      minLength: 3,\n      maxLength: 20,\n      pattern: '^[a-zA-Z0-9_]+$'\n    },\n    email: {\n      type: 'string',\n      format: 'email'\n    },\n    age: {\n      type: 'integer',\n      minimum: 0,\n      maximum: 150\n    },\n    roles: {\n      type: 'array',\n      items: {\n        type: 'string',\n        enum: ['user', 'admin', 'moderator']\n      },\n      uniqueItems: true\n    }\n  },\n  required: ['username', 'email'],\n  additionalProperties: false\n};\n\nconst validateUser = ajv.compile(userSchema);\n\napp.post('/api/users', (req, res) => {\n  const valid = validateUser(req.body);\n\n  if (!valid) {\n    return res.status(400).json({\n      error: 'Validation failed',\n      details: validateUser.errors\n    });\n  }\n\n  // \uac80\uc99d\ub41c \ub370\uc774\ud130 \ucc98\ub9ac\n  // ...\n});\n"})}),"\n",(0,t.jsxs)(e.admonition,{type:"warning",children:[(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\uc785\ub825 \uac80\uc99d \uc6d0\uce59:"})}),(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u2705 \ud654\uc774\ud2b8\ub9ac\uc2a4\ud2b8 \ubc29\uc2dd \uc0ac\uc6a9 (\ud5c8\uc6a9 \ubaa9\ub85d)"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \uc11c\ubc84 \uce21\uc5d0\uc11c \ud56d\uc0c1 \uac80\uc99d (\ud074\ub77c\uc774\uc5b8\ud2b8 \uac80\uc99d\uc740 \ubcf4\uc870\uc801)"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \ud0c0\uc785, \uae38\uc774, \ud615\uc2dd, \ubc94\uc704 \ubaa8\ub450 \uac80\uc99d"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \uc5d0\ub7ec \uba54\uc2dc\uc9c0\uc5d0 \ubbfc\uac10\ud55c \uc815\ubcf4 \ub178\ucd9c \uae08\uc9c0"}),"\n"]})]}),"\n",(0,t.jsx)(e.h2,{id:"119-https-\ubc0f-ssltls",children:"11.9 HTTPS \ubc0f SSL/TLS"}),"\n",(0,t.jsx)(e.p,{children:"HTTPS\ub294 \ub370\uc774\ud130\ub97c \uc554\ud638\ud654\ud558\uc5ec \uc911\uac04\uc790 \uacf5\uaca9(MITM)\uc744 \ubc29\uc9c0\ud569\ub2c8\ub2e4."}),"\n",(0,t.jsx)(e.h3,{id:"1191-https-\uc11c\ubc84-\uc124\uc815",children:"11.9.1 HTTPS \uc11c\ubc84 \uc124\uc815"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const https = require('https');\nconst fs = require('fs');\nconst express = require('express');\n\nconst app = express();\n\n// \u2705 SSL/TLS \uc778\uc99d\uc11c \ub85c\ub4dc\nconst options = {\n  key: fs.readFileSync('./ssl/private-key.pem'),\n  cert: fs.readFileSync('./ssl/certificate.pem'),\n  ca: fs.readFileSync('./ssl/ca-bundle.pem'), // \uc911\uac04 \uc778\uc99d\uc11c (\uc120\ud0dd\uc0ac\ud56d)\n  // \ucd5c\uc2e0 TLS \ubc84\uc804 \uc0ac\uc6a9\n  minVersion: 'TLSv1.2',\n  // \uac15\ub825\ud55c \uc554\ud638\ud654 \uc2a4\uc704\ud2b8\ub9cc \ud5c8\uc6a9\n  ciphers: [\n    'ECDHE-RSA-AES128-GCM-SHA256',\n    'ECDHE-RSA-AES256-GCM-SHA384',\n    'ECDHE-RSA-CHACHA20-POLY1305'\n  ].join(':'),\n  honorCipherOrder: true\n};\n\n// HTTPS \uc11c\ubc84 \uc2dc\uc791\nhttps.createServer(options, app).listen(443, () => {\n  console.log('HTTPS \uc11c\ubc84\uac00 \ud3ec\ud2b8 443\uc5d0\uc11c \uc2e4\ud589 \uc911\uc785\ub2c8\ub2e4.');\n});\n\n// HTTP to HTTPS \ub9ac\ub2e4\uc774\ub809\ud2b8\nconst http = require('http');\nhttp.createServer((req, res) => {\n  res.writeHead(301, {\n    Location: `https://${req.headers.host}${req.url}`\n  });\n  res.end();\n}).listen(80);\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1192-hsts-http-strict-transport-security",children:"11.9.2 HSTS (HTTP Strict Transport Security)"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const helmet = require('helmet');\n\n// \u2705 HSTS \uc124\uc815\napp.use(helmet.hsts({\n  maxAge: 31536000, // 1\ub144 (\ucd08 \ub2e8\uc704)\n  includeSubDomains: true, // \ubaa8\ub4e0 \uc11c\ube0c\ub3c4\uba54\uc778 \ud3ec\ud568\n  preload: true // \ube0c\ub77c\uc6b0\uc800 HSTS preload \ub9ac\uc2a4\ud2b8 \ub4f1\ub85d\n}));\n\n// \ub610\ub294 \uc218\ub3d9 \uc124\uc815\napp.use((req, res, next) => {\n  res.setHeader(\n    'Strict-Transport-Security',\n    'max-age=31536000; includeSubDomains; preload'\n  );\n  next();\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"1193-lets-encrypt-\uc790\ub3d9-\uac31\uc2e0",children:"11.9.3 Let's Encrypt \uc790\ub3d9 \uac31\uc2e0"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:'const greenlock = require(\'greenlock-express\');\n\n// \u2705 Let\'s Encrypt \uc790\ub3d9 SSL \uc778\uc99d\uc11c\ngreenlock.init({\n  packageRoot: __dirname,\n  configDir: \'./greenlock.d\',\n  maintainerEmail: \'admin@example.com\',\n  cluster: false\n}).ready((glx) => {\n  const app = require(\'./app.js\');\n\n  glx.serveApp(app);\n});\n\n// greenlock.d/config.json\n{\n  "sites": [\n    {\n      "subject": "example.com",\n      "altnames": ["example.com", "www.example.com"]\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"1194-ssltls-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",children:"11.9.4 SSL/TLS \uccb4\ud06c\ub9ac\uc2a4\ud2b8"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 \ubcf4\uc548 \uc124\uc815 \uccb4\ud06c\ub9ac\uc2a4\ud2b8\nconst securityChecklist = {\n  // 1. \ucd5c\uc2e0 TLS \ubc84\uc804 \uc0ac\uc6a9\n  tlsVersion: 'TLSv1.2 \uc774\uc0c1',\n\n  // 2. \uac15\ub825\ud55c \uc554\ud638\ud654 \uc54c\uace0\ub9ac\uc998\n  ciphers: 'ECDHE, AES-GCM, ChaCha20',\n\n  // 3. \uc778\uc99d\uc11c \uac80\uc99d\n  certificateValidation: [\n    '\uc720\ud6a8 \uae30\uac04 \ud655\uc778',\n    '\ub3c4\uba54\uc778 \uc77c\uce58 \ud655\uc778',\n    '\uc2e0\ub8b0\ud560 \uc218 \uc788\ub294 CA \ubc1c\uae09'\n  ],\n\n  // 4. HTTP to HTTPS \ub9ac\ub2e4\uc774\ub809\ud2b8\n  redirect: true,\n\n  // 5. HSTS \ud5e4\ub354\n  hsts: true,\n\n  // 6. \uc815\uae30\uc801\uc778 \uc778\uc99d\uc11c \uac31\uc2e0\n  autoRenewal: true\n};\n"})}),"\n",(0,t.jsxs)(e.admonition,{type:"warning",children:[(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"HTTPS \ud544\uc218 \uc0ac\ud56d:"})}),(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u2705 \ubaa8\ub4e0 \ud398\uc774\uc9c0\uc5d0 HTTPS \uc801\uc6a9"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 Mixed Content \uacbd\uace0 \uc81c\uac70 (HTTP \ub9ac\uc18c\uc2a4 \uc81c\uac70)"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \ucfe0\ud0a4\uc5d0 Secure \ud50c\ub798\uadf8 \uc124\uc815"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 HSTS \ud5e4\ub354 \uc124\uc815"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \uc778\uc99d\uc11c \uc790\ub3d9 \uac31\uc2e0 \uc124\uc815"}),"\n"]})]}),"\n",(0,t.jsx)(e.h2,{id:"1110-\ubcf4\uc548-\ud5e4\ub354-\uc124\uc815",children:"11.10 \ubcf4\uc548 \ud5e4\ub354 \uc124\uc815"}),"\n",(0,t.jsx)(e.p,{children:"\ubcf4\uc548 \ud5e4\ub354\ub294 \ub2e4\uc591\ud55c \uc6f9 \uacf5\uaca9\uc744 \ubc29\uc5b4\ud558\ub294 \uccab \ubc88\uc9f8 \ubc29\uc5b4\uc120\uc785\ub2c8\ub2e4."}),"\n",(0,t.jsx)(e.h3,{id:"11101-helmet\uc744-\uc0ac\uc6a9\ud55c-\ubcf4\uc548-\ud5e4\ub354",children:"11.10.1 Helmet\uc744 \uc0ac\uc6a9\ud55c \ubcf4\uc548 \ud5e4\ub354"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const helmet = require('helmet');\n\n// \u2705 \uae30\ubcf8 Helmet \uc124\uc815 (\uad8c\uc7a5)\napp.use(helmet());\n\n// \u2705 \ucee4\uc2a4\ud140 \uc124\uc815\napp.use(\n  helmet({\n    // Content Security Policy\n    contentSecurityPolicy: {\n      directives: {\n        defaultSrc: [\"'self'\"],\n        scriptSrc: [\"'self'\", \"'unsafe-inline'\", 'https://cdn.example.com'],\n        styleSrc: [\"'self'\", \"'unsafe-inline'\", 'https://fonts.googleapis.com'],\n        imgSrc: [\"'self'\", 'data:', 'https:'],\n        connectSrc: [\"'self'\", 'https://api.example.com'],\n        fontSrc: [\"'self'\", 'https://fonts.gstatic.com'],\n        objectSrc: [\"'none'\"],\n        mediaSrc: [\"'self'\"],\n        frameSrc: [\"'none'\"]\n      }\n    },\n\n    // X-DNS-Prefetch-Control\n    dnsPrefetchControl: { allow: false },\n\n    // X-Frame-Options (Clickjacking \ubc29\uc9c0)\n    frameguard: { action: 'deny' },\n\n    // X-Content-Type-Options\n    noSniff: true,\n\n    // Referrer-Policy\n    referrerPolicy: { policy: 'strict-origin-when-cross-origin' },\n\n    // X-XSS-Protection\n    xssFilter: true\n  })\n);\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11102-\uac1c\ubcc4-\ubcf4\uc548-\ud5e4\ub354-\uc124\uc815",children:"11.10.2 \uac1c\ubcc4 \ubcf4\uc548 \ud5e4\ub354 \uc124\uc815"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 Content Security Policy (CSP)\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; \" +\n    \"script-src 'self' 'unsafe-inline' https://cdn.example.com; \" +\n    \"style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; \" +\n    \"img-src 'self' data: https:; \" +\n    \"font-src 'self' https://fonts.gstatic.com; \" +\n    \"connect-src 'self' https://api.example.com; \" +\n    \"frame-ancestors 'none'; \" +\n    \"base-uri 'self'; \" +\n    \"form-action 'self'\"\n  );\n  next();\n});\n\n// \u2705 X-Frame-Options (Clickjacking \ubc29\uc9c0)\napp.use((req, res, next) => {\n  res.setHeader('X-Frame-Options', 'DENY');\n  // \ub610\ub294 \ud2b9\uc815 \ub3c4\uba54\uc778\ub9cc \ud5c8\uc6a9\n  // res.setHeader('X-Frame-Options', 'ALLOW-FROM https://trusted.com');\n  next();\n});\n\n// \u2705 X-Content-Type-Options (MIME Sniffing \ubc29\uc9c0)\napp.use((req, res, next) => {\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n  next();\n});\n\n// \u2705 Referrer-Policy\napp.use((req, res, next) => {\n  res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');\n  next();\n});\n\n// \u2705 Permissions-Policy (\uae30\ub2a5 \uc81c\uc5b4)\napp.use((req, res, next) => {\n  res.setHeader(\n    'Permissions-Policy',\n    'geolocation=(), microphone=(), camera=()'\n  );\n  next();\n});\n\n// \u2705 X-XSS-Protection (\uad6c\ud615 \ube0c\ub77c\uc6b0\uc800 \uc9c0\uc6d0)\napp.use((req, res, next) => {\n  res.setHeader('X-XSS-Protection', '1; mode=block');\n  next();\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11103-csp-nonce-\uc0ac\uc6a9",children:"11.10.3 CSP Nonce \uc0ac\uc6a9"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const crypto = require('crypto');\n\n// \u2705 CSP Nonce\ub85c \uc778\ub77c\uc778 \uc2a4\ud06c\ub9bd\ud2b8 \ud5c8\uc6a9\napp.use((req, res, next) => {\n  // \uc694\uccad\ub9c8\ub2e4 \uace0\uc720\ud55c nonce \uc0dd\uc131\n  res.locals.cspNonce = crypto.randomBytes(16).toString('base64');\n\n  res.setHeader(\n    'Content-Security-Policy',\n    `script-src 'self' 'nonce-${res.locals.cspNonce}'`\n  );\n\n  next();\n});\n\n// HTML \ud15c\ud50c\ub9bf\uc5d0\uc11c \uc0ac\uc6a9\napp.get('/', (req, res) => {\n  res.send(`\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>CSP Nonce Example</title>\n    </head>\n    <body>\n      <h1>\uc548\uc804\ud55c \uc778\ub77c\uc778 \uc2a4\ud06c\ub9bd\ud2b8</h1>\n      <script nonce=\"${res.locals.cspNonce}\">\n        console.log('\uc774 \uc2a4\ud06c\ub9bd\ud2b8\ub294 \uc2e4\ud589\ub429\ub2c8\ub2e4');\n      <\/script>\n      <script>\n        console.log('\uc774 \uc2a4\ud06c\ub9bd\ud2b8\ub294 \ucc28\ub2e8\ub429\ub2c8\ub2e4');\n      <\/script>\n    </body>\n    </html>\n  `);\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11104-\ubcf4\uc548-\ud5e4\ub354-\uac80\uc99d",children:"11.10.4 \ubcf4\uc548 \ud5e4\ub354 \uac80\uc99d"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 \ubcf4\uc548 \ud5e4\ub354 \ud655\uc778 \ubbf8\ub4e4\uc6e8\uc5b4\nfunction validateSecurityHeaders(req, res, next) {\n  const requiredHeaders = {\n    'Strict-Transport-Security': /max-age=\\d+/,\n    'X-Content-Type-Options': 'nosniff',\n    'X-Frame-Options': /(DENY|SAMEORIGIN)/,\n    'Content-Security-Policy': /.+/,\n    'Referrer-Policy': /.+/\n  };\n\n  // \uc751\ub2f5 \ud5e4\ub354 \uac80\uc99d (\ud14c\uc2a4\ud2b8\uc6a9)\n  res.on('finish', () => {\n    const headers = res.getHeaders();\n    const missing = [];\n\n    for (const [header, pattern] of Object.entries(requiredHeaders)) {\n      const value = headers[header.toLowerCase()];\n      if (!value || !value.toString().match(pattern)) {\n        missing.push(header);\n      }\n    }\n\n    if (missing.length > 0) {\n      logger.warn('Missing security headers', {\n        path: req.path,\n        missing\n      });\n    }\n  });\n\n  next();\n}\n\nif (process.env.NODE_ENV === 'development') {\n  app.use(validateSecurityHeaders);\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"1111-\ubbfc\uac10-\uc815\ubcf4-\ubcf4\ud638-\ud658\uacbd\ubcc0\uc218-\uc2dc\ud06c\ub9bf",children:"11.11 \ubbfc\uac10 \uc815\ubcf4 \ubcf4\ud638 (\ud658\uacbd\ubcc0\uc218, \uc2dc\ud06c\ub9bf)"}),"\n",(0,t.jsx)(e.h3,{id:"11111-\ud658\uacbd\ubcc0\uc218-\uad00\ub9ac",children:"11.11.1 \ud658\uacbd\ubcc0\uc218 \uad00\ub9ac"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 .env \ud30c\uc77c \uc0ac\uc6a9\nrequire('dotenv').config();\n\nconst config = {\n  // \ub370\uc774\ud130\ubca0\uc774\uc2a4\n  db: {\n    host: process.env.DB_HOST,\n    port: process.env.DB_PORT,\n    user: process.env.DB_USER,\n    password: process.env.DB_PASSWORD,\n    database: process.env.DB_NAME\n  },\n\n  // JWT\n  jwt: {\n    secret: process.env.JWT_SECRET,\n    expiresIn: process.env.JWT_EXPIRES_IN || '1h'\n  },\n\n  // API \ud0a4\n  apiKeys: {\n    stripe: process.env.STRIPE_API_KEY,\n    sendgrid: process.env.SENDGRID_API_KEY,\n    aws: {\n      accessKeyId: process.env.AWS_ACCESS_KEY_ID,\n      secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY\n    }\n  },\n\n  // \uc554\ud638\ud654 \ud0a4\n  encryption: {\n    key: process.env.ENCRYPTION_KEY,\n    algorithm: 'aes-256-gcm'\n  }\n};\n\nmodule.exports = config;\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# .env \ud30c\uc77c (\uc808\ub300 Git\uc5d0 \ucee4\ubc0b\ud558\uc9c0 \ub9d0 \uac83!)\nNODE_ENV=production\n\n# Database\nDB_HOST=localhost\nDB_PORT=5432\nDB_USER=myapp\nDB_PASSWORD=super_secret_password_123\nDB_NAME=myapp_production\n\n# JWT\nJWT_SECRET=very_long_random_secret_key_min_32_chars\nJWT_EXPIRES_IN=1h\n\n# API Keys\nSTRIPE_API_KEY=sk_live_xxxxxxxxxxxxxxxxxxxxx\nSENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxx\nAWS_ACCESS_KEY_ID=AKIAXXXXXXXXXXXXX\nAWS_SECRET_ACCESS_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n\n# Encryption\nENCRYPTION_KEY=32_byte_random_encryption_key_here\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# .env.example (Git\uc5d0 \ucee4\ubc0b \uac00\ub2a5)\nNODE_ENV=development\n\n# Database\nDB_HOST=localhost\nDB_PORT=5432\nDB_USER=your_db_user\nDB_PASSWORD=your_db_password\nDB_NAME=your_db_name\n\n# JWT\nJWT_SECRET=your_jwt_secret_min_32_chars\nJWT_EXPIRES_IN=1h\n\n# API Keys\nSTRIPE_API_KEY=your_stripe_api_key\nSENDGRID_API_KEY=your_sendgrid_api_key\nAWS_ACCESS_KEY_ID=your_aws_access_key\nAWS_SECRET_ACCESS_KEY=your_aws_secret_key\n\n# Encryption\nENCRYPTION_KEY=your_32_byte_encryption_key\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11112-\uc2dc\ud06c\ub9bf-\uac80\uc99d",children:"11.11.2 \uc2dc\ud06c\ub9bf \uac80\uc99d"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 \ud544\uc218 \ud658\uacbd\ubcc0\uc218 \uac80\uc99d\nfunction validateEnvironment() {\n  const required = [\n    'DB_HOST',\n    'DB_PASSWORD',\n    'JWT_SECRET',\n    'ENCRYPTION_KEY'\n  ];\n\n  const missing = required.filter(key => !process.env[key]);\n\n  if (missing.length > 0) {\n    throw new Error(\n      `Missing required environment variables: ${missing.join(', ')}\\n` +\n      'Please check your .env file'\n    );\n  }\n\n  // JWT Secret \uae38\uc774 \uac80\uc99d\n  if (process.env.JWT_SECRET.length < 32) {\n    throw new Error('JWT_SECRET must be at least 32 characters long');\n  }\n\n  // Encryption Key \uae38\uc774 \uac80\uc99d\n  if (Buffer.from(process.env.ENCRYPTION_KEY).length !== 32) {\n    throw new Error('ENCRYPTION_KEY must be exactly 32 bytes');\n  }\n\n  console.log('\u2713 Environment validation passed');\n}\n\n// \uc11c\ubc84 \uc2dc\uc791 \uc804 \uac80\uc99d\nvalidateEnvironment();\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11113-gitignore-\uc124\uc815",children:"11.11.3 .gitignore \uc124\uc815"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# .gitignore\n\n# Environment variables\n.env\n.env.local\n.env.*.local\n\n# Secrets\nsecrets/\n*.pem\n*.key\n*.cert\n\n# Configuration\nconfig/secrets.json\ncredentials.json\n\n# Logs (may contain sensitive data)\nlogs/\n*.log\n\n# Build artifacts\ndist/\nbuild/\n\n# Dependencies\nnode_modules/\n\n# OS files\n.DS_Store\nThumbs.db\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11114-\ud558\ub4dc\ucf54\ub529-\ubc29\uc9c0",children:"11.11.4 \ud558\ub4dc\ucf54\ub529 \ubc29\uc9c0"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u274c \uc808\ub300 \ud558\uc9c0 \ub9d0 \uac83\nconst JWT_SECRET = 'my_secret_key_123';\nconst DB_PASSWORD = 'password123';\nconst API_KEY = 'sk_live_xxxxxxxxxx';\n\n// \u2705 \ud658\uacbd\ubcc0\uc218 \uc0ac\uc6a9\nconst JWT_SECRET = process.env.JWT_SECRET;\nconst DB_PASSWORD = process.env.DB_PASSWORD;\nconst API_KEY = process.env.API_KEY;\n\n// \u2705 \uae30\ubcf8\uac12 \uc124\uc815 (\ube44\ubbfc\uac10 \uc815\ubcf4\ub9cc)\nconst PORT = process.env.PORT || 3000;\nconst LOG_LEVEL = process.env.LOG_LEVEL || 'info';\nconst RATE_LIMIT_MAX = process.env.RATE_LIMIT_MAX || 100;\n\n// \u274c \ubbfc\uac10\ud55c \uc815\ubcf4\uc5d0 \uae30\ubcf8\uac12 \uc124\uc815 \uae08\uc9c0\n// const JWT_SECRET = process.env.JWT_SECRET || 'default_secret'; // \uc704\ud5d8!\n"})}),"\n",(0,t.jsxs)(e.admonition,{type:"warning",children:[(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\ubbfc\uac10 \uc815\ubcf4 \ubcf4\ud638 \uccb4\ud06c\ub9ac\uc2a4\ud2b8:"})}),(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u2705 .env \ud30c\uc77c\uc744 .gitignore\uc5d0 \ucd94\uac00"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 .env.example \ud30c\uc77c \uc81c\uacf5 (\uac12 \uc81c\uc678)"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \ud658\uacbd\ubcc0\uc218 \uac80\uc99d \ub85c\uc9c1 \ucd94\uac00"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \ucf54\ub4dc\uc5d0 \uc2dc\ud06c\ub9bf \ud558\ub4dc\ucf54\ub529 \uae08\uc9c0"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \ub85c\uadf8\uc5d0 \ubbfc\uac10\ud55c \uc815\ubcf4 \ucd9c\ub825 \uae08\uc9c0"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \uc5d0\ub7ec \uba54\uc2dc\uc9c0\uc5d0 \ubbfc\uac10\ud55c \uc815\ubcf4 \ud3ec\ud568 \uae08\uc9c0"}),"\n"]})]}),"\n",(0,t.jsx)(e.h2,{id:"1112-api-\ud0a4-\uad00\ub9ac",children:"11.12 API \ud0a4 \uad00\ub9ac"}),"\n",(0,t.jsx)(e.h3,{id:"11121-api-\ud0a4-\uc0dd\uc131",children:"11.12.1 API \ud0a4 \uc0dd\uc131"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const crypto = require('crypto');\n\n// \u2705 \uc548\uc804\ud55c API \ud0a4 \uc0dd\uc131\nfunction generateApiKey() {\n  return crypto.randomBytes(32).toString('hex');\n}\n\n// \u2705 API \ud0a4 \ud574\uc2f1 (\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc800\uc7a5\uc6a9)\nasync function hashApiKey(apiKey) {\n  const hash = crypto\n    .createHash('sha256')\n    .update(apiKey)\n    .digest('hex');\n  return hash;\n}\n\n// API \ud0a4 \ubc1c\uae09\napp.post('/api/keys', authenticateToken, async (req, res) => {\n  const userId = req.user.id;\n  const { name, permissions } = req.body;\n\n  // API \ud0a4 \uc0dd\uc131\n  const apiKey = generateApiKey();\n  const apiKeyHash = await hashApiKey(apiKey);\n\n  // \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \ud574\uc2dc\ub9cc \uc800\uc7a5\n  await db.execute(\n    `INSERT INTO api_keys\n     (user_id, name, key_hash, permissions, created_at)\n     VALUES (?, ?, ?, ?, NOW())`,\n    [userId, name, apiKeyHash, JSON.stringify(permissions)]\n  );\n\n  // API \ud0a4\ub294 \ud55c \ubc88\ub9cc \ubc18\ud658 (\uc7ac\uc870\ud68c \ubd88\uac00)\n  res.json({\n    apiKey: apiKey, // \uc0ac\uc6a9\uc790\uac00 \ubcf5\uc0ac\ud574\uc57c \ud568\n    name: name,\n    permissions: permissions,\n    message: '\uc774 API \ud0a4\ub294 \ub2e4\uc2dc \ud655\uc778\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uc548\uc804\ud55c \uacf3\uc5d0 \ubcf4\uad00\ud558\uc138\uc694.'\n  });\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11122-api-\ud0a4-\uc778\uc99d-\ubbf8\ub4e4\uc6e8\uc5b4",children:"11.12.2 API \ud0a4 \uc778\uc99d \ubbf8\ub4e4\uc6e8\uc5b4"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 API \ud0a4 \uac80\uc99d \ubbf8\ub4e4\uc6e8\uc5b4\nasync function authenticateApiKey(req, res, next) {\n  const apiKey = req.headers['x-api-key'];\n\n  if (!apiKey) {\n    return res.status(401).json({\n      error: 'API key is required',\n      hint: 'Include X-API-Key header'\n    });\n  }\n\n  try {\n    // API \ud0a4 \ud574\uc2f1\n    const apiKeyHash = await hashApiKey(apiKey);\n\n    // \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0\uc11c \uc870\ud68c\n    const [rows] = await db.execute(\n      `SELECT ak.*, u.id as user_id, u.username, u.email\n       FROM api_keys ak\n       JOIN users u ON ak.user_id = u.id\n       WHERE ak.key_hash = ? AND ak.revoked_at IS NULL`,\n      [apiKeyHash]\n    );\n\n    if (rows.length === 0) {\n      return res.status(401).json({ error: 'Invalid API key' });\n    }\n\n    const keyData = rows[0];\n\n    // \ub9cc\ub8cc \ud655\uc778\n    if (keyData.expires_at && new Date(keyData.expires_at) < new Date()) {\n      return res.status(401).json({ error: 'API key expired' });\n    }\n\n    // \ub9c8\uc9c0\ub9c9 \uc0ac\uc6a9 \uc2dc\uac04 \uc5c5\ub370\uc774\ud2b8\n    await db.execute(\n      'UPDATE api_keys SET last_used_at = NOW() WHERE id = ?',\n      [keyData.id]\n    );\n\n    // \uc694\uccad \uac1d\uccb4\uc5d0 \uc0ac\uc6a9\uc790 \ubc0f \uad8c\ud55c \uc815\ubcf4 \ucd94\uac00\n    req.user = {\n      id: keyData.user_id,\n      username: keyData.username,\n      email: keyData.email\n    };\n    req.apiKey = {\n      id: keyData.id,\n      name: keyData.name,\n      permissions: JSON.parse(keyData.permissions)\n    };\n\n    next();\n  } catch (error) {\n    logger.error('API key authentication error', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n}\n\n// \uc0ac\uc6a9 \uc608\uc2dc\napp.get('/api/data', authenticateApiKey, (req, res) => {\n  // \uad8c\ud55c \ud655\uc778\n  if (!req.apiKey.permissions.includes('read')) {\n    return res.status(403).json({ error: 'Insufficient permissions' });\n  }\n\n  res.json({ data: 'some data' });\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11123-api-\ud0a4-\uad8c\ud55c-\uad00\ub9ac",children:"11.12.3 API \ud0a4 \uad8c\ud55c \uad00\ub9ac"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 \uad8c\ud55c \uae30\ubc18 \uc811\uadfc \uc81c\uc5b4\nfunction requirePermission(...permissions) {\n  return (req, res, next) => {\n    const userPermissions = req.apiKey?.permissions || [];\n\n    const hasPermission = permissions.some(p =>\n      userPermissions.includes(p)\n    );\n\n    if (!hasPermission) {\n      return res.status(403).json({\n        error: 'Insufficient permissions',\n        required: permissions,\n        current: userPermissions\n      });\n    }\n\n    next();\n  };\n}\n\n// \uc0ac\uc6a9 \uc608\uc2dc\napp.get('/api/users',\n  authenticateApiKey,\n  requirePermission('users:read'),\n  async (req, res) => {\n    // \uc0ac\uc6a9\uc790 \ubaa9\ub85d \ubc18\ud658\n  }\n);\n\napp.post('/api/users',\n  authenticateApiKey,\n  requirePermission('users:write'),\n  async (req, res) => {\n    // \uc0ac\uc6a9\uc790 \uc0dd\uc131\n  }\n);\n\napp.delete('/api/users/:id',\n  authenticateApiKey,\n  requirePermission('users:delete', 'admin'),\n  async (req, res) => {\n    // \uc0ac\uc6a9\uc790 \uc0ad\uc81c\n  }\n);\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11124-api-\ud0a4-\uad00\ub9ac-\uae30\ub2a5",children:"11.12.4 API \ud0a4 \uad00\ub9ac \uae30\ub2a5"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 API \ud0a4 \ubaa9\ub85d \uc870\ud68c\napp.get('/api/keys', authenticateToken, async (req, res) => {\n  const userId = req.user.id;\n\n  const [keys] = await db.execute(\n    `SELECT\n      id,\n      name,\n      LEFT(key_hash, 8) as key_prefix,\n      permissions,\n      created_at,\n      last_used_at,\n      expires_at,\n      revoked_at\n     FROM api_keys\n     WHERE user_id = ?\n     ORDER BY created_at DESC`,\n    [userId]\n  );\n\n  res.json({ keys });\n});\n\n// \u2705 API \ud0a4 \ud3d0\uae30\napp.delete('/api/keys/:id', authenticateToken, async (req, res) => {\n  const userId = req.user.id;\n  const keyId = req.params.id;\n\n  await db.execute(\n    'UPDATE api_keys SET revoked_at = NOW() WHERE id = ? AND user_id = ?',\n    [keyId, userId]\n  );\n\n  res.json({ success: true, message: 'API key revoked' });\n});\n\n// \u2705 API \ud0a4 \uac31\uc2e0\napp.post('/api/keys/:id/rotate', authenticateToken, async (req, res) => {\n  const userId = req.user.id;\n  const keyId = req.params.id;\n\n  // \uae30\uc874 \ud0a4 \uc870\ud68c\n  const [oldKeys] = await db.execute(\n    'SELECT * FROM api_keys WHERE id = ? AND user_id = ?',\n    [keyId, userId]\n  );\n\n  if (oldKeys.length === 0) {\n    return res.status(404).json({ error: 'API key not found' });\n  }\n\n  const oldKey = oldKeys[0];\n\n  // \uc0c8 API \ud0a4 \uc0dd\uc131\n  const newApiKey = generateApiKey();\n  const newApiKeyHash = await hashApiKey(newApiKey);\n\n  // \ud2b8\ub79c\uc7ad\uc158\uc73c\ub85c \ucc98\ub9ac\n  await db.beginTransaction();\n\n  try {\n    // \uae30\uc874 \ud0a4 \ud3d0\uae30\n    await db.execute(\n      'UPDATE api_keys SET revoked_at = NOW() WHERE id = ?',\n      [keyId]\n    );\n\n    // \uc0c8 \ud0a4 \uc0dd\uc131\n    await db.execute(\n      `INSERT INTO api_keys\n       (user_id, name, key_hash, permissions, created_at)\n       VALUES (?, ?, ?, ?, NOW())`,\n      [userId, oldKey.name, newApiKeyHash, oldKey.permissions]\n    );\n\n    await db.commit();\n\n    res.json({\n      apiKey: newApiKey,\n      message: '\uc0c8 API \ud0a4\uac00 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uae30\uc874 \ud0a4\ub294 \ud3d0\uae30\ub418\uc5c8\uc2b5\ub2c8\ub2e4.'\n    });\n  } catch (error) {\n    await db.rollback();\n    throw error;\n  }\n});\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11125-api-\ud0a4-\uc0ac\uc6a9\ub7c9-\ucd94\uc801",children:"11.12.5 API \ud0a4 \uc0ac\uc6a9\ub7c9 \ucd94\uc801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 API \ud0a4 \uc0ac\uc6a9\ub7c9 \ub85c\uae45\nconst apiKeyUsageLogger = async (req, res, next) => {\n  if (!req.apiKey) {\n    return next();\n  }\n\n  const startTime = Date.now();\n\n  res.on('finish', async () => {\n    const duration = Date.now() - startTime;\n\n    try {\n      await db.execute(\n        `INSERT INTO api_key_usage\n         (api_key_id, endpoint, method, status_code, duration_ms, timestamp)\n         VALUES (?, ?, ?, ?, ?, NOW())`,\n        [\n          req.apiKey.id,\n          req.path,\n          req.method,\n          res.statusCode,\n          duration\n        ]\n      );\n    } catch (error) {\n      logger.error('Failed to log API key usage', error);\n    }\n  });\n\n  next();\n};\n\napp.use(authenticateApiKey, apiKeyUsageLogger);\n\n// \u2705 \uc0ac\uc6a9\ub7c9 \ud1b5\uacc4 \uc870\ud68c\napp.get('/api/keys/:id/stats', authenticateToken, async (req, res) => {\n  const keyId = req.params.id;\n  const userId = req.user.id;\n\n  // \uad8c\ud55c \ud655\uc778\n  const [keys] = await db.execute(\n    'SELECT * FROM api_keys WHERE id = ? AND user_id = ?',\n    [keyId, userId]\n  );\n\n  if (keys.length === 0) {\n    return res.status(404).json({ error: 'API key not found' });\n  }\n\n  // \uc0ac\uc6a9\ub7c9 \ud1b5\uacc4\n  const [stats] = await db.execute(\n    `SELECT\n      COUNT(*) as total_requests,\n      COUNT(CASE WHEN status_code < 400 THEN 1 END) as successful_requests,\n      COUNT(CASE WHEN status_code >= 400 THEN 1 END) as failed_requests,\n      AVG(duration_ms) as avg_duration,\n      MAX(timestamp) as last_used\n     FROM api_key_usage\n     WHERE api_key_id = ?\n     AND timestamp > DATE_SUB(NOW(), INTERVAL 30 DAY)`,\n    [keyId]\n  );\n\n  res.json({ stats: stats[0] });\n});\n"})}),"\n",(0,t.jsx)(e.h2,{id:"1113-\ubcf4\uc548-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",children:"11.13 \ubcf4\uc548 \uccb4\ud06c\ub9ac\uc2a4\ud2b8"}),"\n",(0,t.jsx)(e.h3,{id:"11131-\uac1c\ubc1c-\ub2e8\uacc4-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",children:"11.13.1 \uac1c\ubc1c \ub2e8\uacc4 \uccb4\ud06c\ub9ac\uc2a4\ud2b8"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-markdown",children:"## \uc778\uc99d \ubc0f \uad8c\ud55c\n\n- [ ] \ube44\ubc00\ubc88\ud638\ub294 bcrypt \ub4f1\uc73c\ub85c \ud574\uc2f1 (\ucd5c\uc18c 12 rounds)\n- [ ] JWT Secret\uc740 \ucda9\ubd84\ud788 \uac15\ub825\ud558\uace0 \ud658\uacbd\ubcc0\uc218\ub85c \uad00\ub9ac\n- [ ] \uc138\uc158\uc740 \uc11c\ubc84 \uce21\uc5d0\uc11c \uac80\uc99d\n- [ ] \uc811\uadfc \uc81c\uc5b4\ub294 \uc11c\ubc84 \uce21\uc5d0\uc11c \uac80\uc99d\n- [ ] \ucd5c\uc18c \uad8c\ud55c \uc6d0\uce59 \uc801\uc6a9\n- [ ] \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \ud1a0\ud070\uc740 \uc77c\ud68c\uc131 \ubc0f \ub9cc\ub8cc \uc2dc\uac04 \uc124\uc815\n\n## \uc785\ub825 \uac80\uc99d\n\n- [ ] \ubaa8\ub4e0 \uc0ac\uc6a9\uc790 \uc785\ub825 \uac80\uc99d (\ud0c0\uc785, \uae38\uc774, \ud615\uc2dd)\n- [ ] SQL Injection \ubc29\uc5b4 (Prepared Statements)\n- [ ] XSS \ubc29\uc5b4 (\uc785\ub825 \uc815\uc81c, \ucd9c\ub825 \uc774\uc2a4\ucf00\uc774\ud504)\n- [ ] Path Traversal \ubc29\uc5b4\n- [ ] \ud30c\uc77c \uc5c5\ub85c\ub4dc \uac80\uc99d (\ud0c0\uc785, \ud06c\uae30, \ud655\uc7a5\uc790)\n- [ ] JSON Schema \ub610\ub294 validator \ub77c\uc774\ube0c\ub7ec\ub9ac \uc0ac\uc6a9\n\n## \ubcf4\uc548 \ud5e4\ub354\n\n- [ ] Content-Security-Policy \uc124\uc815\n- [ ] X-Frame-Options \uc124\uc815 (Clickjacking \ubc29\uc9c0)\n- [ ] X-Content-Type-Options: nosniff\n- [ ] Strict-Transport-Security (HSTS)\n- [ ] Referrer-Policy \uc124\uc815\n- [ ] Permissions-Policy \uc124\uc815\n\n## HTTPS \ubc0f \uc554\ud638\ud654\n\n- [ ] \ubaa8\ub4e0 \ud1b5\uc2e0\uc5d0 HTTPS \uc0ac\uc6a9\n- [ ] TLS 1.2 \uc774\uc0c1 \uc0ac\uc6a9\n- [ ] \uac15\ub825\ud55c \uc554\ud638\ud654 \uc2a4\uc704\ud2b8 \uc124\uc815\n- [ ] HSTS \ud5e4\ub354 \uc124\uc815\n- [ ] HTTP to HTTPS \ub9ac\ub2e4\uc774\ub809\ud2b8\n- [ ] \ucfe0\ud0a4\uc5d0 Secure \ud50c\ub798\uadf8 \uc124\uc815\n\n## CSRF \ubc29\uc5b4\n\n- [ ] CSRF \ud1a0\ud070 \uc0ac\uc6a9\n- [ ] SameSite \ucfe0\ud0a4 \uc18d\uc131 \uc124\uc815\n- [ ] \uc911\uc694\ud55c \uc791\uc5c5\uc5d0 \uc7ac\uc778\uc99d \uc694\uad6c\n- [ ] Origin/Referer \ud5e4\ub354 \uac80\uc99d\n\n## CORS\n\n- [ ] \ud5c8\uc6a9\ud560 \ub3c4\uba54\uc778 \uba85\uc2dc\uc801 \uc9c0\uc815\n- [ ] credentials: true \uc0ac\uc6a9 \uc2dc origin: '*' \uae08\uc9c0\n- [ ] \ud544\uc694\ud55c HTTP \uba54\uc11c\ub4dc\ub9cc \ud5c8\uc6a9\n\n## Rate Limiting\n\n- [ ] API Rate Limiting \uad6c\ud604\n- [ ] \ub85c\uadf8\uc778/\ud68c\uc6d0\uac00\uc785 \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \uc5c4\uaca9\ud55c \uc81c\ud55c\n- [ ] \uacc4\uce35\ubcc4 \ub2e4\ub978 \uc81c\ud55c \uc801\uc6a9\n- [ ] Redis \ub4f1\uc73c\ub85c \ubd84\uc0b0 \ud658\uacbd \uc9c0\uc6d0\n\n## \ubbfc\uac10 \uc815\ubcf4 \ubcf4\ud638\n\n- [ ] \ud658\uacbd\ubcc0\uc218\ub85c \uc2dc\ud06c\ub9bf \uad00\ub9ac\n- [ ] .env \ud30c\uc77c\uc744 .gitignore\uc5d0 \ucd94\uac00\n- [ ] \ucf54\ub4dc\uc5d0 \uc2dc\ud06c\ub9bf \ud558\ub4dc\ucf54\ub529 \uae08\uc9c0\n- [ ] \ub85c\uadf8\uc5d0 \ubbfc\uac10\ud55c \uc815\ubcf4 \ucd9c\ub825 \uae08\uc9c0\n- [ ] \uc5d0\ub7ec \uba54\uc2dc\uc9c0\uc5d0 \uc0c1\uc138 \uc815\ubcf4 \ub178\ucd9c \uae08\uc9c0\n\n## API \ud0a4 \uad00\ub9ac\n\n- [ ] API \ud0a4\ub294 \ud574\uc2dc\ud558\uc5ec \uc800\uc7a5\n- [ ] API \ud0a4 \uad8c\ud55c \uad00\ub9ac\n- [ ] API \ud0a4 \ub9cc\ub8cc \ubc0f \ud3d0\uae30 \uae30\ub2a5\n- [ ] API \ud0a4 \uc0ac\uc6a9\ub7c9 \ucd94\uc801\n\n## \ub85c\uae45 \ubc0f \ubaa8\ub2c8\ud130\ub9c1\n\n- [ ] \ubcf4\uc548 \uc774\ubca4\ud2b8 \ub85c\uae45\n- [ ] \ub85c\uadf8\uc5d0 \ubbfc\uac10\ud55c \uc815\ubcf4 \uc81c\uc678\n- [ ] \uc774\uc0c1 \ud65c\ub3d9 \uac10\uc9c0 \ubc0f \uc54c\ub9bc\n- [ ] \uc815\uae30\uc801\uc778 \ub85c\uadf8 \uac80\ud1a0\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11132-\ubc30\ud3ec-\uc804-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",children:"11.13.2 \ubc30\ud3ec \uc804 \uccb4\ud06c\ub9ac\uc2a4\ud2b8"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"// \u2705 \ubcf4\uc548 \uac10\uc0ac \uc2a4\ud06c\ub9bd\ud2b8\nconst securityAudit = {\n  environment: {\n    checks: [\n      { name: 'NODE_ENV is production',\n        test: () => process.env.NODE_ENV === 'production' },\n      { name: 'Debug mode is disabled',\n        test: () => process.env.DEBUG !== 'true' },\n      { name: 'All required env vars are set',\n        test: () => validateEnvironment() }\n    ]\n  },\n\n  dependencies: {\n    checks: [\n      { name: 'No known vulnerabilities',\n        command: 'npm audit --production' },\n      { name: 'Dependencies are up to date',\n        command: 'npm outdated' }\n    ]\n  },\n\n  configuration: {\n    checks: [\n      { name: 'HTTPS is enabled',\n        test: () => process.env.HTTPS === 'true' },\n      { name: 'HSTS is configured',\n        test: () => true }, // \ud5e4\ub354 \ud655\uc778\n      { name: 'CSP is configured',\n        test: () => true },\n      { name: 'Rate limiting is enabled',\n        test: () => true }\n    ]\n  },\n\n  secrets: {\n    checks: [\n      { name: 'No secrets in code',\n        command: 'git secrets --scan' },\n      { name: 'No .env in git',\n        command: 'git ls-files | grep .env' }\n    ]\n  }\n};\n\n// \uac10\uc0ac \uc2e4\ud589\nasync function runSecurityAudit() {\n  console.log('\ud83d\udd12 Running security audit...\\n');\n\n  let passed = 0;\n  let failed = 0;\n\n  for (const [category, { checks }] of Object.entries(securityAudit)) {\n    console.log(`\\n\ud83d\udccb ${category.toUpperCase()}`);\n\n    for (const check of checks) {\n      try {\n        const result = check.test ? check.test() : true;\n        if (result) {\n          console.log(`  \u2705 ${check.name}`);\n          passed++;\n        } else {\n          console.log(`  \u274c ${check.name}`);\n          failed++;\n        }\n      } catch (error) {\n        console.log(`  \u274c ${check.name}: ${error.message}`);\n        failed++;\n      }\n    }\n  }\n\n  console.log(`\\n\ud83d\udcca Results: ${passed} passed, ${failed} failed`);\n\n  if (failed > 0) {\n    console.log('\\n\u26a0\ufe0f  Security audit failed. Please fix the issues above.');\n    process.exit(1);\n  } else {\n    console.log('\\n\u2705 Security audit passed!');\n  }\n}\n\n// \ubc30\ud3ec \uc804 \uc790\ub3d9 \uc2e4\ud589\nif (process.env.PRE_DEPLOY === 'true') {\n  runSecurityAudit();\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"11133-\uc815\uae30-\ubcf4\uc548-\uc810\uac80",children:"11.13.3 \uc815\uae30 \ubcf4\uc548 \uc810\uac80"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-markdown",children:"## \uc6d4\uac04 \ubcf4\uc548 \uc810\uac80\n\n### \uc758\uc874\uc131 \uc810\uac80\n- [ ] `npm audit` \uc2e4\ud589 \ubc0f \ucde8\uc57d\uc810 \ud574\uacb0\n- [ ] \uc758\uc874\uc131 \uc5c5\ub370\uc774\ud2b8 (`npm outdated` \ud655\uc778)\n- [ ] \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub294 \ud328\ud0a4\uc9c0 \uc81c\uac70\n\n### \uc778\uc99d\uc11c \uc810\uac80\n- [ ] SSL/TLS \uc778\uc99d\uc11c \ub9cc\ub8cc\uc77c \ud655\uc778\n- [ ] \uc778\uc99d\uc11c \uc790\ub3d9 \uac31\uc2e0 \ub3d9\uc791 \ud655\uc778\n\n### \ub85c\uadf8 \ubd84\uc11d\n- [ ] \ubcf4\uc548 \uc774\ubca4\ud2b8 \ub85c\uadf8 \uac80\ud1a0\n- [ ] \uc774\uc0c1 \ud65c\ub3d9 \ud328\ud134 \ud655\uc778\n- [ ] \uc2e4\ud328\ud55c \ub85c\uadf8\uc778 \uc2dc\ub3c4 \ubd84\uc11d\n\n### \uc811\uadfc \uad8c\ud55c \uc810\uac80\n- [ ] \uc0ac\uc6a9\uc790 \uad8c\ud55c \uc7ac\uac80\ud1a0\n- [ ] \ube44\ud65c\uc131 \uacc4\uc815 \ube44\ud65c\uc131\ud654\n- [ ] API \ud0a4 \uc0ac\uc6a9 \ud604\ud669 \ud655\uc778\n\n### \ubc31\uc5c5 \uc810\uac80\n- [ ] \ubc31\uc5c5 \uc815\uc0c1 \ub3d9\uc791 \ud655\uc778\n- [ ] \ubcf5\uad6c \ud14c\uc2a4\ud2b8 \uc218\ud589\n- [ ] \ubc31\uc5c5 \ub370\uc774\ud130 \uc554\ud638\ud654 \ud655\uc778\n\n### \ucf54\ub4dc \ub9ac\ubdf0\n- [ ] \ubcf4\uc548 \uad00\ub828 \ucf54\ub4dc \ubcc0\uacbd \uc0ac\ud56d \uac80\ud1a0\n- [ ] \ud558\ub4dc\ucf54\ub529\ub41c \uc2dc\ud06c\ub9bf \uac80\uc0ac\n- [ ] \uc0c8\ub85c\uc6b4 \ubcf4\uc548 \ucde8\uc57d\uc810 \ud655\uc778\n"})}),"\n",(0,t.jsx)(e.h2,{id:"1114-\uc2e4\uc2b5-\ubb38\uc81c",children:"11.14 \uc2e4\uc2b5 \ubb38\uc81c"}),"\n",(0,t.jsx)(e.h3,{id:"\ubb38\uc81c-1-\uc548\uc804\ud55c-\ub85c\uadf8\uc778-api-\uad6c\ud604",children:"\ubb38\uc81c 1: \uc548\uc804\ud55c \ub85c\uadf8\uc778 API \uad6c\ud604"}),"\n",(0,t.jsx)(e.p,{children:"\ub2e4\uc74c \uc694\uad6c\uc0ac\ud56d\uc744 \ub9cc\uc871\ud558\ub294 \ub85c\uadf8\uc778 API\ub97c \uad6c\ud604\ud558\uc138\uc694:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"bcrypt\ub97c \uc0ac\uc6a9\ud55c \ube44\ubc00\ubc88\ud638 \uac80\uc99d"}),"\n",(0,t.jsx)(e.li,{children:"JWT \ud1a0\ud070 \ubc1c\uae09"}),"\n",(0,t.jsx)(e.li,{children:"Rate Limiting \uc801\uc6a9 (5\ubc88 \uc2dc\ub3c4 \uc81c\ud55c)"}),"\n",(0,t.jsx)(e.li,{children:"\ubcf4\uc548 \ub85c\uae45"}),"\n"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"\ud574\ub2f5"}),(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const express = require('express');\nconst bcrypt = require('bcrypt');\nconst jwt = require('jsonwebtoken');\nconst rateLimit = require('express-rate-limit');\n\nconst app = express();\napp.use(express.json());\n\n// Rate Limiter\nconst loginLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15\ubd84\n  max: 5, // \ucd5c\ub300 5\ubc88 \uc2dc\ub3c4\n  message: '\ub85c\uadf8\uc778 \uc2dc\ub3c4 \ud69f\uc218\ub97c \ucd08\uacfc\ud588\uc2b5\ub2c8\ub2e4.',\n  skipSuccessfulRequests: true\n});\n\n// \ub85c\uadf8\uc778 API\napp.post('/api/auth/login', loginLimiter, async (req, res) => {\n  const { email, password } = req.body;\n\n  try {\n    // \uc785\ub825 \uac80\uc99d\n    if (!email || !password) {\n      logger.warn('Login attempt with missing credentials', { ip: req.ip });\n      return res.status(400).json({\n        error: '\uc774\uba54\uc77c\uacfc \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.'\n      });\n    }\n\n    // \uc0ac\uc6a9\uc790 \uc870\ud68c\n    const [users] = await db.execute(\n      'SELECT id, email, password_hash, username FROM users WHERE email = ?',\n      [email]\n    );\n\n    if (users.length === 0) {\n      logger.warn('Login attempt with non-existent email', {\n        email,\n        ip: req.ip\n      });\n      return res.status(401).json({\n        error: '\uc774\uba54\uc77c \ub610\ub294 \ube44\ubc00\ubc88\ud638\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.'\n      });\n    }\n\n    const user = users[0];\n\n    // \ube44\ubc00\ubc88\ud638 \uac80\uc99d\n    const isValidPassword = await bcrypt.compare(password, user.password_hash);\n\n    if (!isValidPassword) {\n      logger.warn('Login attempt with invalid password', {\n        userId: user.id,\n        ip: req.ip\n      });\n      return res.status(401).json({\n        error: '\uc774\uba54\uc77c \ub610\ub294 \ube44\ubc00\ubc88\ud638\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.'\n      });\n    }\n\n    // JWT \ud1a0\ud070 \uc0dd\uc131\n    const token = jwt.sign(\n      {\n        id: user.id,\n        email: user.email,\n        username: user.username\n      },\n      process.env.JWT_SECRET,\n      {\n        expiresIn: '1h',\n        issuer: 'myapp',\n        audience: 'myapp-users'\n      }\n    );\n\n    // \uc131\uacf5 \ub85c\uadf8\n    logger.info('Successful login', {\n      userId: user.id,\n      ip: req.ip\n    });\n\n    // \ub9c8\uc9c0\ub9c9 \ub85c\uadf8\uc778 \uc2dc\uac04 \uc5c5\ub370\uc774\ud2b8\n    await db.execute(\n      'UPDATE users SET last_login_at = NOW() WHERE id = ?',\n      [user.id]\n    );\n\n    res.json({\n      token,\n      user: {\n        id: user.id,\n        email: user.email,\n        username: user.username\n      }\n    });\n\n  } catch (error) {\n    logger.error('Login error', { error, ip: req.ip });\n    res.status(500).json({ error: '\uc11c\ubc84 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.' });\n  }\n});\n\n// JWT \uac80\uc99d \ubbf8\ub4e4\uc6e8\uc5b4\nfunction authenticateToken(req, res, next) {\n  const authHeader = req.headers['authorization'];\n  const token = authHeader && authHeader.split(' ')[1];\n\n  if (!token) {\n    return res.status(401).json({ error: '\uc778\uc99d \ud1a0\ud070\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.' });\n  }\n\n  try {\n    const user = jwt.verify(token, process.env.JWT_SECRET, {\n      issuer: 'myapp',\n      audience: 'myapp-users'\n    });\n    req.user = user;\n    next();\n  } catch (error) {\n    logger.warn('Invalid token', { error: error.message, ip: req.ip });\n    res.status(403).json({ error: '\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ud1a0\ud070\uc785\ub2c8\ub2e4.' });\n  }\n}\n\n// \ubcf4\ud638\ub41c \ub77c\uc6b0\ud2b8 \uc608\uc2dc\napp.get('/api/profile', authenticateToken, async (req, res) => {\n  const [users] = await db.execute(\n    'SELECT id, email, username, created_at FROM users WHERE id = ?',\n    [req.user.id]\n  );\n\n  res.json({ user: users[0] });\n});\n"})})]}),"\n",(0,t.jsx)(e.h3,{id:"\ubb38\uc81c-2-xss-\ubc29\uc5b4-\ub313\uae00-\uc2dc\uc2a4\ud15c",children:"\ubb38\uc81c 2: XSS \ubc29\uc5b4 \ub313\uae00 \uc2dc\uc2a4\ud15c"}),"\n",(0,t.jsx)(e.p,{children:"\ub2e4\uc74c \uc694\uad6c\uc0ac\ud56d\uc744 \ub9cc\uc871\ud558\ub294 \ub313\uae00 \uc2dc\uc2a4\ud15c\uc744 \uad6c\ud604\ud558\uc138\uc694:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"DOMPurify\ub97c \uc0ac\uc6a9\ud55c HTML \uc815\uc81c"}),"\n",(0,t.jsxs)(e.li,{children:["\ud5c8\uc6a9\ub41c \ud0dc\uadf8\ub9cc \uc0ac\uc6a9 \uac00\ub2a5 (",(0,t.jsx)(e.code,{children:"<b>"}),", ",(0,t.jsx)(e.code,{children:"<i>"}),", ",(0,t.jsx)(e.code,{children:"<a>"}),")"]}),"\n",(0,t.jsx)(e.li,{children:"URL \uac80\uc99d"}),"\n"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"\ud574\ub2f5"}),(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const createDOMPurify = require('dompurify');\nconst { JSDOM } = require('jsdom');\nconst { body, validationResult } = require('express-validator');\n\nconst window = new JSDOM('').window;\nconst DOMPurify = createDOMPurify(window);\n\n// \ub313\uae00 \uc791\uc131 API\napp.post('/api/comments',\n  authenticateToken,\n  [\n    body('content')\n      .isLength({ min: 1, max: 1000 })\n      .withMessage('\ub313\uae00\uc740 1-1000\uc790 \uc0ac\uc774\uc5ec\uc57c \ud569\ub2c8\ub2e4'),\n    body('postId')\n      .isInt()\n      .withMessage('\uc720\ud6a8\ud55c \uac8c\uc2dc\uae00 ID\uac00 \ud544\uc694\ud569\ub2c8\ub2e4')\n  ],\n  async (req, res) => {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return res.status(400).json({ errors: errors.array() });\n    }\n\n    const { content, postId } = req.body;\n    const userId = req.user.id;\n\n    try {\n      // HTML \uc815\uc81c\n      const sanitizedContent = DOMPurify.sanitize(content, {\n        ALLOWED_TAGS: ['b', 'i', 'em', 'strong', 'a', 'p', 'br'],\n        ALLOWED_ATTR: ['href'],\n        ALLOW_DATA_ATTR: false,\n        // URL \ud504\ub85c\ud1a0\ucf5c \uc81c\ud55c\n        ALLOWED_URI_REGEXP: /^(?:(?:https?|mailto):)/i\n      });\n\n      // \ube48 \ub0b4\uc6a9 \uccb4\ud06c (\ud0dc\uadf8\ub9cc \uc788\ub294 \uacbd\uc6b0)\n      const textContent = DOMPurify.sanitize(content, {\n        ALLOWED_TAGS: []\n      }).trim();\n\n      if (textContent.length === 0) {\n        return res.status(400).json({\n          error: '\ub313\uae00 \ub0b4\uc6a9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.'\n        });\n      }\n\n      // \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc800\uc7a5\n      const [result] = await db.execute(\n        `INSERT INTO comments (post_id, user_id, content, created_at)\n         VALUES (?, ?, ?, NOW())`,\n        [postId, userId, sanitizedContent]\n      );\n\n      // \uc0dd\uc131\ub41c \ub313\uae00 \uc870\ud68c\n      const [comments] = await db.execute(\n        `SELECT\n          c.id,\n          c.content,\n          c.created_at,\n          u.username,\n          u.id as user_id\n         FROM comments c\n         JOIN users u ON c.user_id = u.id\n         WHERE c.id = ?`,\n        [result.insertId]\n      );\n\n      res.status(201).json({ comment: comments[0] });\n\n    } catch (error) {\n      logger.error('Failed to create comment', error);\n      res.status(500).json({ error: '\ub313\uae00 \uc791\uc131\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.' });\n    }\n  }\n);\n\n// \ub313\uae00 \uc870\ud68c API\napp.get('/api/posts/:postId/comments', async (req, res) => {\n  const postId = req.params.postId;\n\n  try {\n    const [comments] = await db.execute(\n      `SELECT\n        c.id,\n        c.content,\n        c.created_at,\n        u.username,\n        u.id as user_id\n       FROM comments c\n       JOIN users u ON c.user_id = u.id\n       WHERE c.post_id = ?\n       ORDER BY c.created_at DESC`,\n      [postId]\n    );\n\n    // \uc751\ub2f5 \uc2dc\uc5d0\ub3c4 \uc815\uc81c (\uc774\uc911 \ubc29\uc5b4)\n    const sanitizedComments = comments.map(comment => ({\n      ...comment,\n      content: DOMPurify.sanitize(comment.content, {\n        ALLOWED_TAGS: ['b', 'i', 'em', 'strong', 'a', 'p', 'br'],\n        ALLOWED_ATTR: ['href']\n      })\n    }));\n\n    res.json({ comments: sanitizedComments });\n\n  } catch (error) {\n    logger.error('Failed to fetch comments', error);\n    res.status(500).json({ error: '\ub313\uae00 \uc870\ud68c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.' });\n  }\n});\n\n// React \ucef4\ud3ec\ub10c\ud2b8 \uc608\uc2dc\n/*\nfunction Comment({ comment }) {\n  return (\n    <div className=\"comment\">\n      <div className=\"comment-header\">\n        <strong>{comment.username}</strong>\n        <span>{new Date(comment.created_at).toLocaleString()}</span>\n      </div>\n      <div\n        className=\"comment-content\"\n        dangerouslySetInnerHTML={{ __html: comment.content }}\n      />\n    </div>\n  );\n}\n\nfunction CommentForm({ postId, onCommentAdded }) {\n  const [content, setContent] = useState('');\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    const response = await fetch(`/api/comments`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}`\n      },\n      body: JSON.stringify({ postId, content })\n    });\n\n    if (response.ok) {\n      const { comment } = await response.json();\n      onCommentAdded(comment);\n      setContent('');\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <textarea\n        value={content}\n        onChange={(e) => setContent(e.target.value)}\n        placeholder=\"\ub313\uae00\uc744 \uc785\ub825\ud558\uc138\uc694 (HTML \ud0dc\uadf8 \uc0ac\uc6a9 \uac00\ub2a5: <b>, <i>, <a>)\"\n      />\n      <button type=\"submit\">\ub313\uae00 \uc791\uc131</button>\n    </form>\n  );\n}\n*/\n"})})]}),"\n",(0,t.jsx)(e.h3,{id:"\ubb38\uc81c-3-csrf-\ubc29\uc5b4-\uad6c\ud604",children:"\ubb38\uc81c 3: CSRF \ubc29\uc5b4 \uad6c\ud604"}),"\n",(0,t.jsx)(e.p,{children:"CSRF \ud1a0\ud070\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc1a1\uae08 API\ub97c \ubcf4\ud638\ud558\uc138\uc694."}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"\ud574\ub2f5"}),(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const csrf = require('csurf');\nconst cookieParser = require('cookie-parser');\n\n// CSRF \ubcf4\ud638 \uc124\uc815\napp.use(cookieParser());\n\nconst csrfProtection = csrf({\n  cookie: {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'strict'\n  }\n});\n\n// CSRF \ud1a0\ud070 \ubc1c\uae09\napp.get('/api/csrf-token', csrfProtection, (req, res) => {\n  res.json({ csrfToken: req.csrfToken() });\n});\n\n// \uc1a1\uae08 API (CSRF \ubcf4\ud638)\napp.post('/api/transfer',\n  authenticateToken,\n  csrfProtection,\n  [\n    body('to')\n      .isEmail()\n      .withMessage('\uc720\ud6a8\ud55c \uc774\uba54\uc77c\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694'),\n    body('amount')\n      .isFloat({ min: 0.01, max: 1000000 })\n      .withMessage('\uae08\uc561\uc740 0.01 \uc774\uc0c1 1,000,000 \uc774\ud558\uc5ec\uc57c \ud569\ub2c8\ub2e4'),\n    body('password')\n      .notEmpty()\n      .withMessage('\ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694')\n  ],\n  async (req, res) => {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return res.status(400).json({ errors: errors.array() });\n    }\n\n    const { to, amount, password } = req.body;\n    const fromUserId = req.user.id;\n\n    try {\n      // \uc0ac\uc6a9\uc790 \uc870\ud68c\n      const [users] = await db.execute(\n        'SELECT * FROM users WHERE id = ?',\n        [fromUserId]\n      );\n\n      if (users.length === 0) {\n        return res.status(404).json({ error: '\uc0ac\uc6a9\uc790\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.' });\n      }\n\n      const user = users[0];\n\n      // \ube44\ubc00\ubc88\ud638 \uc7ac\ud655\uc778 (\uc911\uc694\ud55c \uc791\uc5c5)\n      const isValidPassword = await bcrypt.compare(password, user.password_hash);\n\n      if (!isValidPassword) {\n        logger.warn('Transfer attempt with invalid password', {\n          userId: fromUserId,\n          ip: req.ip\n        });\n        return res.status(401).json({\n          error: '\ube44\ubc00\ubc88\ud638\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.'\n        });\n      }\n\n      // \uc794\uc561 \ud655\uc778\n      if (user.balance < amount) {\n        return res.status(400).json({\n          error: '\uc794\uc561\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.'\n        });\n      }\n\n      // \uc218\uc2e0\uc790 \uc870\ud68c\n      const [recipients] = await db.execute(\n        'SELECT * FROM users WHERE email = ?',\n        [to]\n      );\n\n      if (recipients.length === 0) {\n        return res.status(404).json({\n          error: '\uc218\uc2e0\uc790\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.'\n        });\n      }\n\n      const recipient = recipients[0];\n\n      // \ud2b8\ub79c\uc7ad\uc158 \uc2dc\uc791\n      await db.beginTransaction();\n\n      try {\n        // \uc1a1\uc2e0\uc790 \uc794\uc561 \ucc28\uac10\n        await db.execute(\n          'UPDATE users SET balance = balance - ? WHERE id = ?',\n          [amount, fromUserId]\n        );\n\n        // \uc218\uc2e0\uc790 \uc794\uc561 \uc99d\uac00\n        await db.execute(\n          'UPDATE users SET balance = balance + ? WHERE id = ?',\n          [amount, recipient.id]\n        );\n\n        // \uc1a1\uae08 \uae30\ub85d \uc800\uc7a5\n        await db.execute(\n          `INSERT INTO transactions\n           (from_user_id, to_user_id, amount, created_at)\n           VALUES (?, ?, ?, NOW())`,\n          [fromUserId, recipient.id, amount]\n        );\n\n        await db.commit();\n\n        logger.info('Successful transfer', {\n          from: fromUserId,\n          to: recipient.id,\n          amount,\n          ip: req.ip\n        });\n\n        res.json({\n          success: true,\n          message: `${amount}\uc6d0\uc744 ${to}\uc5d0\uac8c \uc1a1\uae08\ud588\uc2b5\ub2c8\ub2e4.`\n        });\n\n      } catch (error) {\n        await db.rollback();\n        throw error;\n      }\n\n    } catch (error) {\n      logger.error('Transfer error', error);\n      res.status(500).json({ error: '\uc1a1\uae08\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.' });\n    }\n  }\n);\n\n// \ud074\ub77c\uc774\uc5b8\ud2b8 \ucf54\ub4dc \uc608\uc2dc\n/*\n// React \ucef4\ud3ec\ub10c\ud2b8\nfunction TransferForm() {\n  const [csrfToken, setCsrfToken] = useState('');\n  const [formData, setFormData] = useState({\n    to: '',\n    amount: '',\n    password: ''\n  });\n\n  useEffect(() => {\n    // CSRF \ud1a0\ud070 \uac00\uc838\uc624\uae30\n    fetch('/api/csrf-token', {\n      credentials: 'include'\n    })\n      .then(res => res.json())\n      .then(data => setCsrfToken(data.csrfToken));\n  }, []);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    const response = await fetch('/api/transfer', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}`,\n        'CSRF-Token': csrfToken\n      },\n      credentials: 'include',\n      body: JSON.stringify(formData)\n    });\n\n    const data = await response.json();\n\n    if (response.ok) {\n      alert(data.message);\n    } else {\n      alert(data.error);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <input\n        type=\"email\"\n        placeholder=\"\ubc1b\ub294 \uc0ac\ub78c\"\n        value={formData.to}\n        onChange={(e) => setFormData({ ...formData, to: e.target.value })}\n      />\n      <input\n        type=\"number\"\n        placeholder=\"\uae08\uc561\"\n        value={formData.amount}\n        onChange={(e) => setFormData({ ...formData, amount: e.target.value })}\n      />\n      <input\n        type=\"password\"\n        placeholder=\"\ube44\ubc00\ubc88\ud638 \ud655\uc778\"\n        value={formData.password}\n        onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n      />\n      <input type=\"hidden\" name=\"_csrf\" value={csrfToken} />\n      <button type=\"submit\">\uc1a1\uae08</button>\n    </form>\n  );\n}\n*/\n\n// CSRF \uc5d0\ub7ec \ud578\ub4e4\ub7ec\napp.use((err, req, res, next) => {\n  if (err.code === 'EBADCSRFTOKEN') {\n    logger.warn('CSRF token validation failed', {\n      ip: req.ip,\n      path: req.path\n    });\n    res.status(403).json({\n      error: 'CSRF \ud1a0\ud070\uc774 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \ud398\uc774\uc9c0\ub97c \uc0c8\ub85c\uace0\uce68\ud574\uc8fc\uc138\uc694.'\n    });\n  } else {\n    next(err);\n  }\n});\n"})})]}),"\n",(0,t.jsx)(e.h3,{id:"\ubb38\uc81c-4-\ubcf4\uc548-\ud5e4\ub354-\ubc0f-https-\uc124\uc815",children:"\ubb38\uc81c 4: \ubcf4\uc548 \ud5e4\ub354 \ubc0f HTTPS \uc124\uc815"}),"\n",(0,t.jsx)(e.p,{children:"\uc644\uc804\ud55c \ubcf4\uc548 \ud5e4\ub354 \uc124\uc815 \ubc0f HTTPS \uac15\uc81c\ub97c \uad6c\ud604\ud558\uc138\uc694."}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"\ud574\ub2f5"}),(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const helmet = require('helmet');\nconst express = require('express');\nconst https = require('https');\nconst http = require('http');\nconst fs = require('fs');\n\nconst app = express();\n\n// \u2705 \ubcf4\uc548 \ud5e4\ub354 \uc124\uc815\napp.use(\n  helmet({\n    // Content Security Policy\n    contentSecurityPolicy: {\n      directives: {\n        defaultSrc: [\"'self'\"],\n        scriptSrc: [\n          \"'self'\",\n          \"'nonce-{NONCE}'\", // \ub3d9\uc801 nonce\n          'https://cdn.jsdelivr.net',\n          'https://cdnjs.cloudflare.com'\n        ],\n        styleSrc: [\n          \"'self'\",\n          \"'unsafe-inline'\", // CSS-in-JS \ub77c\uc774\ube0c\ub7ec\ub9ac \uc0ac\uc6a9 \uc2dc\n          'https://fonts.googleapis.com'\n        ],\n        imgSrc: [\n          \"'self'\",\n          'data:',\n          'https:',\n          'blob:'\n        ],\n        connectSrc: [\n          \"'self'\",\n          'https://api.myapp.com',\n          'wss://api.myapp.com'\n        ],\n        fontSrc: [\n          \"'self'\",\n          'https://fonts.gstatic.com'\n        ],\n        objectSrc: [\"'none'\"],\n        mediaSrc: [\"'self'\"],\n        frameSrc: [\"'none'\"],\n        frameAncestors: [\"'none'\"],\n        baseUri: [\"'self'\"],\n        formAction: [\"'self'\"],\n        upgradeInsecureRequests: [] // HTTP\ub97c HTTPS\ub85c \uc790\ub3d9 \uc5c5\uadf8\ub808\uc774\ub4dc\n      },\n      reportOnly: false // \uc704\ubc18 \uc2dc \ucc28\ub2e8 (\uac1c\ubc1c \uc2dc true\ub85c \ud14c\uc2a4\ud2b8)\n    },\n\n    // HSTS (HTTP Strict Transport Security)\n    hsts: {\n      maxAge: 31536000, // 1\ub144\n      includeSubDomains: true,\n      preload: true\n    },\n\n    // X-Frame-Options\n    frameguard: {\n      action: 'deny' // \ub610\ub294 'sameorigin'\n    },\n\n    // X-Content-Type-Options\n    noSniff: true,\n\n    // Referrer-Policy\n    referrerPolicy: {\n      policy: 'strict-origin-when-cross-origin'\n    },\n\n    // X-XSS-Protection\n    xssFilter: true,\n\n    // X-DNS-Prefetch-Control\n    dnsPrefetchControl: {\n      allow: false\n    },\n\n    // X-Download-Options\n    ieNoOpen: true,\n\n    // X-Permitted-Cross-Domain-Policies\n    permittedCrossDomainPolicies: {\n      permittedPolicies: 'none'\n    }\n  })\n);\n\n// \u2705 Permissions-Policy (Feature-Policy)\napp.use((req, res, next) => {\n  res.setHeader(\n    'Permissions-Policy',\n    'geolocation=(), ' +\n    'microphone=(), ' +\n    'camera=(), ' +\n    'payment=(), ' +\n    'usb=(), ' +\n    'magnetometer=(), ' +\n    'gyroscope=(), ' +\n    'accelerometer=()'\n  );\n  next();\n});\n\n// \u2705 CSP Nonce \ubbf8\ub4e4\uc6e8\uc5b4\nconst crypto = require('crypto');\n\napp.use((req, res, next) => {\n  res.locals.nonce = crypto.randomBytes(16).toString('base64');\n\n  // CSP \ud5e4\ub354\uc5d0 nonce \ucd94\uac00\n  const csp = res.getHeader('Content-Security-Policy');\n  if (csp) {\n    res.setHeader(\n      'Content-Security-Policy',\n      csp.replace('{NONCE}', res.locals.nonce)\n    );\n  }\n\n  next();\n});\n\n// \u2705 HTTPS \uac15\uc81c (\ud504\ub85c\ub355\uc158 \ud658\uacbd)\napp.use((req, res, next) => {\n  if (process.env.NODE_ENV === 'production' && !req.secure) {\n    return res.redirect(301, `https://${req.headers.host}${req.url}`);\n  }\n  next();\n});\n\n// \u2705 HTTPS \uc11c\ubc84 \uc124\uc815\nif (process.env.NODE_ENV === 'production') {\n  const httpsOptions = {\n    key: fs.readFileSync('./ssl/private-key.pem'),\n    cert: fs.readFileSync('./ssl/certificate.pem'),\n    ca: fs.readFileSync('./ssl/ca-bundle.pem'),\n\n    // \ucd5c\uc2e0 TLS \uc124\uc815\n    minVersion: 'TLSv1.2',\n    maxVersion: 'TLSv1.3',\n\n    // \uac15\ub825\ud55c \uc554\ud638\ud654 \uc2a4\uc704\ud2b8\n    ciphers: [\n      'TLS_AES_256_GCM_SHA384',\n      'TLS_CHACHA20_POLY1305_SHA256',\n      'TLS_AES_128_GCM_SHA256',\n      'ECDHE-RSA-AES256-GCM-SHA384',\n      'ECDHE-RSA-AES128-GCM-SHA256'\n    ].join(':'),\n\n    honorCipherOrder: true,\n\n    // Perfect Forward Secrecy\n    dhparam: fs.readFileSync('./ssl/dhparam.pem')\n  };\n\n  // HTTPS \uc11c\ubc84\n  https.createServer(httpsOptions, app).listen(443, () => {\n    console.log('\u2705 HTTPS server running on port 443');\n  });\n\n  // HTTP to HTTPS \ub9ac\ub2e4\uc774\ub809\ud2b8 \uc11c\ubc84\n  http.createServer((req, res) => {\n    res.writeHead(301, {\n      Location: `https://${req.headers.host}${req.url}`\n    });\n    res.end();\n  }).listen(80, () => {\n    console.log('\u2705 HTTP redirect server running on port 80');\n  });\n\n} else {\n  // \uac1c\ubc1c \ud658\uacbd\uc5d0\uc11c\ub294 HTTP\n  app.listen(3000, () => {\n    console.log('\ud83d\udea7 Development server running on port 3000');\n  });\n}\n\n// \u2705 \ubcf4\uc548 \ud5e4\ub354 \uac80\uc99d \uc5d4\ub4dc\ud3ec\uc778\ud2b8 (\uac1c\ubc1c/\ud14c\uc2a4\ud2b8\uc6a9)\napp.get('/api/security-headers', (req, res) => {\n  const headers = {\n    'content-security-policy': res.getHeader('Content-Security-Policy'),\n    'strict-transport-security': res.getHeader('Strict-Transport-Security'),\n    'x-frame-options': res.getHeader('X-Frame-Options'),\n    'x-content-type-options': res.getHeader('X-Content-Type-Options'),\n    'referrer-policy': res.getHeader('Referrer-Policy'),\n    'permissions-policy': res.getHeader('Permissions-Policy')\n  };\n\n  res.json({ headers });\n});\n\n// \u2705 SSL/TLS \uc124\uc815 \uac80\uc99d \uc2a4\ud06c\ub9bd\ud2b8\n/*\n// ssl-test.js\nconst https = require('https');\nconst tls = require('tls');\n\nfunction testSSL(hostname, port = 443) {\n  console.log(`Testing SSL/TLS configuration for ${hostname}:${port}\\n`);\n\n  const options = {\n    host: hostname,\n    port: port,\n    method: 'GET',\n    rejectUnauthorized: true\n  };\n\n  const req = https.request(options, (res) => {\n    const socket = res.socket;\n    const cipher = socket.getCipher();\n    const protocol = socket.getProtocol();\n    const cert = socket.getPeerCertificate();\n\n    console.log('\u2705 Connection successful\\n');\n    console.log('Protocol:', protocol);\n    console.log('Cipher:', cipher.name);\n    console.log('Certificate:', {\n      subject: cert.subject,\n      issuer: cert.issuer,\n      validFrom: cert.valid_from,\n      validTo: cert.valid_to\n    });\n\n    // \ubcf4\uc548 \ub4f1\uae09 \ud3c9\uac00\n    if (protocol === 'TLSv1.3' || protocol === 'TLSv1.2') {\n      console.log('\\n\u2705 Protocol version is secure');\n    } else {\n      console.log('\\n\u26a0\ufe0f  Protocol version is outdated');\n    }\n\n    if (cipher.name.includes('GCM') || cipher.name.includes('CHACHA20')) {\n      console.log('\u2705 Strong cipher suite');\n    } else {\n      console.log('\u26a0\ufe0f  Weak cipher suite');\n    }\n  });\n\n  req.on('error', (error) => {\n    console.error('\u274c SSL/TLS test failed:', error.message);\n  });\n\n  req.end();\n}\n\n// \uc0ac\uc6a9\ubc95\ntestSSL('myapp.com');\n*/\n"})})]}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"\ucc38\uace0-\uc790\ub8cc",children:"\ucc38\uace0 \uc790\ub8cc"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://owasp.org/www-project-top-ten/",children:"OWASP Top 10"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://developer.mozilla.org/en-US/docs/Web/Security",children:"MDN Web Security"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://expressjs.com/en/advanced/best-practice-security.html",children:"Express Security Best Practices"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html",children:"Node.js Security Checklist"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://helmetjs.github.io/",children:"Helmet.js Documentation"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://tools.ietf.org/html/rfc8725",children:"JWT Best Practices"})}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\ub2e4\uc74c-\ub2e8\uacc4",children:"\ub2e4\uc74c \ub2e8\uacc4"}),"\n",(0,t.jsx)(e.p,{children:"\ubcf4\uc548\uc740 \uc9c0\uc18d\uc801\uc778 \ud504\ub85c\uc138\uc2a4\uc785\ub2c8\ub2e4:"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"\uc815\uae30\uc801\uc778 \ubcf4\uc548 \uac10\uc0ac \uc218\ud589"}),"\n",(0,t.jsx)(e.li,{children:"\uc758\uc874\uc131 \uc5c5\ub370\uc774\ud2b8 \ubc0f \ucde8\uc57d\uc810 \uc810\uac80"}),"\n",(0,t.jsx)(e.li,{children:"\ubcf4\uc548 \uad50\uc721 \ubc0f \ucd5c\uc2e0 \ud2b8\ub80c\ub4dc \ud30c\uc545"}),"\n",(0,t.jsx)(e.li,{children:"\uce68\ud22c \ud14c\uc2a4\ud2b8 \ubc0f \ubc84\uadf8 \ubc14\uc6b4\ud2f0 \ud504\ub85c\uadf8\ub7a8 \uc6b4\uc601"}),"\n",(0,t.jsx)(e.li,{children:"\uc0ac\uace0 \ub300\uc751 \uacc4\ud68d \uc218\ub9bd"}),"\n"]})]})}function p(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>a,x:()=>o});var r=s(6540);const t={},i=r.createContext(t);function a(n){const e=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);