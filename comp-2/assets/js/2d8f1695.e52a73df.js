"use strict";(globalThis.webpackChunkgithub_docs=globalThis.webpackChunkgithub_docs||[]).push([[8512],{8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var s=t(6540);const r={},l=s.createContext(r);function a(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(l.Provider,{value:n},e.children)}},9901:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"prometheus/promql","title":"3. PromQL \ucffc\ub9ac","description":"PromQL(Prometheus Query Language)\uc740 Prometheus\uc758 \uc2dc\uacc4\uc5f4 \ub370\uc774\ud130\ub97c \uc870\ud68c\ud558\uace0 \ubd84\uc11d\ud558\uae30 \uc704\ud55c \uac15\ub825\ud55c \ucffc\ub9ac \uc5b8\uc5b4\uc785\ub2c8\ub2e4. \uc774 \ubb38\uc11c\uc5d0\uc11c\ub294 PromQL\uc758 \uae30\ubcf8\ubd80\ud130 \uace0\uae09 \ud65c\uc6a9\uae4c\uc9c0 \uc0c1\uc138\ud788 \ub2e4\ub8f9\ub2c8\ub2e4.","source":"@site/docs/prometheus/promql.md","sourceDirName":"prometheus","slug":"/prometheus/promql","permalink":"/docs/prometheus/promql","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/prometheus/promql.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"prometheusSidebar","previous":{"title":"2. \uba54\ud2b8\ub9ad\uacfc Python \ud074\ub77c\uc774\uc5b8\ud2b8","permalink":"/docs/prometheus/metrics"},"next":{"title":"4. Grafana \uc5f0\ub3d9","permalink":"/docs/prometheus/grafana"}}');var r=t(4848),l=t(8453);const a={sidebar_position:3},i="3. PromQL \ucffc\ub9ac",o={},d=[{value:"3.1 PromQL \uae30\ubcf8 \uac1c\ub150",id:"31-promql-\uae30\ubcf8-\uac1c\ub150",level:2},{value:"\uc2dc\uacc4\uc5f4 \ub370\uc774\ud130 \uc774\ud574",id:"\uc2dc\uacc4\uc5f4-\ub370\uc774\ud130-\uc774\ud574",level:3},{value:"\ub370\uc774\ud130 \ud0c0\uc785",id:"\ub370\uc774\ud130-\ud0c0\uc785",level:3},{value:"3.2 Selectors (\uc120\ud0dd\uc790)",id:"32-selectors-\uc120\ud0dd\uc790",level:2},{value:"Instant Vector Selectors",id:"instant-vector-selectors",level:3},{value:"Range Vector Selectors",id:"range-vector-selectors",level:3},{value:"Offset Modifier",id:"offset-modifier",level:3},{value:"3.3 Operators (\uc5f0\uc0b0\uc790)",id:"33-operators-\uc5f0\uc0b0\uc790",level:2},{value:"Arithmetic Operators (\uc0b0\uc220 \uc5f0\uc0b0\uc790)",id:"arithmetic-operators-\uc0b0\uc220-\uc5f0\uc0b0\uc790",level:3},{value:"Comparison Operators (\ube44\uad50 \uc5f0\uc0b0\uc790)",id:"comparison-operators-\ube44\uad50-\uc5f0\uc0b0\uc790",level:3},{value:"Logical Operators (\ub17c\ub9ac \uc5f0\uc0b0\uc790)",id:"logical-operators-\ub17c\ub9ac-\uc5f0\uc0b0\uc790",level:3},{value:"Vector Matching",id:"vector-matching",level:3},{value:"3.4 Functions (\ud568\uc218)",id:"34-functions-\ud568\uc218",level:2},{value:"Rate Functions",id:"rate-functions",level:3},{value:"rate()",id:"rate",level:4},{value:"irate()",id:"irate",level:4},{value:"increase()",id:"increase",level:4},{value:"Aggregation Functions",id:"aggregation-functions",level:3},{value:"sum()",id:"sum",level:4},{value:"avg()",id:"avg",level:4},{value:"count()",id:"count",level:4},{value:"min() / max()",id:"min--max",level:4},{value:"stddev() / stdvar()",id:"stddev--stdvar",level:4},{value:"topk() / bottomk()",id:"topk--bottomk",level:4},{value:"quantile()",id:"quantile",level:4},{value:"Time Functions",id:"time-functions",level:3},{value:"time()",id:"time",level:4},{value:"timestamp()",id:"timestamp",level:4},{value:"day_of_week()",id:"day_of_week",level:4},{value:"hour()",id:"hour",level:4},{value:"Mathematical Functions",id:"mathematical-functions",level:3},{value:"abs()",id:"abs",level:4},{value:"ceil() / floor() / round()",id:"ceil--floor--round",level:4},{value:"exp() / ln() / log2() / log10()",id:"exp--ln--log2--log10",level:4},{value:"sqrt()",id:"sqrt",level:4},{value:"Delta and Derivative Functions",id:"delta-and-derivative-functions",level:3},{value:"delta()",id:"delta",level:4},{value:"idelta()",id:"idelta",level:4},{value:"deriv()",id:"deriv",level:4},{value:"Prediction Functions",id:"prediction-functions",level:3},{value:"predict_linear()",id:"predict_linear",level:4},{value:"Label Manipulation Functions",id:"label-manipulation-functions",level:3},{value:"label_replace()",id:"label_replace",level:4},{value:"label_join()",id:"label_join",level:4},{value:"Sorting Functions",id:"sorting-functions",level:3},{value:"sort() / sort_desc()",id:"sort--sort_desc",level:4},{value:"Histogram Functions",id:"histogram-functions",level:3},{value:"histogram_quantile()",id:"histogram_quantile",level:4},{value:"Other Useful Functions",id:"other-useful-functions",level:3},{value:"absent()",id:"absent",level:4},{value:"changes()",id:"changes",level:4},{value:"resets()",id:"resets",level:4},{value:"3.5 Aggregation Operations",id:"35-aggregation-operations",level:2},{value:"by\uc640 without",id:"by\uc640-without",level:3},{value:"\uc2e4\uc804 \uc9d1\uacc4 \ud328\ud134",id:"\uc2e4\uc804-\uc9d1\uacc4-\ud328\ud134",level:3},{value:"3.6 Recording Rules",id:"36-recording-rules",level:2},{value:"\uc124\uc815 \ubc29\ubc95",id:"\uc124\uc815-\ubc29\ubc95",level:3},{value:"Recording Rule \uc791\uc131",id:"recording-rule-\uc791\uc131",level:3},{value:"Naming Convention",id:"naming-convention",level:3},{value:"3.7 \uc2e4\uc804 \ucffc\ub9ac \ud328\ud134",id:"37-\uc2e4\uc804-\ucffc\ub9ac-\ud328\ud134",level:2},{value:"\uc5d0\ub7ec\uc728 (Error Rate)",id:"\uc5d0\ub7ec\uc728-error-rate",level:3},{value:"\ub808\uc774\ud134\uc2dc (Latency)",id:"\ub808\uc774\ud134\uc2dc-latency",level:3},{value:"\ucc98\ub9ac\ub7c9 (Throughput)",id:"\ucc98\ub9ac\ub7c9-throughput",level:3},{value:"CPU \uc0ac\uc6a9\ub960",id:"cpu-\uc0ac\uc6a9\ub960",level:3},{value:"\uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub960",id:"\uba54\ubaa8\ub9ac-\uc0ac\uc6a9\ub960",level:3},{value:"\ub514\uc2a4\ud06c \uc0ac\uc6a9\ub960",id:"\ub514\uc2a4\ud06c-\uc0ac\uc6a9\ub960",level:3},{value:"\ub124\ud2b8\uc6cc\ud06c \ud2b8\ub798\ud53d",id:"\ub124\ud2b8\uc6cc\ud06c-\ud2b8\ub798\ud53d",level:3},{value:"3.8 \ubcf5\uc7a1\ud55c \ucffc\ub9ac \uc608\uc81c",id:"38-\ubcf5\uc7a1\ud55c-\ucffc\ub9ac-\uc608\uc81c",level:2},{value:"SLI/SLO \uacc4\uc0b0",id:"slislo-\uacc4\uc0b0",level:3},{value:"Error Budget \uacc4\uc0b0",id:"error-budget-\uacc4\uc0b0",level:3},{value:"Apdex Score \uacc4\uc0b0",id:"apdex-score-\uacc4\uc0b0",level:3},{value:"\uae08\uc8fc\uc640 \uc804\uc8fc \ube44\uad50",id:"\uae08\uc8fc\uc640-\uc804\uc8fc-\ube44\uad50",level:3},{value:"\uc774\uc0c1 \ud0d0\uc9c0 (Anomaly Detection)",id:"\uc774\uc0c1-\ud0d0\uc9c0-anomaly-detection",level:3},{value:"\ubcf5\ud569 \uc54c\ub9bc \uc870\uac74",id:"\ubcf5\ud569-\uc54c\ub9bc-\uc870\uac74",level:3},{value:"\uce74\ub514\ub110\ub9ac\ud2f0 \ubd84\uc11d",id:"\uce74\ub514\ub110\ub9ac\ud2f0-\ubd84\uc11d",level:3},{value:"3.9 Python\uc73c\ub85c PromQL \ucffc\ub9ac \uc2e4\ud589",id:"39-python\uc73c\ub85c-promql-\ucffc\ub9ac-\uc2e4\ud589",level:2},{value:"\uae30\ubcf8 \ucffc\ub9ac \uc2e4\ud589",id:"\uae30\ubcf8-\ucffc\ub9ac-\uc2e4\ud589",level:3},{value:"\uc2e4\uc804 \ud65c\uc6a9 \uc608\uc81c",id:"\uc2e4\uc804-\ud65c\uc6a9-\uc608\uc81c",level:3},{value:"\ub300\uc2dc\ubcf4\ub4dc \ub370\uc774\ud130 \uc218\uc9d1",id:"\ub300\uc2dc\ubcf4\ub4dc-\ub370\uc774\ud130-\uc218\uc9d1",level:3},{value:"\uc54c\ub9bc \uc870\uac74 \uac80\uc99d",id:"\uc54c\ub9bc-\uc870\uac74-\uac80\uc99d",level:3},{value:"3.10 \ucffc\ub9ac \ucd5c\uc801\ud654",id:"310-\ucffc\ub9ac-\ucd5c\uc801\ud654",level:2},{value:"\ucd5c\uc801\ud654 \uc6d0\uce59",id:"\ucd5c\uc801\ud654-\uc6d0\uce59",level:3},{value:"\ub098\uc05c \ucffc\ub9ac vs \uc88b\uc740 \ucffc\ub9ac",id:"\ub098\uc05c-\ucffc\ub9ac-vs-\uc88b\uc740-\ucffc\ub9ac",level:3},{value:"\uce74\ub514\ub110\ub9ac\ud2f0 \uad00\ub9ac",id:"\uce74\ub514\ub110\ub9ac\ud2f0-\uad00\ub9ac",level:3},{value:"\ucffc\ub9ac \uc131\ub2a5 \uce21\uc815",id:"\ucffc\ub9ac-\uc131\ub2a5-\uce21\uc815",level:3},{value:"3.11 \ub514\ubc84\uae45 \ud301",id:"311-\ub514\ubc84\uae45-\ud301",level:2},{value:"\ucffc\ub9ac \ub2e8\uacc4\ubcc4 \uc2e4\ud589",id:"\ucffc\ub9ac-\ub2e8\uacc4\ubcc4-\uc2e4\ud589",level:3},{value:"\uc77c\ubc18\uc801\uc778 \uc624\ub958\uc640 \ud574\uacb0",id:"\uc77c\ubc18\uc801\uc778-\uc624\ub958\uc640-\ud574\uacb0",level:3},{value:"\uc720\uc6a9\ud55c \ub514\ubc84\uae45 \ucffc\ub9ac",id:"\uc720\uc6a9\ud55c-\ub514\ubc84\uae45-\ucffc\ub9ac",level:3},{value:"Prometheus UI \ud65c\uc6a9",id:"prometheus-ui-\ud65c\uc6a9",level:3},{value:"3.12 \uc5f0\uc2b5 \ubb38\uc81c",id:"312-\uc5f0\uc2b5-\ubb38\uc81c",level:2},{value:"\uae30\ucd08 \ubb38\uc81c",id:"\uae30\ucd08-\ubb38\uc81c",level:3},{value:"\uc911\uae09 \ubb38\uc81c",id:"\uc911\uae09-\ubb38\uc81c",level:3},{value:"\uace0\uae09 \ubb38\uc81c",id:"\uace0\uae09-\ubb38\uc81c",level:3},{value:"\ub2e4\uc74c \ub2e8\uacc4",id:"\ub2e4\uc74c-\ub2e8\uacc4",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"3-promql-\ucffc\ub9ac",children:"3. PromQL \ucffc\ub9ac"})}),"\n",(0,r.jsx)(n.p,{children:"PromQL(Prometheus Query Language)\uc740 Prometheus\uc758 \uc2dc\uacc4\uc5f4 \ub370\uc774\ud130\ub97c \uc870\ud68c\ud558\uace0 \ubd84\uc11d\ud558\uae30 \uc704\ud55c \uac15\ub825\ud55c \ucffc\ub9ac \uc5b8\uc5b4\uc785\ub2c8\ub2e4. \uc774 \ubb38\uc11c\uc5d0\uc11c\ub294 PromQL\uc758 \uae30\ubcf8\ubd80\ud130 \uace0\uae09 \ud65c\uc6a9\uae4c\uc9c0 \uc0c1\uc138\ud788 \ub2e4\ub8f9\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.h2,{id:"31-promql-\uae30\ubcf8-\uac1c\ub150",children:"3.1 PromQL \uae30\ubcf8 \uac1c\ub150"}),"\n",(0,r.jsx)(n.h3,{id:"\uc2dc\uacc4\uc5f4-\ub370\uc774\ud130-\uc774\ud574",children:"\uc2dc\uacc4\uc5f4 \ub370\uc774\ud130 \uc774\ud574"}),"\n",(0,r.jsxs)(n.p,{children:["Prometheus\ub294 ",(0,r.jsx)(n.strong,{children:"\uc2dc\uacc4\uc5f4(time series)"})," \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc785\ub2c8\ub2e4. \uac01 \uc2dc\uacc4\uc5f4\uc740 \ub2e4\uc74c\uacfc \uac19\uc774 \uad6c\uc131\ub429\ub2c8\ub2e4:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"<metric name>{<label name>=<label value>, ...}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc608\uc2dc:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'http_requests_total{method="GET", endpoint="/api/users", status="200"}\n'})}),"\n",(0,r.jsx)(n.p,{children:"\uc774 \uc2dc\uacc4\uc5f4\uc740:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Metric name"}),": ",(0,r.jsx)(n.code,{children:"http_requests_total"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Labels"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:'method="GET"'})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:'endpoint="/api/users"'})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:'status="200"'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\uac01 \uc2dc\uacc4\uc5f4\uc740 \ud0c0\uc784\uc2a4\ud0ec\ud504\uc640 \ud568\uaed8 \uac12(value)\uc744 \uc800\uc7a5\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.h3,{id:"\ub370\uc774\ud130-\ud0c0\uc785",children:"\ub370\uc774\ud130 \ud0c0\uc785"}),"\n",(0,r.jsx)(n.p,{children:"PromQL\uc740 4\uac00\uc9c0 \ub370\uc774\ud130 \ud0c0\uc785\uc744 \uc9c0\uc6d0\ud569\ub2c8\ub2e4:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Instant Vector"}),": \ud2b9\uc815 \uc2dc\uc810\uc758 \uc2dc\uacc4\uc5f4 \uc9d1\ud569"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Range Vector"}),": \uc2dc\uac04 \ubc94\uc704\uc5d0 \uac78\uce5c \uc2dc\uacc4\uc5f4 \uc9d1\ud569"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scalar"}),": \ub2e8\uc21c \uc22b\uc790 \uac12"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"String"}),": \ubb38\uc790\uc5f4 \uac12 (\ud604\uc7ac\ub294 \uc81c\ud55c\uc801\uc73c\ub85c \uc0ac\uc6a9)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"32-selectors-\uc120\ud0dd\uc790",children:"3.2 Selectors (\uc120\ud0dd\uc790)"}),"\n",(0,r.jsx)(n.h3,{id:"instant-vector-selectors",children:"Instant Vector Selectors"}),"\n",(0,r.jsx)(n.p,{children:"\ud2b9\uc815 \uc2dc\uc810\uc758 \uc2dc\uacc4\uc5f4\uc744 \uc120\ud0dd\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uae30\ubcf8 \uc120\ud0dd:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \ubaa8\ub4e0 http_requests_total \uba54\ud2b8\ub9ad\nhttp_requests_total\n\n# \ud2b9\uc815 \ub808\uc774\ube14\ub85c \ud544\ud130\ub9c1\nhttp_requests_total{method="GET"}\n\n# \uc5ec\ub7ec \ub808\uc774\ube14 \uc870\uac74\nhttp_requests_total{method="GET", status="200"}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub808\uc774\ube14 \ub9e4\uce6d \uc5f0\uc0b0\uc790:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\uc5f0\uc0b0\uc790"}),(0,r.jsx)(n.th,{children:"\uc124\uba85"}),(0,r.jsx)(n.th,{children:"\uc608\uc2dc"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"="})}),(0,r.jsx)(n.td,{children:"\uc815\ud655\ud788 \uc77c\uce58"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'method="GET"'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"!="})}),(0,r.jsx)(n.td,{children:"\uc77c\uce58\ud558\uc9c0 \uc54a\uc74c"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'status!="500"'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"=~"})}),(0,r.jsx)(n.td,{children:"\uc815\uaddc\uc2dd \uc77c\uce58"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'endpoint=~"/api/.*"'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"!~"})}),(0,r.jsx)(n.td,{children:"\uc815\uaddc\uc2dd \ubd88\uc77c\uce58"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'endpoint!~"/internal/.*"'})})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc608\uc2dc:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \ubaa8\ub4e0 GET, POST \uc694\uccad\nhttp_requests_total{method=~"GET|POST"}\n\n# 5xx \uc0c1\ud0dc \ucf54\ub4dc \uc81c\uc678\nhttp_requests_total{status!~"5.."}\n\n# /api/\ub85c \uc2dc\uc791\ud558\ub294 \uc5d4\ub4dc\ud3ec\uc778\ud2b8\nhttp_requests_total{endpoint=~"/api/.*"}\n\n# \uc5ec\ub7ec \uc870\uac74 \uc870\ud569\nhttp_requests_total{method="GET", status=~"2..", endpoint!~"/health"}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"range-vector-selectors",children:"Range Vector Selectors"}),"\n",(0,r.jsx)(n.p,{children:"\uc2dc\uac04 \ubc94\uc704\uc5d0 \uac78\uce5c \uc2dc\uacc4\uc5f4\uc744 \uc120\ud0dd\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ubb38\ubc95:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"<metric_name>{<label_selectors>}[<duration>]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc2dc\uac04 \ub2e8\uc704:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"s"})," - \ucd08 (seconds)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"m"})," - \ubd84 (minutes)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"h"})," - \uc2dc\uac04 (hours)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"d"})," - \uc77c (days)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"w"})," - \uc8fc (weeks)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"y"})," - \ub144 (years)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc608\uc2dc:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \uc9c0\ub09c 5\ubd84\uac04\uc758 \ub370\uc774\ud130\nhttp_requests_total[5m]\n\n# \uc9c0\ub09c 1\uc2dc\uac04 \ub370\uc774\ud130\ncpu_usage[1h]\n\n# \uc9c0\ub09c 1\uc77c \ub370\uc774\ud130\nmemory_usage[1d]\n\n# \uc870\ud569\nhttp_requests_total{method="GET"}[5m]\n'})}),"\n",(0,r.jsx)(n.h3,{id:"offset-modifier",children:"Offset Modifier"}),"\n",(0,r.jsx)(n.p,{children:"\uacfc\uac70 \ud2b9\uc815 \uc2dc\uc810\uc758 \ub370\uc774\ud130\ub97c \uc870\ud68c\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# 1\uc2dc\uac04 \uc804\uc758 \uac12\nhttp_requests_total offset 1h\n\n# 1\uc77c \uc804\uc758 5\ubd84 \ubc94\uc704 \ub370\uc774\ud130\nhttp_requests_total[5m] offset 1d\n\n# \ud604\uc7ac \uac12\uacfc 1\uc2dc\uac04 \uc804 \uac12 \ube44\uad50\nhttp_requests_total - http_requests_total offset 1h\n"})}),"\n",(0,r.jsx)(n.h2,{id:"33-operators-\uc5f0\uc0b0\uc790",children:"3.3 Operators (\uc5f0\uc0b0\uc790)"}),"\n",(0,r.jsx)(n.h3,{id:"arithmetic-operators-\uc0b0\uc220-\uc5f0\uc0b0\uc790",children:"Arithmetic Operators (\uc0b0\uc220 \uc5f0\uc0b0\uc790)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"+  # \ub367\uc148\n-  # \ube84\uc148\n*  # \uacf1\uc148\n/  # \ub098\ub217\uc148\n%  # \ub098\uba38\uc9c0\n^  # \uac70\ub4ed\uc81c\uacf1\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc608\uc2dc:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# CPU \uc0ac\uc6a9\ub960\uc744 \ud37c\uc13c\ud2b8\ub85c \ubcc0\ud658\nnode_cpu_seconds_total * 100\n\n# \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub960 \uacc4\uc0b0\n(node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100\n\n# \ucd08\ub2f9 \uc694\uccad \uc218\ub97c \ubd84\ub2f9\uc73c\ub85c \ubcc0\ud658\nrate(http_requests_total[5m]) * 60\n\n# \uac70\ub4ed\uc81c\uacf1\nhttp_requests_total ^ 2\n"})}),"\n",(0,r.jsx)(n.h3,{id:"comparison-operators-\ube44\uad50-\uc5f0\uc0b0\uc790",children:"Comparison Operators (\ube44\uad50 \uc5f0\uc0b0\uc790)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"==  # \uac19\uc74c\n!=  # \ub2e4\ub984\n>   # \ucd08\uacfc\n<   # \ubbf8\ub9cc\n>=  # \uc774\uc0c1\n<=  # \uc774\ud558\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\uae30\ubcf8 \ub3d9\uc791"}),": \ube44\uad50 \uc5f0\uc0b0\uc790\ub294 \ud544\ud130\ub9c1\uc73c\ub85c \uc791\ub3d9\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# CPU \uc0ac\uc6a9\ub960\uc774 80% \uc774\uc0c1\uc778 \uac83\ub9cc\nnode_cpu_usage > 80\n\n# \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub960\uc774 90% \ubbf8\ub9cc\uc778 \uac83\ub9cc\nnode_memory_usage < 90\n\n# \uc751\ub2f5 \uc2dc\uac04\uc774 1\ucd08 \uc774\uc0c1\uc778 \uc694\uccad\nhttp_request_duration_seconds > 1\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"bool \uc218\uc815\uc790"}),": 0 \ub610\ub294 1\uc744 \ubc18\ud658\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc870\uac74\uc744 \ub9cc\uc871\ud558\uba74 1, \uc544\ub2c8\uba74 0\nhttp_requests_total > bool 100\n"})}),"\n",(0,r.jsx)(n.h3,{id:"logical-operators-\ub17c\ub9ac-\uc5f0\uc0b0\uc790",children:"Logical Operators (\ub17c\ub9ac \uc5f0\uc0b0\uc790)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"and  # AND \uc5f0\uc0b0\nor   # OR \uc5f0\uc0b0\nunless  # UNLESS \uc5f0\uc0b0 (\uc81c\uc678)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc608\uc2dc:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# CPU \uc0ac\uc6a9\ub960 > 80% AND \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub960 > 90%\nnode_cpu_usage > 80 and node_memory_usage > 90\n\n# \uc5d0\ub7ec \ub610\ub294 \ud0c0\uc784\uc544\uc6c3 \uc694\uccad\nhttp_requests_total{status="500"} or http_requests_total{status="timeout"}\n\n# \ubaa8\ub4e0 \uc778\uc2a4\ud134\uc2a4 \uc911 \ub2e4\uc6b4\ub41c \uc778\uc2a4\ud134\uc2a4 \uc81c\uc678\nup unless up == 0\n'})}),"\n",(0,r.jsx)(n.h3,{id:"vector-matching",children:"Vector Matching"}),"\n",(0,r.jsx)(n.p,{children:"\ubca1\ud130 \uac04 \uc5f0\uc0b0 \uc2dc \ub808\uc774\ube14 \ub9e4\uce6d \ubc29\uc2dd\uc744 \uc81c\uc5b4\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"One-to-One Matching:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uae30\ubcf8 \ub9e4\uce6d (\ubaa8\ub4e0 \ub808\uc774\ube14\uc774 \uc77c\uce58\ud574\uc57c \ud568)\nmethod_code:http_errors:rate5m / method_code:http_requests:rate5m\n\n# \ud2b9\uc815 \ub808\uc774\ube14\ub9cc \ub9e4\uce6d (on)\nmethod_code:http_errors:rate5m / on(method, code) method_code:http_requests:rate5m\n\n# \ud2b9\uc815 \ub808\uc774\ube14 \ubb34\uc2dc (ignoring)\nmethod_code:http_errors:rate5m / ignoring(instance) method_code:http_requests:rate5m\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Many-to-One / One-to-Many Matching:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# group_left: \uc67c\ucabd\uc774 \ub9ce\uc740 \ucabd\nmethod_code:http_errors:rate5m / on(method) group_left http_requests_total\n\n# group_right: \uc624\ub978\ucabd\uc774 \ub9ce\uc740 \ucabd\nhttp_requests_total / on(method) group_right method_code:http_errors:rate5m\n"})}),"\n",(0,r.jsx)(n.h2,{id:"34-functions-\ud568\uc218",children:"3.4 Functions (\ud568\uc218)"}),"\n",(0,r.jsx)(n.h3,{id:"rate-functions",children:"Rate Functions"}),"\n",(0,r.jsx)(n.p,{children:"Counter \uba54\ud2b8\ub9ad\uc758 \ucd08\ub2f9 \ud3c9\uade0 \uc99d\uac00\uc728\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.h4,{id:"rate",children:"rate()"}),"\n",(0,r.jsx)(n.p,{children:"\uc9c0\uc815\ub41c \uc2dc\uac04 \ubc94\uc704\uc5d0\uc11c \ucd08\ub2f9 \ud3c9\uade0 \uc99d\uac00\uc728\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \uc9c0\ub09c 5\ubd84\uac04 \ucd08\ub2f9 \ud3c9\uade0 \uc694\uccad \uc218\nrate(http_requests_total[5m])\n\n# \uc9c0\ub09c 1\ubd84\uac04 CPU \uc0ac\uc6a9 \uc2dc\uac04\uc758 \ucd08\ub2f9 \uc99d\uac00\uc728\nrate(node_cpu_seconds_total[1m])\n\n# \ud2b9\uc815 \uc5d4\ub4dc\ud3ec\uc778\ud2b8\uc758 \ucd08\ub2f9 \uc5d0\ub7ec \uc218\nrate(http_requests_total{status=~"5..", endpoint="/api/users"}[5m])\n'})}),"\n",(0,r.jsx)(n.admonition,{title:"\uad8c\uc7a5\uc0ac\ud56d",type:"tip",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"rate()"}),"\ub294 \ucd5c\uc18c 4\ubc30 \uc774\uc0c1\uc758 scrape interval\uc744 \uc0ac\uc6a9\ud558\ub294 \uac83\uc774 \uc88b\uc2b5\ub2c8\ub2e4. scrape interval\uc774 15\ucd08\ub77c\uba74 \ucd5c\uc18c ",(0,r.jsx)(n.code,{children:"[1m]"}),"\uc744 \uc0ac\uc6a9\ud558\uc138\uc694."]})}),"\n",(0,r.jsx)(n.h4,{id:"irate",children:"irate()"}),"\n",(0,r.jsx)(n.p,{children:"\ub9c8\uc9c0\ub9c9 \ub450 \ub370\uc774\ud130 \ud3ec\uc778\ud2b8\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc21c\uac04 \uc99d\uac00\uc728\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc21c\uac04 \uc694\uccad \ube44\uc728\nirate(http_requests_total[5m])\n\n# \uc21c\uac04 CPU \uc0ac\uc6a9\ub960\nirate(node_cpu_seconds_total[5m])\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"rate() vs irate():"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"rate()"}),": \uc7a5\uae30 \ud2b8\ub80c\ub4dc, \uc548\uc815\uc801\uc778 \uac12"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"irate()"}),": \ub2e8\uae30 \ubcc0\ud654, \ubbfc\uac10\ud55c \uac12 (\uc2a4\ud30c\uc774\ud06c \uac10\uc9c0\uc5d0 \uc720\uc6a9)"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"increase",children:"increase()"}),"\n",(0,r.jsx)(n.p,{children:"\uc9c0\uc815\ub41c \uc2dc\uac04 \ubc94\uc704\uc5d0\uc11c \ucd1d \uc99d\uac00\ub7c9\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \uc9c0\ub09c 1\uc2dc\uac04 \ub3d9\uc548 \ucd1d \uc694\uccad \uc218\nincrease(http_requests_total[1h])\n\n# \uc9c0\ub09c 24\uc2dc\uac04 \ub3d9\uc548 \uc5d0\ub7ec \uc99d\uac00\ub7c9\nincrease(http_requests_total{status=~"5.."}[24h])\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"increase(metric[5m])"})," = ",(0,r.jsx)(n.code,{children:"rate(metric[5m]) * 5 * 60"})]})}),"\n",(0,r.jsx)(n.h3,{id:"aggregation-functions",children:"Aggregation Functions"}),"\n",(0,r.jsx)(n.p,{children:"\uc5ec\ub7ec \uc2dc\uacc4\uc5f4\uc744 \uc9d1\uacc4\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.h4,{id:"sum",children:"sum()"}),"\n",(0,r.jsx)(n.p,{children:"\ud569\uacc4\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ubaa8\ub4e0 \uc778\uc2a4\ud134\uc2a4\uc758 \ucd1d \uc694\uccad \uc218\nsum(http_requests_total)\n\n# \uba54\uc11c\ub4dc\ubcc4 \ucd1d \uc694\uccad \uc218\nsum by (method) (http_requests_total)\n\n# \uba54\uc11c\ub4dc\ub97c \uc81c\uc678\ud55c \uadf8\ub8f9\ubcc4 \ucd1d\ud569\nsum without (method) (http_requests_total)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"avg",children:"avg()"}),"\n",(0,r.jsx)(n.p,{children:"\ud3c9\uade0\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc804\uccb4 \ud3c9\uade0 CPU \uc0ac\uc6a9\ub960\navg(node_cpu_usage)\n\n# \uc778\uc2a4\ud134\uc2a4\ubcc4 \ud3c9\uade0 CPU \uc0ac\uc6a9\ub960\navg by (instance) (node_cpu_usage)\n\n# \ud658\uacbd\ubcc4 \ud3c9\uade0 \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub960\navg by (environment) (node_memory_usage)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"count",children:"count()"}),"\n",(0,r.jsx)(n.p,{children:"\uc2dc\uacc4\uc5f4 \uac1c\uc218\ub97c \uc149\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ucd1d \uc778\uc2a4\ud134\uc2a4 \uc218\ncount(up)\n\n# \uc815\uc0c1 \uc791\ub3d9 \uc911\uc778 \uc778\uc2a4\ud134\uc2a4 \uc218\ncount(up == 1)\n\n# \uc11c\ube44\uc2a4\ubcc4 \uc778\uc2a4\ud134\uc2a4 \uc218\ncount by (service) (up)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"min--max",children:"min() / max()"}),"\n",(0,r.jsx)(n.p,{children:"\ucd5c\uc19f\uac12 / \ucd5c\ub313\uac12\uc744 \ucc3e\uc2b5\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uac00\uc7a5 \ub0ae\uc740 CPU \uc0ac\uc6a9\ub960\nmin(node_cpu_usage)\n\n# \uac00\uc7a5 \ub192\uc740 \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub960\nmax(node_memory_usage)\n\n# \uc11c\ube44\uc2a4\ubcc4 \ucd5c\ub300 \uc751\ub2f5 \uc2dc\uac04\nmax by (service) (http_request_duration_seconds)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"stddev--stdvar",children:"stddev() / stdvar()"}),"\n",(0,r.jsx)(n.p,{children:"\ud45c\uc900\ud3b8\ucc28 / \ubd84\uc0b0\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# CPU \uc0ac\uc6a9\ub960 \ud45c\uc900\ud3b8\ucc28\nstddev(node_cpu_usage)\n\n# \uc751\ub2f5 \uc2dc\uac04\uc758 \ubd84\uc0b0\nstdvar(http_request_duration_seconds)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"topk--bottomk",children:"topk() / bottomk()"}),"\n",(0,r.jsx)(n.p,{children:"\uc0c1\uc704 / \ud558\uc704 K\uac1c \uc2dc\uacc4\uc5f4\uc744 \ubc18\ud658\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# CPU \uc0ac\uc6a9\ub960 \uc0c1\uc704 5\uac1c \uc778\uc2a4\ud134\uc2a4\ntopk(5, node_cpu_usage)\n\n# \uc694\uccad \uc218 \ud558\uc704 3\uac1c \uc5d4\ub4dc\ud3ec\uc778\ud2b8\nbottomk(3, rate(http_requests_total[5m]))\n\n# \uc5d0\ub7ec\uc728 \uc0c1\uc704 10\uac1c \uc11c\ube44\uc2a4\ntopk(10,\n  sum by (service) (rate(http_requests_total{status=~"5.."}[5m]))\n  /\n  sum by (service) (rate(http_requests_total[5m]))\n)\n'})}),"\n",(0,r.jsx)(n.h4,{id:"quantile",children:"quantile()"}),"\n",(0,r.jsx)(n.p,{children:"\ubd84\uc704\uc218\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# 50th percentile (\uc911\uc559\uac12)\nquantile(0.5, http_request_duration_seconds)\n\n# 95th percentile\nquantile(0.95, http_request_duration_seconds)\n\n# 99th percentile\nquantile(0.99, http_request_duration_seconds)\n\n# \uc11c\ube44\uc2a4\ubcc4 95th percentile\nquantile by (service) (0.95, http_request_duration_seconds)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"time-functions",children:"Time Functions"}),"\n",(0,r.jsx)(n.h4,{id:"time",children:"time()"}),"\n",(0,r.jsx)(n.p,{children:"\ud604\uc7ac Unix \ud0c0\uc784\uc2a4\ud0ec\ud504\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ud604\uc7ac \uc2dc\uac04\ntime()\n\n# \uba54\ud2b8\ub9ad\uc774 \ub9c8\uc9c0\ub9c9\uc73c\ub85c \uc218\uc9d1\ub41c \uc774\ud6c4 \uacbd\uacfc \uc2dc\uac04 (\ucd08)\ntime() - timestamp(metric_name)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"timestamp",children:"timestamp()"}),"\n",(0,r.jsx)(n.p,{children:"\uc0d8\ud50c\uc758 \ud0c0\uc784\uc2a4\ud0ec\ud504\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"timestamp(up)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"day_of_week",children:"day_of_week()"}),"\n",(0,r.jsx)(n.p,{children:"\uc694\uc77c\uc744 \ubc18\ud658\ud569\ub2c8\ub2e4 (0=\uc77c\uc694\uc77c, 6=\ud1a0\uc694\uc77c)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc8fc\ub9d0\uc778\uc9c0 \ud655\uc778 (0 \ub610\ub294 6\uc774\uba74 \uc8fc\ub9d0)\nday_of_week()\n\n# \uc8fc\ub9d0 \ub3d9\uc548\uc758 \ud2b8\ub798\ud53d\nrate(http_requests_total[5m]) and day_of_week() > 0 < 6\n"})}),"\n",(0,r.jsx)(n.h4,{id:"hour",children:"hour()"}),"\n",(0,r.jsx)(n.p,{children:"\uc2dc\uac04\uc744 \ubc18\ud658\ud569\ub2c8\ub2e4 (0-23)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ud604\uc7ac \uc2dc\uac04\nhour()\n\n# \uc5c5\ubb34 \uc2dc\uac04(9-18\uc2dc) \ub3d9\uc548\uc758 \uba54\ud2b8\ub9ad\nrate(http_requests_total[5m]) and hour() >= 9 <= 18\n"})}),"\n",(0,r.jsx)(n.h3,{id:"mathematical-functions",children:"Mathematical Functions"}),"\n",(0,r.jsx)(n.h4,{id:"abs",children:"abs()"}),"\n",(0,r.jsx)(n.p,{children:"\uc808\ub313\uac12\uc744 \ubc18\ud658\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"abs(delta(http_requests_total[5m]))\n"})}),"\n",(0,r.jsx)(n.h4,{id:"ceil--floor--round",children:"ceil() / floor() / round()"}),"\n",(0,r.jsx)(n.p,{children:"\uc62c\ub9bc / \ub0b4\ub9bc / \ubc18\uc62c\ub9bc\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"ceil(rate(http_requests_total[5m]))\nfloor(node_memory_usage)\nround(cpu_usage_percent, 0.1)  # \uc18c\uc218\uc810 \uccab\uc9f8 \uc790\ub9ac\n"})}),"\n",(0,r.jsx)(n.h4,{id:"exp--ln--log2--log10",children:"exp() / ln() / log2() / log10()"}),"\n",(0,r.jsx)(n.p,{children:"\uc9c0\uc218 / \uc790\uc5f0\ub85c\uadf8 / \ubc11\uc774 2\uc778 \ub85c\uadf8 / \ubc11\uc774 10\uc778 \ub85c\uadf8"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"exp(rate(http_requests_total[5m]))\nln(http_response_size_bytes)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"sqrt",children:"sqrt()"}),"\n",(0,r.jsx)(n.p,{children:"\uc81c\uacf1\uadfc\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"sqrt(http_requests_total)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"delta-and-derivative-functions",children:"Delta and Derivative Functions"}),"\n",(0,r.jsx)(n.h4,{id:"delta",children:"delta()"}),"\n",(0,r.jsx)(n.p,{children:"Range vector\uc758 \uccab \uac12\uacfc \ub9c8\uc9c0\ub9c9 \uac12\uc758 \ucc28\uc774\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc9c0\ub09c 5\ubd84\uac04 \uac8c\uc774\uc9c0 \uba54\ud2b8\ub9ad\uc758 \ubcc0\ud654\ub7c9\ndelta(node_memory_available_bytes[5m])\n\n# \uc9c0\ub09c 1\uc2dc\uac04 \ub3d9\uc548 \uc628\ub3c4 \ubcc0\ud654\ndelta(temperature_celsius[1h])\n"})}),"\n",(0,r.jsx)(n.h4,{id:"idelta",children:"idelta()"}),"\n",(0,r.jsx)(n.p,{children:"\ub9c8\uc9c0\ub9c9 \ub450 \uc0d8\ud50c\uc758 \ucc28\uc774\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"idelta(node_memory_available_bytes[5m])\n"})}),"\n",(0,r.jsx)(n.h4,{id:"deriv",children:"deriv()"}),"\n",(0,r.jsx)(n.p,{children:"Range vector\uc5d0\uc11c \uc120\ud615 \ud68c\uadc0\ub97c \uc0ac\uc6a9\ud55c \ucd08\ub2f9 \ubcc0\ud654\uc728\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"deriv(node_memory_available_bytes[5m])\n"})}),"\n",(0,r.jsx)(n.h3,{id:"prediction-functions",children:"Prediction Functions"}),"\n",(0,r.jsx)(n.h4,{id:"predict_linear",children:"predict_linear()"}),"\n",(0,r.jsx)(n.p,{children:"\uc120\ud615 \uc608\uce21\uc744 \uc218\ud589\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ud604\uc7ac \ucd94\uc138\ub85c 4\uc2dc\uac04 \ud6c4 \ub514\uc2a4\ud06c \uc0ac\uc6a9\ub7c9 \uc608\uce21\npredict_linear(node_filesystem_free_bytes[1h], 4 * 3600)\n\n# 1\uc2dc\uac04 \ud6c4 \uba54\ubaa8\ub9ac\uac00 \uace0\uac08\ub420 \uac83\uc73c\ub85c \uc608\uce21\ub418\uba74 \uc54c\ub9bc\npredict_linear(node_memory_available_bytes[30m], 3600) < 0\n"})}),"\n",(0,r.jsx)(n.h3,{id:"label-manipulation-functions",children:"Label Manipulation Functions"}),"\n",(0,r.jsx)(n.h4,{id:"label_replace",children:"label_replace()"}),"\n",(0,r.jsx)(n.p,{children:"\ub808\uc774\ube14 \uac12\uc744 \ubcc0\uacbd\ud558\uac70\ub098 \uc0c8 \ub808\uc774\ube14\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# instance \ub808\uc774\ube14\uc5d0\uc11c \ud638\uc2a4\ud2b8 \uc774\ub984\ub9cc \ucd94\ucd9c\nlabel_replace(\n  up,\n  "hostname",              # \uc0c8 \ub808\uc774\ube14 \uc774\ub984\n  "$1",                    # \ucd94\ucd9c\ud560 \uac12\n  "instance",              # \uc18c\uc2a4 \ub808\uc774\ube14\n  "([^:]+):.*"            # \uc815\uaddc\uc2dd \ud328\ud134\n)\n\n# \ud3ec\ud2b8 \ubc88\ud638 \ucd94\ucd9c\nlabel_replace(\n  up,\n  "port",\n  "$1",\n  "instance",\n  ".*:(.*)"\n)\n'})}),"\n",(0,r.jsx)(n.h4,{id:"label_join",children:"label_join()"}),"\n",(0,r.jsx)(n.p,{children:"\uc5ec\ub7ec \ub808\uc774\ube14\uc744 \uacb0\ud569\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# method\uc640 status\ub97c \uacb0\ud569\nlabel_join(\n  http_requests_total,\n  "method_status",        # \uc0c8 \ub808\uc774\ube14 \uc774\ub984\n  "_",                    # \uad6c\ubd84\uc790\n  "method",               # \uc18c\uc2a4 \ub808\uc774\ube14 1\n  "status"                # \uc18c\uc2a4 \ub808\uc774\ube14 2\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"sorting-functions",children:"Sorting Functions"}),"\n",(0,r.jsx)(n.h4,{id:"sort--sort_desc",children:"sort() / sort_desc()"}),"\n",(0,r.jsx)(n.p,{children:"\uc624\ub984\ucc28\uc21c / \ub0b4\ub9bc\ucc28\uc21c\uc73c\ub85c \uc815\ub82c\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# CPU \uc0ac\uc6a9\ub960\uc744 \uc624\ub984\ucc28\uc21c \uc815\ub82c\nsort(node_cpu_usage)\n\n# \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub960\uc744 \ub0b4\ub9bc\ucc28\uc21c \uc815\ub82c\nsort_desc(node_memory_usage)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"histogram-functions",children:"Histogram Functions"}),"\n",(0,r.jsx)(n.h4,{id:"histogram_quantile",children:"histogram_quantile()"}),"\n",(0,r.jsx)(n.p,{children:"\ud788\uc2a4\ud1a0\uadf8\ub7a8\uc5d0\uc11c \ubd84\uc704\uc218\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# 95th percentile \uc751\ub2f5 \uc2dc\uac04\nhistogram_quantile(\n  0.95,\n  rate(http_request_duration_seconds_bucket[5m])\n)\n\n# \uc11c\ube44\uc2a4\ubcc4 99th percentile\nhistogram_quantile(\n  0.99,\n  sum by (service, le) (rate(http_request_duration_seconds_bucket[5m]))\n)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"other-useful-functions",children:"Other Useful Functions"}),"\n",(0,r.jsx)(n.h4,{id:"absent",children:"absent()"}),"\n",(0,r.jsx)(n.p,{children:"\uba54\ud2b8\ub9ad\uc774 \uc5c6\uc73c\uba74 1\uc744 \ubc18\ud658\ud569\ub2c8\ub2e4 (\uc54c\ub9bc\uc5d0 \uc720\uc6a9)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# API \uc11c\ubc84\uac00 \uba54\ud2b8\ub9ad\uc744 \ubcf4\uace0\ud558\uc9c0 \uc54a\uc73c\uba74 \uc54c\ub9bc\nabsent(up{job="api-server"})\n\n# \ud2b9\uc815 \uc5d4\ub4dc\ud3ec\uc778\ud2b8\uc758 \uba54\ud2b8\ub9ad\uc774 \uc5c6\uc73c\uba74 \uc54c\ub9bc\nabsent(http_requests_total{endpoint="/critical"})\n'})}),"\n",(0,r.jsx)(n.h4,{id:"changes",children:"changes()"}),"\n",(0,r.jsx)(n.p,{children:"Range vector\uc5d0\uc11c \uac12\uc774 \ubcc0\uacbd\ub41c \ud69f\uc218\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc9c0\ub09c 1\uc2dc\uac04 \ub3d9\uc548 \uc7ac\uc2dc\uc791 \ud69f\uc218\nchanges(process_start_time_seconds[1h])\n"})}),"\n",(0,r.jsx)(n.h4,{id:"resets",children:"resets()"}),"\n",(0,r.jsx)(n.p,{children:"Counter\uac00 \uc7ac\uc124\uc815\ub41c \ud69f\uc218\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"resets(http_requests_total[1h])\n"})}),"\n",(0,r.jsx)(n.h2,{id:"35-aggregation-operations",children:"3.5 Aggregation Operations"}),"\n",(0,r.jsx)(n.p,{children:"\uc9d1\uacc4 \uc5f0\uc0b0\uc790\ub294 \uc5ec\ub7ec \uc2dc\uacc4\uc5f4\uc744 \ud558\ub098 \ub610\ub294 \uc5ec\ub7ec \uadf8\ub8f9\uc73c\ub85c \uacb0\ud569\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.h3,{id:"by\uc640-without",children:"by\uc640 without"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"by"}),": \uc9c0\uc815\ub41c \ub808\uc774\ube14\ub85c \uadf8\ub8f9\ud654\n",(0,r.jsx)(n.strong,{children:"without"}),": \uc9c0\uc815\ub41c \ub808\uc774\ube14\uc744 \uc81c\uc678\ud558\uace0 \uadf8\ub8f9\ud654"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uba54\uc11c\ub4dc\ubcc4\ub85c \uadf8\ub8f9\ud654\nsum by (method) (http_requests_total)\n\n# \uba54\uc11c\ub4dc\uc640 \uc0c1\ud0dc\ucf54\ub4dc\ubcc4\ub85c \uadf8\ub8f9\ud654\nsum by (method, status) (http_requests_total)\n\n# instance \ub808\uc774\ube14\uc744 \uc81c\uc678\ud558\uace0 \uadf8\ub8f9\ud654\nsum without (instance) (http_requests_total)\n\n# \uc5ec\ub7ec \ub808\uc774\ube14 \uc81c\uc678\navg without (instance, job) (node_cpu_usage)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\uc2e4\uc804-\uc9d1\uacc4-\ud328\ud134",children:"\uc2e4\uc804 \uc9d1\uacc4 \ud328\ud134"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc804\uccb4 \ud074\ub7ec\uc2a4\ud130 \uba54\ud2b8\ub9ad:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \ud074\ub7ec\uc2a4\ud130 \uc804\uccb4 \uc694\uccad \uc218\nsum(rate(http_requests_total[5m]))\n\n# \ud074\ub7ec\uc2a4\ud130 \uc804\uccb4 \uc5d0\ub7ec\uc728\nsum(rate(http_requests_total{status=~"5.."}[5m]))\n/\nsum(rate(http_requests_total[5m]))\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc11c\ube44\uc2a4\ubcc4 \uba54\ud2b8\ub9ad:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc11c\ube44\uc2a4\ubcc4 \uc694\uccad \uc218\nsum by (service) (rate(http_requests_total[5m]))\n\n# \uc11c\ube44\uc2a4\ubcc4 \ud3c9\uade0 \uc751\ub2f5 \uc2dc\uac04\navg by (service) (http_request_duration_seconds)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub2e4\ucc28\uc6d0 \uc9d1\uacc4:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \uc11c\ube44\uc2a4\uc640 \ud658\uacbd\ubcc4 \uc5d0\ub7ec\uc728\nsum by (service, environment) (rate(http_requests_total{status=~"5.."}[5m]))\n/\nsum by (service, environment) (rate(http_requests_total[5m]))\n\n# \uba54\uc11c\ub4dc\uc640 \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ubcc4 95th percentile \ub808\uc774\ud134\uc2dc\nhistogram_quantile(\n  0.95,\n  sum by (method, endpoint, le) (\n    rate(http_request_duration_seconds_bucket[5m])\n  )\n)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"36-recording-rules",children:"3.6 Recording Rules"}),"\n",(0,r.jsx)(n.p,{children:"Recording rules\ub294 \uc790\uc8fc \uc0ac\uc6a9\ub418\uac70\ub098 \uacc4\uc0b0 \ube44\uc6a9\uc774 \ub192\uc740 \ucffc\ub9ac\ub97c \ubbf8\ub9ac \uacc4\uc0b0\ud558\uc5ec \uc800\uc7a5\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.h3,{id:"\uc124\uc815-\ubc29\ubc95",children:"\uc124\uc815 \ubc29\ubc95"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"prometheus.yml"}),"\uc5d0 rules \ud30c\uc77c\uc744 \uc9c0\uc815\ud569\ub2c8\ub2e4:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'rule_files:\n  - "rules/*.yml"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"recording-rule-\uc791\uc131",children:"Recording Rule \uc791\uc131"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"rules/app_metrics.yml"})," \uc608\uc2dc:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'groups:\n  - name: http_metrics\n    interval: 30s\n    rules:\n      # \ucd08\ub2f9 \uc694\uccad \uc218\n      - record: job:http_requests:rate5m\n        expr: sum by (job) (rate(http_requests_total[5m]))\n\n      # \uba54\uc11c\ub4dc\ubcc4 \uc694\uccad \uc218\n      - record: job_method:http_requests:rate5m\n        expr: sum by (job, method) (rate(http_requests_total[5m]))\n\n      # \uc5d0\ub7ec\uc728\n      - record: job:http_errors:rate5m\n        expr: |\n          sum by (job) (rate(http_requests_total{status=~"5.."}[5m]))\n          /\n          sum by (job) (rate(http_requests_total[5m]))\n\n      # \ud3c9\uade0 \uc751\ub2f5 \uc2dc\uac04\n      - record: job:http_request_duration:avg5m\n        expr: |\n          sum by (job) (rate(http_request_duration_seconds_sum[5m]))\n          /\n          sum by (job) (rate(http_request_duration_seconds_count[5m]))\n\n  - name: infrastructure_metrics\n    interval: 1m\n    rules:\n      # \uc778\uc2a4\ud134\uc2a4\ubcc4 CPU \uc0ac\uc6a9\ub960\n      - record: instance:node_cpu_utilization:rate5m\n        expr: |\n          100 - (\n            avg by (instance) (rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100\n          )\n\n      # \uc778\uc2a4\ud134\uc2a4\ubcc4 \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub960\n      - record: instance:node_memory_utilization:ratio\n        expr: |\n          (\n            node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes\n          )\n          /\n          node_memory_MemTotal_bytes\n\n      # \ub514\uc2a4\ud06c \uc0ac\uc6a9\ub960\n      - record: instance_device:node_disk_utilization:ratio\n        expr: |\n          (\n            node_filesystem_size_bytes - node_filesystem_avail_bytes\n          )\n          /\n          node_filesystem_size_bytes\n'})}),"\n",(0,r.jsx)(n.h3,{id:"naming-convention",children:"Naming Convention"}),"\n",(0,r.jsx)(n.p,{children:"Recording rules\ub294 \ub2e4\uc74c \ub124\uc774\ubc0d \ucee8\ubca4\uc158\uc744 \ub530\ub985\ub2c8\ub2e4:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"level:metric:operations\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc608\uc2dc:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"job:http_requests:rate5m"})," - job \ub808\ubca8, 5\ubd84 rate"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"instance:node_cpu:avg"})," - instance \ub808\ubca8, \ud3c9\uade0"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"job_method:http_errors:rate5m"})," - job\uacfc method \ub808\ubca8, 5\ubd84 rate"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"\ubaa8\ubc94 \uc0ac\ub840",type:"tip",children:(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\uc790\uc8fc \uc0ac\uc6a9\ud558\ub294 \ubcf5\uc7a1\ud55c \ucffc\ub9ac\ub97c recording rule\ub85c \ub9cc\ub4dc\uc138\uc694"}),"\n",(0,r.jsx)(n.li,{children:"\ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \ubc18\ubcf5\ub418\ub294 \uacc4\uc0b0\uc744 recording rule\ub85c \ucd5c\uc801\ud654\ud558\uc138\uc694"}),"\n",(0,r.jsx)(n.li,{children:"\ub124\uc774\ubc0d \ucee8\ubca4\uc158\uc744 \uc77c\uad00\ub418\uac8c \uc720\uc9c0\ud558\uc138\uc694"}),"\n",(0,r.jsx)(n.li,{children:"interval\uc744 \uc801\uc808\ud788 \uc124\uc815\ud558\uc5ec \ub9ac\uc18c\uc2a4\ub97c \uc808\uc57d\ud558\uc138\uc694"}),"\n"]})}),"\n",(0,r.jsx)(n.h2,{id:"37-\uc2e4\uc804-\ucffc\ub9ac-\ud328\ud134",children:"3.7 \uc2e4\uc804 \ucffc\ub9ac \ud328\ud134"}),"\n",(0,r.jsx)(n.h3,{id:"\uc5d0\ub7ec\uc728-error-rate",children:"\uc5d0\ub7ec\uc728 (Error Rate)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uae30\ubcf8 \uc5d0\ub7ec\uc728:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \uc804\uccb4 \uc5d0\ub7ec\uc728 (5xx \uc751\ub2f5)\nsum(rate(http_requests_total{status=~"5.."}[5m]))\n/\nsum(rate(http_requests_total[5m]))\n* 100\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc11c\ube44\uc2a4\ubcc4 \uc5d0\ub7ec\uc728:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'sum by (service) (rate(http_requests_total{status=~"5.."}[5m]))\n/\nsum by (service) (rate(http_requests_total[5m]))\n* 100\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc5d4\ub4dc\ud3ec\uc778\ud2b8\ubcc4 \uc5d0\ub7ec\uc728 (\uc0c1\uc704 10\uac1c):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'topk(10,\n  sum by (endpoint) (rate(http_requests_total{status=~"5.."}[5m]))\n  /\n  sum by (endpoint) (rate(http_requests_total[5m]))\n  * 100\n)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4xx vs 5xx \ube44\uad50:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# 4xx \uc5d0\ub7ec\uc728\nsum(rate(http_requests_total{status=~"4.."}[5m]))\n/\nsum(rate(http_requests_total[5m]))\n* 100\n\n# 5xx \uc5d0\ub7ec\uc728\nsum(rate(http_requests_total{status=~"5.."}[5m]))\n/\nsum(rate(http_requests_total[5m]))\n* 100\n'})}),"\n",(0,r.jsx)(n.admonition,{title:"\uc5d0\ub7ec\uc728 \uc54c\ub9bc \uae30\uc900",type:"tip",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Warning: \uc5d0\ub7ec\uc728 > 1%"}),"\n",(0,r.jsx)(n.li,{children:"Critical: \uc5d0\ub7ec\uc728 > 5%"}),"\n",(0,r.jsx)(n.li,{children:"\ucd5c\uc18c 5\ubd84 \uc774\uc0c1 \uc9c0\uc18d\ub420 \ub54c \uc54c\ub9bc"}),"\n"]})}),"\n",(0,r.jsx)(n.h3,{id:"\ub808\uc774\ud134\uc2dc-latency",children:"\ub808\uc774\ud134\uc2dc (Latency)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ud3c9\uade0 \ub808\uc774\ud134\uc2dc:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc804\uccb4 \ud3c9\uade0\nrate(http_request_duration_seconds_sum[5m])\n/\nrate(http_request_duration_seconds_count[5m])\n\n# \uc11c\ube44\uc2a4\ubcc4 \ud3c9\uade0\nsum by (service) (rate(http_request_duration_seconds_sum[5m]))\n/\nsum by (service) (rate(http_request_duration_seconds_count[5m]))\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Percentile \ub808\uc774\ud134\uc2dc (\ud788\uc2a4\ud1a0\uadf8\ub7a8 \uc0ac\uc6a9):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# 50th percentile (\uc911\uc559\uac12)\nhistogram_quantile(0.5,\n  sum by (le) (rate(http_request_duration_seconds_bucket[5m]))\n)\n\n# 95th percentile\nhistogram_quantile(0.95,\n  sum by (le) (rate(http_request_duration_seconds_bucket[5m]))\n)\n\n# 99th percentile\nhistogram_quantile(0.99,\n  sum by (le) (rate(http_request_duration_seconds_bucket[5m]))\n)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc11c\ube44\uc2a4\ubcc4 Percentile:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc11c\ube44\uc2a4\ubcc4 95th percentile\nhistogram_quantile(0.95,\n  sum by (service, le) (rate(http_request_duration_seconds_bucket[5m]))\n)\n\n# \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ubcc4 99th percentile\nhistogram_quantile(0.99,\n  sum by (endpoint, le) (rate(http_request_duration_seconds_bucket[5m]))\n)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub808\uc774\ud134\uc2dc \ubd84\ud3ec:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# 1\ucd08 \uc774\uc0c1 \uc751\ub2f5\uc758 \ube44\uc728\nsum(rate(http_request_duration_seconds_bucket{le="1"}[5m]))\n/\nsum(rate(http_request_duration_seconds_count[5m]))\n* 100\n'})}),"\n",(0,r.jsx)(n.admonition,{title:"\ub808\uc774\ud134\uc2dc \ubaa9\ud45c",type:"tip",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"P50 < 100ms"}),"\n",(0,r.jsx)(n.li,{children:"P95 < 500ms"}),"\n",(0,r.jsx)(n.li,{children:"P99 < 1000ms\n(\uc11c\ube44\uc2a4 \uc694\uad6c\uc0ac\ud56d\uc5d0 \ub530\ub77c \uc870\uc815)"}),"\n"]})}),"\n",(0,r.jsx)(n.h3,{id:"\ucc98\ub9ac\ub7c9-throughput",children:"\ucc98\ub9ac\ub7c9 (Throughput)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ucd08\ub2f9 \uc694\uccad \uc218 (RPS):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc804\uccb4 RPS\nsum(rate(http_requests_total[5m]))\n\n# \uc11c\ube44\uc2a4\ubcc4 RPS\nsum by (service) (rate(http_requests_total[5m]))\n\n# \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ubcc4 RPS\nsum by (endpoint) (rate(http_requests_total[5m]))\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ubd84\ub2f9 \uc694\uccad \uc218 (RPM):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"sum(rate(http_requests_total[5m])) * 60\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uba54\uc11c\ub4dc\ubcc4 \ucc98\ub9ac\ub7c9:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"sum by (method) (rate(http_requests_total[5m]))\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc131\uacf5 vs \uc2e4\ud328 \ucc98\ub9ac\ub7c9:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \uc131\uacf5 (2xx, 3xx)\nsum(rate(http_requests_total{status=~"[23].."}[5m]))\n\n# \uc2e4\ud328 (4xx, 5xx)\nsum(rate(http_requests_total{status=~"[45].."}[5m]))\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ud53c\ud06c \uc2dc\uac04\ub300 \ubd84\uc11d:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc2dc\uac04\ub300\ubcc4 \ud3c9\uade0 \ucc98\ub9ac\ub7c9\navg_over_time(\n  sum(rate(http_requests_total[5m]))[1h:5m]\n)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"cpu-\uc0ac\uc6a9\ub960",children:"CPU \uc0ac\uc6a9\ub960"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc778\uc2a4\ud134\uc2a4\ubcc4 CPU \uc0ac\uc6a9\ub960:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'100 - (avg by (instance) (rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc804\uccb4 \ud074\ub7ec\uc2a4\ud130 \ud3c9\uade0 CPU:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'100 - (avg(rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"CPU \ubaa8\ub4dc\ubcc4 \uc0ac\uc6a9\ub960:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# User mode\nsum by (instance) (rate(node_cpu_seconds_total{mode="user"}[5m])) * 100\n\n# System mode\nsum by (instance) (rate(node_cpu_seconds_total{mode="system"}[5m])) * 100\n\n# I/O wait\nsum by (instance) (rate(node_cpu_seconds_total{mode="iowait"}[5m])) * 100\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\uba54\ubaa8\ub9ac-\uc0ac\uc6a9\ub960",children:"\uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub960"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub960:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"(\n  node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes\n)\n/\nnode_memory_MemTotal_bytes\n* 100\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc0ac\uc6a9 \uac00\ub2a5\ud55c \uba54\ubaa8\ub9ac:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"node_memory_MemAvailable_bytes / 1024 / 1024 / 1024  # GB \ub2e8\uc704\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uba54\ubaa8\ub9ac \uc0c1\uc138 \ubd84\uc11d:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ubc84\ud37c \uba54\ubaa8\ub9ac\nnode_memory_Buffers_bytes / 1024 / 1024  # MB \ub2e8\uc704\n\n# \uce90\uc2dc \uba54\ubaa8\ub9ac\nnode_memory_Cached_bytes / 1024 / 1024\n\n# \uc2a4\uc651 \uc0ac\uc6a9\ub960\n(\n  node_memory_SwapTotal_bytes - node_memory_SwapFree_bytes\n)\n/\nnode_memory_SwapTotal_bytes\n* 100\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\ub514\uc2a4\ud06c-\uc0ac\uc6a9\ub960",children:"\ub514\uc2a4\ud06c \uc0ac\uc6a9\ub960"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub514\uc2a4\ud06c \uc0ac\uc6a9\ub960:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"(\n  node_filesystem_size_bytes - node_filesystem_avail_bytes\n)\n/\nnode_filesystem_size_bytes\n* 100\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ud30c\uc77c\uc2dc\uc2a4\ud15c\ubcc4 \uc0ac\uc6a9\ub960:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'(\n  node_filesystem_size_bytes{mountpoint="/"} -\n  node_filesystem_avail_bytes{mountpoint="/"}\n)\n/\nnode_filesystem_size_bytes{mountpoint="/"}\n* 100\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub514\uc2a4\ud06c \uc0ac\uc6a9\ub7c9 \uc99d\uac00\uc728:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# 1\uc2dc\uac04 \ub3d9\uc548 \uc99d\uac00\ud55c \ub514\uc2a4\ud06c \uc0ac\uc6a9\ub7c9\ndelta(node_filesystem_avail_bytes[1h])\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub514\uc2a4\ud06c \uace0\uac08 \uc608\uce21:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ud604\uc7ac \ucd94\uc138\ub85c 24\uc2dc\uac04 \ud6c4 \uc0ac\uc6a9 \uac00\ub2a5\ud55c \uacf5\uac04\npredict_linear(node_filesystem_avail_bytes[6h], 24 * 3600)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\ub124\ud2b8\uc6cc\ud06c-\ud2b8\ub798\ud53d",children:"\ub124\ud2b8\uc6cc\ud06c \ud2b8\ub798\ud53d"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc218\uc2e0 \ud2b8\ub798\ud53d:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ucd08\ub2f9 \uc218\uc2e0 \ubc14\uc774\ud2b8\nrate(node_network_receive_bytes_total[5m])\n\n# \ucd08\ub2f9 \uc218\uc2e0 \uba54\uac00\ubc14\uc774\ud2b8\nrate(node_network_receive_bytes_total[5m]) / 1024 / 1024\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc1a1\uc2e0 \ud2b8\ub798\ud53d:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ucd08\ub2f9 \uc1a1\uc2e0 \ubc14\uc774\ud2b8\nrate(node_network_transmit_bytes_total[5m])\n\n# \ucd08\ub2f9 \uc1a1\uc2e0 \uba54\uac00\ubc14\uc774\ud2b8\nrate(node_network_transmit_bytes_total[5m]) / 1024 / 1024\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ucd1d \ud2b8\ub798\ud53d:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"(\n  rate(node_network_receive_bytes_total[5m]) +\n  rate(node_network_transmit_bytes_total[5m])\n) / 1024 / 1024  # MB/s\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc778\ud130\ud398\uc774\uc2a4\ubcc4 \ud2b8\ub798\ud53d:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"sum by (device) (rate(node_network_receive_bytes_total[5m]))\n"})}),"\n",(0,r.jsx)(n.h2,{id:"38-\ubcf5\uc7a1\ud55c-\ucffc\ub9ac-\uc608\uc81c",children:"3.8 \ubcf5\uc7a1\ud55c \ucffc\ub9ac \uc608\uc81c"}),"\n",(0,r.jsx)(n.h3,{id:"slislo-\uacc4\uc0b0",children:"SLI/SLO \uacc4\uc0b0"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Availability SLI:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# 30\uc77c \uac00\uc6a9\uc131\nsum(rate(http_requests_total{status!~"5.."}[30d]))\n/\nsum(rate(http_requests_total[30d]))\n* 100\n\n# 99.9% SLO \ub2ec\uc131 \uc5ec\ubd80\n(\n  sum(rate(http_requests_total{status!~"5.."}[30d]))\n  /\n  sum(rate(http_requests_total[30d]))\n) >= 0.999\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Latency SLI:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# P99 \ub808\uc774\ud134\uc2dc\uac00 1\ucd08 \ubbf8\ub9cc\uc778 \uc694\uccad\uc758 \ube44\uc728\nsum(rate(http_request_duration_seconds_bucket{le="1"}[5m]))\n/\nsum(rate(http_request_duration_seconds_count[5m]))\n* 100\n\n# 95% SLO \ub2ec\uc131 \uc5ec\ubd80\n(\n  sum(rate(http_request_duration_seconds_bucket{le="1"}[5m]))\n  /\n  sum(rate(http_request_duration_seconds_count[5m]))\n) >= 0.95\n'})}),"\n",(0,r.jsx)(n.h3,{id:"error-budget-\uacc4\uc0b0",children:"Error Budget \uacc4\uc0b0"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# 30\uc77c Error Budget (99.9% SLO \uae30\uc900)\n# Error Budget = 1 - SLO = 0.1%\n(1 - 0.999) -\n(\n  sum(rate(http_requests_total{status=~"5.."}[30d]))\n  /\n  sum(rate(http_requests_total[30d]))\n)\n\n# Error Budget \uc18c\uc9c4\uc728\n(\n  sum(rate(http_requests_total{status=~"5.."}[30d]))\n  /\n  sum(rate(http_requests_total[30d]))\n)\n/\n(1 - 0.999)\n* 100\n'})}),"\n",(0,r.jsx)(n.h3,{id:"apdex-score-\uacc4\uc0b0",children:"Apdex Score \uacc4\uc0b0"}),"\n",(0,r.jsx)(n.p,{children:"Apdex\ub294 \uc0ac\uc6a9\uc790 \ub9cc\uc871\ub3c4\ub97c \uce21\uc815\ud558\ub294 \ud45c\uc900 \uba54\ud2b8\ub9ad\uc785\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# Apdex Score\n# Satisfied: \uc751\ub2f5\uc2dc\uac04 < 0.5s\n# Tolerating: 0.5s <= \uc751\ub2f5\uc2dc\uac04 < 2s\n# Frustrated: \uc751\ub2f5\uc2dc\uac04 >= 2s\n(\n  sum(rate(http_request_duration_seconds_bucket{le="0.5"}[5m]))\n  +\n  sum(rate(http_request_duration_seconds_bucket{le="2"}[5m])) / 2\n)\n/\nsum(rate(http_request_duration_seconds_count[5m]))\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\uae08\uc8fc\uc640-\uc804\uc8fc-\ube44\uad50",children:"\uae08\uc8fc\uc640 \uc804\uc8fc \ube44\uad50"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc774\ubc88 \uc8fc \ud2b8\ub798\ud53d\nsum(rate(http_requests_total[1w]))\n\n# \uc9c0\ub09c \uc8fc \ud2b8\ub798\ud53d\nsum(rate(http_requests_total[1w] offset 1w))\n\n# \uc99d\uac00\uc728 \uacc4\uc0b0\n(\n  sum(rate(http_requests_total[1w]))\n  -\n  sum(rate(http_requests_total[1w] offset 1w))\n)\n/\nsum(rate(http_requests_total[1w] offset 1w))\n* 100\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\uc774\uc0c1-\ud0d0\uc9c0-anomaly-detection",children:"\uc774\uc0c1 \ud0d0\uc9c0 (Anomaly Detection)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ud45c\uc900\ud3b8\ucc28 \uae30\ubc18:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ud604\uc7ac \uac12\uc774 \ud3c9\uade0 + 2*\ud45c\uc900\ud3b8\ucc28\ub97c \ucd08\uacfc\ud558\ub294\uc9c0 \ud655\uc778\nabs(\n  http_requests_total -\n  avg_over_time(http_requests_total[1h])\n)\n>\n2 * stddev_over_time(http_requests_total[1h])\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc774\uc804 \uc8fc \ub3d9\uc77c \uc2dc\uac04\ub300 \ub300\ube44:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \uc9c0\ub09c\uc8fc \uac19\uc740 \uc2dc\uac04\ub300\ubcf4\ub2e4 50% \uc774\uc0c1 \uc99d\uac00\n(\n  rate(http_requests_total[5m])\n  -\n  rate(http_requests_total[5m] offset 1w)\n)\n/\nrate(http_requests_total[5m] offset 1w)\n> 0.5\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\ubcf5\ud569-\uc54c\ub9bc-\uc870\uac74",children:"\ubcf5\ud569 \uc54c\ub9bc \uc870\uac74"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \ub192\uc740 \uc5d0\ub7ec\uc728 AND \ub192\uc740 \ud2b8\ub798\ud53d\n(\n  sum(rate(http_requests_total{status=~"5.."}[5m]))\n  /\n  sum(rate(http_requests_total[5m]))\n  > 0.05\n)\nand\n(\n  sum(rate(http_requests_total[5m])) > 100\n)\n\n# \ub192\uc740 \ub808\uc774\ud134\uc2dc OR \ub192\uc740 \uc5d0\ub7ec\uc728\n(\n  histogram_quantile(0.95,\n    sum by (le) (rate(http_request_duration_seconds_bucket[5m]))\n  ) > 1\n)\nor\n(\n  sum(rate(http_requests_total{status=~"5.."}[5m]))\n  /\n  sum(rate(http_requests_total[5m]))\n  > 0.05\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\uce74\ub514\ub110\ub9ac\ud2f0-\ubd84\uc11d",children:"\uce74\ub514\ub110\ub9ac\ud2f0 \ubd84\uc11d"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \uba54\ud2b8\ub9ad \uc774\ub984\ubcc4 \uc2dc\uacc4\uc5f4 \uac1c\uc218\ncount by (__name__) ({__name__=~".+"})\n\n# \ud2b9\uc815 \uba54\ud2b8\ub9ad\uc758 \ub808\uc774\ube14\ubcc4 \uace0\uc720 \uac12 \uac1c\uc218\ncount by (label_name) (metric_name)\n\n# \uac00\uc7a5 \ub192\uc740 \uce74\ub514\ub110\ub9ac\ud2f0\ub97c \uac00\uc9c4 \uba54\ud2b8\ub9ad \uc0c1\uc704 10\uac1c\ntopk(10, count by (__name__) ({__name__=~".+"}))\n'})}),"\n",(0,r.jsx)(n.h2,{id:"39-python\uc73c\ub85c-promql-\ucffc\ub9ac-\uc2e4\ud589",children:"3.9 Python\uc73c\ub85c PromQL \ucffc\ub9ac \uc2e4\ud589"}),"\n",(0,r.jsx)(n.p,{children:"Prometheus HTTP API\ub97c \uc0ac\uc6a9\ud558\uc5ec Python\uc5d0\uc11c PromQL \ucffc\ub9ac\ub97c \uc2e4\ud589\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.h3,{id:"\uae30\ubcf8-\ucffc\ub9ac-\uc2e4\ud589",children:"\uae30\ubcf8 \ucffc\ub9ac \uc2e4\ud589"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import requests\nfrom datetime import datetime\n\nclass PrometheusClient:\n    def __init__(self, base_url='http://localhost:9090'):\n        self.base_url = base_url\n        self.query_url = f\"{base_url}/api/v1/query\"\n        self.query_range_url = f\"{base_url}/api/v1/query_range\"\n\n    def query(self, promql):\n        \"\"\"Instant query \uc2e4\ud589\"\"\"\n        response = requests.get(\n            self.query_url,\n            params={'query': promql}\n        )\n        response.raise_for_status()\n        return response.json()\n\n    def query_range(self, promql, start, end, step='15s'):\n        \"\"\"Range query \uc2e4\ud589\"\"\"\n        response = requests.get(\n            self.query_range_url,\n            params={\n                'query': promql,\n                'start': start,\n                'end': end,\n                'step': step\n            }\n        )\n        response.raise_for_status()\n        return response.json()\n\n# \uc0ac\uc6a9 \uc608\uc2dc\nclient = PrometheusClient()\n\n# Instant query\nresult = client.query('up')\nprint(result)\n\n# Range query\nresult = client.query_range(\n    'rate(http_requests_total[5m])',\n    start='2024-01-01T00:00:00Z',\n    end='2024-01-01T01:00:00Z',\n    step='1m'\n)\nprint(result)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\uc2e4\uc804-\ud65c\uc6a9-\uc608\uc81c",children:"\uc2e4\uc804 \ud65c\uc6a9 \uc608\uc81c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import requests\nimport pandas as pd\nfrom datetime import datetime, timedelta\nimport matplotlib.pyplot as plt\n\nclass PrometheusAnalyzer:\n    def __init__(self, base_url='http://localhost:9090'):\n        self.base_url = base_url\n        self.query_url = f\"{base_url}/api/v1/query\"\n        self.query_range_url = f\"{base_url}/api/v1/query_range\"\n\n    def get_current_metrics(self, promql):\n        \"\"\"\ud604\uc7ac \uba54\ud2b8\ub9ad \uac12 \uc870\ud68c\"\"\"\n        response = requests.get(\n            self.query_url,\n            params={'query': promql}\n        )\n        response.raise_for_status()\n        data = response.json()\n\n        if data['status'] != 'success':\n            raise Exception(f\"Query failed: {data}\")\n\n        results = []\n        for result in data['data']['result']:\n            metric = result['metric']\n            value = float(result['value'][1])\n            results.append({**metric, 'value': value})\n\n        return pd.DataFrame(results)\n\n    def get_time_series(self, promql, hours=1, step='1m'):\n        \"\"\"\uc2dc\uacc4\uc5f4 \ub370\uc774\ud130 \uc870\ud68c\"\"\"\n        end = datetime.now()\n        start = end - timedelta(hours=hours)\n\n        response = requests.get(\n            self.query_range_url,\n            params={\n                'query': promql,\n                'start': start.isoformat() + 'Z',\n                'end': end.isoformat() + 'Z',\n                'step': step\n            }\n        )\n        response.raise_for_status()\n        data = response.json()\n\n        if data['status'] != 'success':\n            raise Exception(f\"Query failed: {data}\")\n\n        all_series = []\n        for result in data['data']['result']:\n            metric = result['metric']\n            values = result['values']\n\n            df = pd.DataFrame(values, columns=['timestamp', 'value'])\n            df['timestamp'] = pd.to_datetime(df['timestamp'], unit='s')\n            df['value'] = df['value'].astype(float)\n\n            for key, val in metric.items():\n                df[key] = val\n\n            all_series.append(df)\n\n        if all_series:\n            return pd.concat(all_series, ignore_index=True)\n        else:\n            return pd.DataFrame()\n\n    def calculate_error_rate(self, job, hours=1):\n        \"\"\"\uc5d0\ub7ec\uc728 \uacc4\uc0b0\"\"\"\n        promql = f'''\n        sum(rate(http_requests_total{{job=\"{job}\", status=~\"5..\"}}[5m]))\n        /\n        sum(rate(http_requests_total{{job=\"{job}\"}}[5m]))\n        * 100\n        '''\n        return self.get_time_series(promql, hours=hours)\n\n    def calculate_latency_percentiles(self, job, percentiles=[0.5, 0.95, 0.99]):\n        \"\"\"\ub808\uc774\ud134\uc2dc percentile \uacc4\uc0b0\"\"\"\n        results = {}\n        for p in percentiles:\n            promql = f'''\n            histogram_quantile({p},\n              sum by (le) (rate(http_request_duration_seconds_bucket{{job=\"{job}\"}}[5m]))\n            )\n            '''\n            df = self.get_current_metrics(promql)\n            if not df.empty:\n                results[f'p{int(p*100)}'] = df['value'].iloc[0]\n        return results\n\n    def get_top_endpoints_by_traffic(self, job, limit=10):\n        \"\"\"\ud2b8\ub798\ud53d\uc774 \ub192\uc740 \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \uc870\ud68c\"\"\"\n        promql = f'''\n        topk({limit},\n          sum by (endpoint) (rate(http_requests_total{{job=\"{job}\"}}[5m]))\n        )\n        '''\n        return self.get_current_metrics(promql)\n\n    def plot_time_series(self, promql, hours=1, title='Time Series'):\n        \"\"\"\uc2dc\uacc4\uc5f4 \ub370\uc774\ud130 \uc2dc\uac01\ud654\"\"\"\n        df = self.get_time_series(promql, hours=hours)\n\n        if df.empty:\n            print(\"No data to plot\")\n            return\n\n        plt.figure(figsize=(12, 6))\n\n        # \ub808\uc774\ube14 \uc870\ud569\uc73c\ub85c \uadf8\ub8f9\ud654\n        if 'instance' in df.columns:\n            for instance in df['instance'].unique():\n                data = df[df['instance'] == instance]\n                plt.plot(data['timestamp'], data['value'], label=instance)\n        else:\n            plt.plot(df['timestamp'], df['value'])\n\n        plt.xlabel('Time')\n        plt.ylabel('Value')\n        plt.title(title)\n        plt.legend()\n        plt.grid(True)\n        plt.xticks(rotation=45)\n        plt.tight_layout()\n        plt.show()\n\n# \uc0ac\uc6a9 \uc608\uc2dc\nanalyzer = PrometheusAnalyzer('http://localhost:9090')\n\n# \ud604\uc7ac \uc5d0\ub7ec\uc728 \uc870\ud68c\nerror_rate = analyzer.calculate_error_rate('api-server', hours=6)\nprint(\"Error Rate:\")\nprint(error_rate)\n\n# \ub808\uc774\ud134\uc2dc percentile\nlatency = analyzer.calculate_latency_percentiles('api-server')\nprint(\"\\nLatency Percentiles:\")\nprint(latency)\n\n# \uc0c1\uc704 \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ntop_endpoints = analyzer.get_top_endpoints_by_traffic('api-server', limit=5)\nprint(\"\\nTop Endpoints:\")\nprint(top_endpoints)\n\n# CPU \uc0ac\uc6a9\ub960 \uc2dc\uac01\ud654\nanalyzer.plot_time_series(\n    'rate(node_cpu_seconds_total{mode!=\"idle\"}[5m]) * 100',\n    hours=2,\n    title='CPU Usage'\n)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\ub300\uc2dc\ubcf4\ub4dc-\ub370\uc774\ud130-\uc218\uc9d1",children:"\ub300\uc2dc\ubcf4\ub4dc \ub370\uc774\ud130 \uc218\uc9d1"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import requests\nimport json\nfrom datetime import datetime, timedelta\n\nclass PrometheusDashboard:\n    def __init__(self, base_url='http://localhost:9090'):\n        self.base_url = base_url\n        self.query_url = f\"{base_url}/api/v1/query\"\n\n    def get_dashboard_data(self, job='api-server'):\n        \"\"\"\ub300\uc2dc\ubcf4\ub4dc\uc6a9 \uc885\ud569 \ub370\uc774\ud130 \uc218\uc9d1\"\"\"\n        queries = {\n            'total_requests': f'sum(rate(http_requests_total{{job=\"{job}\"}}[5m]))',\n            'error_rate': f'''\n                sum(rate(http_requests_total{{job=\"{job}\", status=~\"5..\"}}[5m]))\n                /\n                sum(rate(http_requests_total{{job=\"{job}\"}}[5m]))\n                * 100\n            ''',\n            'p95_latency': f'''\n                histogram_quantile(0.95,\n                  sum by (le) (rate(http_request_duration_seconds_bucket{{job=\"{job}\"}}[5m]))\n                )\n            ''',\n            'p99_latency': f'''\n                histogram_quantile(0.99,\n                  sum by (le) (rate(http_request_duration_seconds_bucket{{job=\"{job}\"}}[5m]))\n                )\n            ''',\n            'active_instances': f'count(up{{job=\"{job}\"}} == 1)',\n            'cpu_usage': f'avg(rate(node_cpu_seconds_total{{mode!=\"idle\"}}[5m])) * 100',\n            'memory_usage': f'''\n                avg(\n                  (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes)\n                  /\n                  node_memory_MemTotal_bytes\n                ) * 100\n            '''\n        }\n\n        results = {}\n        for name, query in queries.items():\n            try:\n                response = requests.get(\n                    self.query_url,\n                    params={'query': query}\n                )\n                response.raise_for_status()\n                data = response.json()\n\n                if data['status'] == 'success' and data['data']['result']:\n                    value = float(data['data']['result'][0]['value'][1])\n                    results[name] = round(value, 2)\n                else:\n                    results[name] = None\n            except Exception as e:\n                print(f\"Error fetching {name}: {e}\")\n                results[name] = None\n\n        return results\n\n    def print_dashboard(self, job='api-server'):\n        \"\"\"\ub300\uc2dc\ubcf4\ub4dc \ucd9c\ub825\"\"\"\n        data = self.get_dashboard_data(job)\n\n        print(\"=\" * 60)\n        print(f\"Dashboard for {job}\".center(60))\n        print(\"=\" * 60)\n        print(f\"\\nTraffic:\")\n        print(f\"  Total Requests/s: {data['total_requests']}\")\n        print(f\"\\nReliability:\")\n        print(f\"  Error Rate: {data['error_rate']}%\")\n        print(f\"  Active Instances: {data['active_instances']}\")\n        print(f\"\\nLatency:\")\n        print(f\"  P95: {data['p95_latency']}s\")\n        print(f\"  P99: {data['p99_latency']}s\")\n        print(f\"\\nInfrastructure:\")\n        print(f\"  CPU Usage: {data['cpu_usage']}%\")\n        print(f\"  Memory Usage: {data['memory_usage']}%\")\n        print(\"=\" * 60)\n\n        return data\n\n# \uc0ac\uc6a9 \uc608\uc2dc\ndashboard = PrometheusDashboard('http://localhost:9090')\ndashboard.print_dashboard('api-server')\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\uc54c\ub9bc-\uc870\uac74-\uac80\uc99d",children:"\uc54c\ub9bc \uc870\uac74 \uac80\uc99d"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import requests\nfrom datetime import datetime, timedelta\n\nclass PrometheusAlertValidator:\n    def __init__(self, base_url='http://localhost:9090'):\n        self.base_url = base_url\n        self.query_url = f\"{base_url}/api/v1/query\"\n        self.query_range_url = f\"{base_url}/api/v1/query_range\"\n\n    def check_alert_condition(self, promql, threshold, comparison='gt'):\n        \"\"\"\uc54c\ub9bc \uc870\uac74 \ud655\uc778\"\"\"\n        response = requests.get(\n            self.query_url,\n            params={'query': promql}\n        )\n        response.raise_for_status()\n        data = response.json()\n\n        if data['status'] != 'success' or not data['data']['result']:\n            return False, None\n\n        value = float(data['data']['result'][0]['value'][1])\n\n        comparisons = {\n            'gt': lambda v, t: v > t,\n            'gte': lambda v, t: v >= t,\n            'lt': lambda v, t: v < t,\n            'lte': lambda v, t: v <= t,\n            'eq': lambda v, t: v == t\n        }\n\n        is_triggered = comparisons[comparison](value, threshold)\n        return is_triggered, value\n\n    def validate_alert_rules(self, alerts):\n        \"\"\"\uc5ec\ub7ec \uc54c\ub9bc \uaddc\uce59 \uac80\uc99d\"\"\"\n        results = []\n\n        for alert in alerts:\n            is_triggered, value = self.check_alert_condition(\n                alert['query'],\n                alert['threshold'],\n                alert.get('comparison', 'gt')\n            )\n\n            results.append({\n                'name': alert['name'],\n                'triggered': is_triggered,\n                'current_value': value,\n                'threshold': alert['threshold'],\n                'severity': alert.get('severity', 'warning')\n            })\n\n        return results\n\n    def print_alert_status(self, alerts):\n        \"\"\"\uc54c\ub9bc \uc0c1\ud0dc \ucd9c\ub825\"\"\"\n        results = self.validate_alert_rules(alerts)\n\n        print(\"\\nAlert Status:\")\n        print(\"=\" * 80)\n\n        for result in results:\n            status = \"FIRING\" if result['triggered'] else \"OK\"\n            severity = result['severity'].upper()\n\n            print(f\"[{status}] [{severity}] {result['name']}\")\n            print(f\"  Current: {result['current_value']}\")\n            print(f\"  Threshold: {result['threshold']}\")\n            print()\n\n# \uc0ac\uc6a9 \uc608\uc2dc\nvalidator = PrometheusAlertValidator('http://localhost:9090')\n\nalert_rules = [\n    {\n        'name': 'High Error Rate',\n        'query': 'sum(rate(http_requests_total{status=~\"5..\"}[5m])) / sum(rate(http_requests_total[5m])) * 100',\n        'threshold': 5,\n        'comparison': 'gt',\n        'severity': 'critical'\n    },\n    {\n        'name': 'High Latency P95',\n        'query': 'histogram_quantile(0.95, sum by (le) (rate(http_request_duration_seconds_bucket[5m])))',\n        'threshold': 1,\n        'comparison': 'gt',\n        'severity': 'warning'\n    },\n    {\n        'name': 'Low CPU Usage',\n        'query': 'avg(rate(node_cpu_seconds_total{mode!=\"idle\"}[5m])) * 100',\n        'threshold': 80,\n        'comparison': 'lt',\n        'severity': 'info'\n    }\n]\n\nvalidator.print_alert_status(alert_rules)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"310-\ucffc\ub9ac-\ucd5c\uc801\ud654",children:"3.10 \ucffc\ub9ac \ucd5c\uc801\ud654"}),"\n",(0,r.jsx)(n.h3,{id:"\ucd5c\uc801\ud654-\uc6d0\uce59",children:"\ucd5c\uc801\ud654 \uc6d0\uce59"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Recording Rules \ud65c\uc6a9"}),": \uc790\uc8fc \uc0ac\uc6a9\ud558\ub294 \ubcf5\uc7a1\ud55c \ucffc\ub9ac\ub294 recording rule\ub85c \uc0ac\uc804 \uacc4\uc0b0"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\ub808\uc774\ube14 \uce74\ub514\ub110\ub9ac\ud2f0 \ucd5c\uc18c\ud654"}),": \ubd88\ud544\uc694\ud55c \ub808\uc774\ube14 \uc81c\uac70"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc801\uc808\ud55c \uc2dc\uac04 \ubc94\uc704 \uc120\ud0dd"}),": \ub108\ubb34 \uae34 \ubc94\uc704\ub294 \uc131\ub2a5 \uc800\ud558"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc9d1\uacc4 \uc6b0\uc120"}),": \uac00\ub2a5\ud55c \ud55c \uc77c\ucc0d \uc9d1\uacc4 \uc218\ud589"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\uc815\uaddc\uc2dd \ucd5c\uc18c\ud654"}),": \uc815\ud655\ud55c \ub9e4\uce6d \uc6b0\uc120 \uc0ac\uc6a9"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\ub098\uc05c-\ucffc\ub9ac-vs-\uc88b\uc740-\ucffc\ub9ac",children:"\ub098\uc05c \ucffc\ub9ac vs \uc88b\uc740 \ucffc\ub9ac"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub098\uc05c \uc608\uc2dc:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \uc815\uaddc\uc2dd \ub0a8\uc6a9\n{__name__=~".*requests.*", instance=~".*prod.*"}\n\n# \ub108\ubb34 \uae34 \uc2dc\uac04 \ubc94\uc704\nrate(http_requests_total[1d])\n\n# \ub2a6\uc740 \uc9d1\uacc4\nsum(http_requests_total{status="200"} + http_requests_total{status="201"})\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc88b\uc740 \uc608\uc2dc:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \uc815\ud655\ud55c \uba54\ud2b8\ub9ad \uc774\ub984 \uc0ac\uc6a9\nhttp_requests_total{instance=~"prod.*"}\n\n# \uc801\uc808\ud55c \uc2dc\uac04 \ubc94\uc704 (4x scrape interval)\nrate(http_requests_total[5m])\n\n# \uc870\uae30 \uc9d1\uacc4\nsum(http_requests_total{status=~"20."})\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\uce74\ub514\ub110\ub9ac\ud2f0-\uad00\ub9ac",children:"\uce74\ub514\ub110\ub9ac\ud2f0 \uad00\ub9ac"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub192\uc740 \uce74\ub514\ub110\ub9ac\ud2f0 \ud655\uc778:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \uba54\ud2b8\ub9ad\ubcc4 \uc2dc\uacc4\uc5f4 \uac1c\uc218\ntopk(20, count by (__name__) ({__name__=~".+"}))\n\n# \ud2b9\uc815 \uba54\ud2b8\ub9ad\uc758 \ub808\uc774\ube14 \uce74\ub514\ub110\ub9ac\ud2f0\ncount by (label_name) (metric_name)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ud574\uacb0 \ubc29\ubc95:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Recording rules\ub85c \uc9d1\uacc4\ub41c \uba54\ud2b8\ub9ad \uc0dd\uc131"}),"\n",(0,r.jsx)(n.li,{children:"\ubd88\ud544\uc694\ud55c \ub808\uc774\ube14 \uc81c\uac70 (relabel_configs \uc0ac\uc6a9)"}),"\n",(0,r.jsx)(n.li,{children:"\ub808\uc774\ube14 \uac12 \uc815\uaddc\ud654"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\ucffc\ub9ac-\uc131\ub2a5-\uce21\uc815",children:"\ucffc\ub9ac \uc131\ub2a5 \uce21\uc815"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import requests\nimport time\n\ndef measure_query_performance(query, prometheus_url='http://localhost:9090'):\n    \"\"\"\ucffc\ub9ac \uc131\ub2a5 \uce21\uc815\"\"\"\n    start_time = time.time()\n\n    response = requests.get(\n        f\"{prometheus_url}/api/v1/query\",\n        params={'query': query}\n    )\n\n    end_time = time.time()\n    execution_time = end_time - start_time\n\n    response.raise_for_status()\n    data = response.json()\n\n    result_count = len(data['data']['result'])\n\n    print(f\"Query: {query}\")\n    print(f\"Execution Time: {execution_time:.3f}s\")\n    print(f\"Result Count: {result_count}\")\n    print()\n\n    return execution_time, result_count\n\n# \uc608\uc2dc\nmeasure_query_performance('up')\nmeasure_query_performance('rate(http_requests_total[5m])')\nmeasure_query_performance('sum by (job) (rate(http_requests_total[5m]))')\n"})}),"\n",(0,r.jsx)(n.h2,{id:"311-\ub514\ubc84\uae45-\ud301",children:"3.11 \ub514\ubc84\uae45 \ud301"}),"\n",(0,r.jsx)(n.h3,{id:"\ucffc\ub9ac-\ub2e8\uacc4\ubcc4-\uc2e4\ud589",children:"\ucffc\ub9ac \ub2e8\uacc4\ubcc4 \uc2e4\ud589"}),"\n",(0,r.jsx)(n.p,{children:"\ubcf5\uc7a1\ud55c \ucffc\ub9ac\ub294 \ub2e8\uacc4\ubcc4\ub85c \ub098\ub204\uc5b4 \uc2e4\ud589\ud558\uc138\uc694:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# 1\ub2e8\uacc4: \uae30\ubcf8 \uba54\ud2b8\ub9ad \ud655\uc778\nhttp_requests_total\n\n# 2\ub2e8\uacc4: \ud544\ud130 \ucd94\uac00\nhttp_requests_total{status=~"5.."}\n\n# 3\ub2e8\uacc4: Rate \uacc4\uc0b0\nrate(http_requests_total{status=~"5.."}[5m])\n\n# 4\ub2e8\uacc4: \uc9d1\uacc4\nsum(rate(http_requests_total{status=~"5.."}[5m]))\n\n# 5\ub2e8\uacc4: \uc5d0\ub7ec\uc728 \uacc4\uc0b0\nsum(rate(http_requests_total{status=~"5.."}[5m]))\n/\nsum(rate(http_requests_total[5m]))\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\uc77c\ubc18\uc801\uc778-\uc624\ub958\uc640-\ud574\uacb0",children:"\uc77c\ubc18\uc801\uc778 \uc624\ub958\uc640 \ud574\uacb0"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:'\uc624\ub958 1: "no data"'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \ubb38\uc81c: \uba54\ud2b8\ub9ad\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc74c\nnon_existent_metric\n\n# \ud574\uacb0: \uba54\ud2b8\ub9ad \uc774\ub984 \ud655\uc778\n{__name__=~".*request.*"}  # \uba54\ud2b8\ub9ad \uac80\uc0c9\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:'\uc624\ub958 2: "invalid expression type"'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ubb38\uc81c: range vector\ub97c instant vector\ucc98\ub7fc \uc0ac\uc6a9\nhttp_requests_total[5m] > 100\n\n# \ud574\uacb0: rate() \ub4f1\uc758 \ud568\uc218 \uc0ac\uc6a9\nrate(http_requests_total[5m]) > 100\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:'\uc624\ub958 3: "many-to-many matching not allowed"'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ubb38\uc81c: \ub808\uc774\ube14 \ub9e4\uce6d \uc2e4\ud328\nmetric1 / metric2\n\n# \ud574\uacb0: on() \ub610\ub294 ignoring() \uc0ac\uc6a9\nmetric1 / on(job) metric2\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uc624\ub958 4: \ube48 \uacb0\uacfc"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \ubb38\uc81c: \ub808\uc774\ube14 \uc120\ud0dd\uc790\uac00 \ub108\ubb34 \uc5c4\uaca9\nhttp_requests_total{job="api", instance="localhost:8080", method="GET", endpoint="/api"}\n\n# \ud574\uacb0: \ud544\uc218 \ub808\uc774\ube14\ub9cc \uc0ac\uc6a9\nhttp_requests_total{job="api"}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\uc720\uc6a9\ud55c-\ub514\ubc84\uae45-\ucffc\ub9ac",children:"\uc720\uc6a9\ud55c \ub514\ubc84\uae45 \ucffc\ub9ac"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\uba54\ud2b8\ub9ad \ud0d0\uc0c9:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \ubaa8\ub4e0 \uba54\ud2b8\ub9ad \uc774\ub984\n{__name__=~".+"}\n\n# \ud2b9\uc815 \ubb38\uc790\uc5f4 \ud3ec\ud568 \uba54\ud2b8\ub9ad\n{__name__=~".*http.*"}\n\n# \ud2b9\uc815 job\uc758 \ubaa8\ub4e0 \uba54\ud2b8\ub9ad\n{job="api-server"}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub808\uc774\ube14 \ud655\uc778:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"# \ud2b9\uc815 \uba54\ud2b8\ub9ad\uc758 \ubaa8\ub4e0 \ub808\uc774\ube14 \uc870\ud569\ncount by (label1, label2) (metric_name)\n\n# \ub808\uc774\ube14 \uac12 \ubaa9\ub85d\ngroup by (label_name) (metric_name)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\ub370\uc774\ud130 \uc874\uc7ac \ud655\uc778:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# \ucd5c\uadfc 5\ubd84\uac04 \ub370\uc774\ud130\uac00 \uc788\ub294\uc9c0 \ud655\uc778\ncount_over_time(metric_name[5m])\n\n# \uba54\ud2b8\ub9ad\uc774 \uc218\uc9d1\ub418\uace0 \uc788\ub294\uc9c0 \ud655\uc778\nup{job="target-job"}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"prometheus-ui-\ud65c\uc6a9",children:"Prometheus UI \ud65c\uc6a9"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Graph \ud0ed"}),": \uc2dc\uacc4\uc5f4 \ub370\uc774\ud130 \uc2dc\uac01\ud654"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Table \ud0ed"}),": \ud604\uc7ac \uac12 \ud14c\uc774\ube14\ub85c \ud45c\uc2dc"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Console \ud0ed"}),": \uc0c1\uc138 \uacb0\uacfc \ud655\uc778"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enable query history"}),": \uc774\uc804 \ucffc\ub9ac \uc7ac\uc0ac\uc6a9"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enable autocomplete"}),": \uba54\ud2b8\ub9ad \uc774\ub984 \uc790\ub3d9\uc644\uc131"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"312-\uc5f0\uc2b5-\ubb38\uc81c",children:"3.12 \uc5f0\uc2b5 \ubb38\uc81c"}),"\n",(0,r.jsx)(n.h3,{id:"\uae30\ucd08-\ubb38\uc81c",children:"\uae30\ucd08 \ubb38\uc81c"}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:"1. \ubaa8\ub4e0 \uc778\uc2a4\ud134\uc2a4\uc758 \ucd1d HTTP \uc694\uccad \uc218\ub97c \uacc4\uc0b0\ud558\uc138\uc694."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"sum(http_requests_total)\n"})})]}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:"2. GET \uba54\uc11c\ub4dc\ub9cc \ud544\ud130\ub9c1\ud558\uc5ec \ucd08\ub2f9 \uc694\uccad \uc218\ub97c \uacc4\uc0b0\ud558\uc138\uc694."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'sum(rate(http_requests_total{method="GET"}[5m]))\n'})})]}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:"3. CPU \uc0ac\uc6a9\ub960\uc774 80% \uc774\uc0c1\uc778 \uc778\uc2a4\ud134\uc2a4\ub97c \ucc3e\uc73c\uc138\uc694."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"node_cpu_usage > 80\n"})})]}),"\n",(0,r.jsx)(n.h3,{id:"\uc911\uae09-\ubb38\uc81c",children:"\uc911\uae09 \ubb38\uc81c"}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:"4. \uc11c\ube44\uc2a4\ubcc4 \uc5d0\ub7ec\uc728\uc744 \uacc4\uc0b0\ud558\uc138\uc694 (5xx \uc751\ub2f5 \uae30\uc900)."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'sum by (service) (rate(http_requests_total{status=~"5.."}[5m]))\n/\nsum by (service) (rate(http_requests_total[5m]))\n* 100\n'})})]}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:"5. \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ubcc4 95th percentile \ub808\uc774\ud134\uc2dc\ub97c \uacc4\uc0b0\ud558\uc138\uc694."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"histogram_quantile(0.95,\n  sum by (endpoint, le) (rate(http_request_duration_seconds_bucket[5m]))\n)\n"})})]}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:"6. \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub960\uc744 \ud37c\uc13c\ud2b8\ub85c \uacc4\uc0b0\ud558\uc138\uc694."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"(\n  node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes\n)\n/\nnode_memory_MemTotal_bytes\n* 100\n"})})]}),"\n",(0,r.jsx)(n.h3,{id:"\uace0\uae09-\ubb38\uc81c",children:"\uace0\uae09 \ubb38\uc81c"}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:"7. \ud604\uc7ac \ud2b8\ub798\ud53d\uacfc 1\uc2dc\uac04 \uc804 \ud2b8\ub798\ud53d\uc744 \ube44\uad50\ud558\uc5ec \uc99d\uac00\uc728\uc744 \uacc4\uc0b0\ud558\uc138\uc694."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"(\n  sum(rate(http_requests_total[5m]))\n  -\n  sum(rate(http_requests_total[5m] offset 1h))\n)\n/\nsum(rate(http_requests_total[5m] offset 1h))\n* 100\n"})})]}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:"8. Apdex Score\ub97c \uacc4\uc0b0\ud558\uc138\uc694 (Satisfied: < 0.3s, Tolerating: < 1.2s)."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'(\n  sum(rate(http_request_duration_seconds_bucket{le="0.3"}[5m]))\n  +\n  sum(rate(http_request_duration_seconds_bucket{le="1.2"}[5m])) / 2\n)\n/\nsum(rate(http_request_duration_seconds_count[5m]))\n'})})]}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:"9. \ud604\uc7ac \ucd94\uc138\ub85c 6\uc2dc\uac04 \ud6c4 \ub514\uc2a4\ud06c\uac00 \uac00\ub4dd \ucc30 \uac83\uc73c\ub85c \uc608\uce21\ub418\ub294 \uc778\uc2a4\ud134\uc2a4\ub97c \ucc3e\uc73c\uc138\uc694."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"predict_linear(node_filesystem_avail_bytes[1h], 6 * 3600) < 0\n"})})]}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:"10. \uba54\uc11c\ub4dc\uc640 \uc0c1\ud0dc\ucf54\ub4dc\ubcc4 \uc694\uccad \ubd84\ud3ec\ub97c \uacc4\uc0b0\ud558\uace0, \uc804\uccb4 \ub300\ube44 \ube44\uc728\uc744 \uad6c\ud558\uc138\uc694."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:"sum by (method, status) (rate(http_requests_total[5m]))\n/\nsum(rate(http_requests_total[5m]))\n* 100\n"})})]}),"\n",(0,r.jsx)(n.h2,{id:"\ub2e4\uc74c-\ub2e8\uacc4",children:"\ub2e4\uc74c \ub2e8\uacc4"}),"\n",(0,r.jsx)(n.p,{children:"\uc774\uc81c PromQL\uc758 \uae30\ubcf8\ubd80\ud130 \uace0\uae09 \ud65c\uc6a9\uae4c\uc9c0 \ubaa8\ub450 \ub2e4\ub918\uc2b5\ub2c8\ub2e4. \ub2e4\uc74c \uc139\uc158\uc5d0\uc11c\ub294 Grafana\uc640 Prometheus\ub97c \uc5f0\ub3d9\ud558\uc5ec \uac15\ub825\ud55c \uc2dc\uac01\ud654 \ub300\uc2dc\ubcf4\ub4dc\ub97c \ub9cc\ub4dc\ub294 \ubc29\ubc95\uc744 \ubc30\uc6c1\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"./grafana",children:"Grafana \uc5f0\ub3d9"})})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);