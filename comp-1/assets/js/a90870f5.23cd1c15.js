"use strict";(globalThis.webpackChunkgithub_docs=globalThis.webpackChunkgithub_docs||[]).push([[8756],{5757:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"oauth/scenarios/spa-integration","title":"SPA \ud1b5\ud569","description":"React, Vue, Angular \ub4f1 Single Page Application\uc5d0\uc11c OAuth 2.0 / OIDC\ub97c \uc548\uc804\ud558\uac8c \uad6c\ud604\ud558\ub294 \ubc29\ubc95\uc744 \ubc30\uc6c1\ub2c8\ub2e4.","source":"@site/docs/oauth/scenarios/spa-integration.md","sourceDirName":"oauth/scenarios","slug":"/oauth/scenarios/spa-integration","permalink":"/tobias-docs/comp-1/docs/oauth/scenarios/spa-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/oauth/scenarios/spa-integration.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"oauthSidebar","previous":{"title":"\uc790\uccb4 OAuth 2.0 \uc11c\ubc84 \uad6c\ucd95","permalink":"/tobias-docs/comp-1/docs/oauth/scenarios/oauth-server"},"next":{"title":"\ubaa8\ubc14\uc77c \uc571 OAuth","permalink":"/tobias-docs/comp-1/docs/oauth/scenarios/mobile-app"}}');var s=t(4848),o=t(8453);const a={sidebar_position:3},i="SPA \ud1b5\ud569",c={},l=[{value:"\ud83c\udfaf \ubaa9\ud45c",id:"-\ubaa9\ud45c",level:2},{value:"\u26a0\ufe0f SPA\uc758 \ud2b9\uc218\uc131",id:"\ufe0f-spa\uc758-\ud2b9\uc218\uc131",level:2},{value:"\ubb38\uc81c\uc810",id:"\ubb38\uc81c\uc810",level:3},{value:"\ud83d\udd27 React + TypeScript \uad6c\ud604",id:"-react--typescript-\uad6c\ud604",level:2},{value:"1. \ud504\ub85c\uc81d\ud2b8 \uc124\uc815",id:"1-\ud504\ub85c\uc81d\ud2b8-\uc124\uc815",level:3},{value:"2. OAuth \uc124\uc815",id:"2-oauth-\uc124\uc815",level:3},{value:"3. PKCE \uc720\ud2f8\ub9ac\ud2f0",id:"3-pkce-\uc720\ud2f8\ub9ac\ud2f0",level:3},{value:"4. OAuth \ud6c5",id:"4-oauth-\ud6c5",level:3},{value:"5. Axios \uc778\ud130\uc149\ud130",id:"5-axios-\uc778\ud130\uc149\ud130",level:3},{value:"6. \ucf5c\ubc31 \ud398\uc774\uc9c0",id:"6-\ucf5c\ubc31-\ud398\uc774\uc9c0",level:3},{value:"7. \uba54\uc778 \uc571",id:"7-\uba54\uc778-\uc571",level:3},{value:"\ud83d\udd10 \ubc31\uc5d4\ub4dc (Token Proxy)",id:"-\ubc31\uc5d4\ub4dc-token-proxy",level:2},{value:"FastAPI \ubc31\uc5d4\ub4dc",id:"fastapi-\ubc31\uc5d4\ub4dc",level:3},{value:"\ud83c\udfa8 BFF Pattern (\uc120\ud0dd)",id:"-bff-pattern-\uc120\ud0dd",level:2},{value:"\ud83d\udd17 \uad00\ub828 \ubb38\uc11c",id:"-\uad00\ub828-\ubb38\uc11c",level:2},{value:"\ud83c\udfaf \ub2e4\uc74c \ub2e8\uacc4",id:"-\ub2e4\uc74c-\ub2e8\uacc4",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"spa-\ud1b5\ud569",children:"SPA \ud1b5\ud569"})}),"\n",(0,s.jsx)(n.p,{children:"React, Vue, Angular \ub4f1 Single Page Application\uc5d0\uc11c OAuth 2.0 / OIDC\ub97c \uc548\uc804\ud558\uac8c \uad6c\ud604\ud558\ub294 \ubc29\ubc95\uc744 \ubc30\uc6c1\ub2c8\ub2e4."}),"\n",(0,s.jsx)(n.h2,{id:"-\ubaa9\ud45c",children:"\ud83c\udfaf \ubaa9\ud45c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 SPA OAuth \ubcf4\uc548 \uc774\ud574"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Authorization Code + PKCE \uad6c\ud604"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \ud1a0\ud070 \uc800\uc7a5 \uc804\ub7b5"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \uc790\ub3d9 \ud1a0\ud070 \uac31\uc2e0"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 API \ud638\ucd9c \ubcf4\uc548"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-spa\uc758-\ud2b9\uc218\uc131",children:"\u26a0\ufe0f SPA\uc758 \ud2b9\uc218\uc131"}),"\n",(0,s.jsx)(n.h3,{id:"\ubb38\uc81c\uc810",children:"\ubb38\uc81c\uc810"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// SPA\ub294 Public Client\nconst spa_challenges = {\n    "Client Secret \ubd88\uac00": "\ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c \uc2e4\ud589 \u2192 Secret \ub178\ucd9c \uc704\ud5d8",\n    "\ucf54\ub4dc \ub178\ucd9c": "JavaScript \uc18c\uc2a4 \ucf54\ub4dc \uacf5\uac1c",\n    "CORS": "Cross-Origin \uc694\uccad \ucc98\ub9ac \ud544\uc694",\n    "XSS \ucde8\uc57d": "JavaScript \uacf5\uaca9\uc5d0 \ub178\ucd9c",\n    "Token \uc800\uc7a5": "LocalStorage vs Cookie \uace0\ubbfc"\n};\n\n// \u2705 \ud574\uacb0\ucc45\nconst solutions = {\n    "PKCE": "Client Secret \uc5c6\uc774\ub3c4 \uc548\uc804",\n    "HttpOnly Cookie": "XSS \ubc29\uc9c0",\n    "Secure + SameSite": "CSRF \ubc29\uc9c0",\n    "BFF Pattern": "Backend For Frontend (\uc120\ud0dd)"\n};\n'})}),"\n",(0,s.jsx)(n.h2,{id:"-react--typescript-\uad6c\ud604",children:"\ud83d\udd27 React + TypeScript \uad6c\ud604"}),"\n",(0,s.jsx)(n.h3,{id:"1-\ud504\ub85c\uc81d\ud2b8-\uc124\uc815",children:"1. \ud504\ub85c\uc81d\ud2b8 \uc124\uc815"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Vite\ub85c React \ud504\ub85c\uc81d\ud2b8 \uc0dd\uc131\nnpm create vite@latest spa-oauth -- --template react-ts\ncd spa-oauth\nnpm install\n\n# OAuth \ub77c\uc774\ube0c\ub7ec\ub9ac \uc124\uce58\nnpm install axios @tanstack/react-query\nnpm install react-router-dom\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-oauth-\uc124\uc815",children:"2. OAuth \uc124\uc815"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// src/config/oauth.ts\nexport const oauthConfig = {\n    authorizationEndpoint: 'https://accounts.google.com/o/oauth2/v2/auth',\n    tokenEndpoint: 'https://oauth2.googleapis.com/token',\n    clientId: 'your-client-id.apps.googleusercontent.com',\n    redirectUri: window.location.origin + '/auth/callback',\n    scopes: ['openid', 'email', 'profile'],\n};\n\nexport const API_BASE_URL = 'http://localhost:8000';\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-pkce-\uc720\ud2f8\ub9ac\ud2f0",children:"3. PKCE \uc720\ud2f8\ub9ac\ud2f0"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// src/utils/pkce.ts\nexport class PKCEHelper {\n    /**\n     * Code Verifier \uc0dd\uc131\n     */\n    static generateCodeVerifier(): string {\n        const array = new Uint8Array(32);\n        crypto.getRandomValues(array);\n        return this.base64URLEncode(array);\n    }\n\n    /**\n     * Code Challenge \uc0dd\uc131\n     */\n    static async generateCodeChallenge(verifier: string): Promise<string> {\n        const encoder = new TextEncoder();\n        const data = encoder.encode(verifier);\n        const digest = await crypto.subtle.digest('SHA-256', data);\n        return this.base64URLEncode(new Uint8Array(digest));\n    }\n\n    /**\n     * Base64 URL \uc778\ucf54\ub529\n     */\n    private static base64URLEncode(buffer: Uint8Array): string {\n        const base64 = btoa(String.fromCharCode(...buffer));\n        return base64\n            .replace(/\\+/g, '-')\n            .replace(/\\//g, '_')\n            .replace(/=/g, '');\n    }\n\n    /**\n     * State \uc0dd\uc131 (CSRF \ubc29\uc9c0)\n     */\n    static generateState(): string {\n        const array = new Uint8Array(16);\n        crypto.getRandomValues(array);\n        return this.base64URLEncode(array);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-oauth-\ud6c5",children:"4. OAuth \ud6c5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// src/hooks/useOAuth.ts\nimport { useState, useEffect, useCallback } from 'react';\nimport { PKCEHelper } from '../utils/pkce';\nimport { oauthConfig } from '../config/oauth';\n\ninterface OAuthState {\n    isAuthenticated: boolean;\n    isLoading: boolean;\n    user: User | null;\n    error: string | null;\n}\n\ninterface User {\n    id: string;\n    email: string;\n    name: string;\n    picture: string;\n}\n\nexport const useOAuth = () => {\n    const [state, setState] = useState<OAuthState>({\n        isAuthenticated: false,\n        isLoading: true,\n        user: null,\n        error: null\n    });\n\n    /**\n     * \ub85c\uadf8\uc778 \uc2dc\uc791\n     */\n    const login = useCallback(async () => {\n        try {\n            // 1. Code Verifier \uc0dd\uc131\n            const codeVerifier = PKCEHelper.generateCodeVerifier();\n            sessionStorage.setItem('code_verifier', codeVerifier);\n\n            // 2. Code Challenge \uc0dd\uc131\n            const codeChallenge = await PKCEHelper.generateCodeChallenge(codeVerifier);\n\n            // 3. State \uc0dd\uc131\n            const state = PKCEHelper.generateState();\n            sessionStorage.setItem('oauth_state', state);\n\n            // 4. Authorization URL \uc0dd\uc131\n            const params = new URLSearchParams({\n                client_id: oauthConfig.clientId,\n                redirect_uri: oauthConfig.redirectUri,\n                response_type: 'code',\n                scope: oauthConfig.scopes.join(' '),\n                state: state,\n                code_challenge: codeChallenge,\n                code_challenge_method: 'S256'\n            });\n\n            const authUrl = `${oauthConfig.authorizationEndpoint}?${params}`;\n\n            // 5. Authorization Server\ub85c \ub9ac\ub2e4\uc774\ub809\ud2b8\n            window.location.href = authUrl;\n        } catch (error) {\n            setState(prev => ({\n                ...prev,\n                error: 'Failed to start login'\n            }));\n        }\n    }, []);\n\n    /**\n     * \ucf5c\ubc31 \ucc98\ub9ac\n     */\n    const handleCallback = useCallback(async (code: string, state: string) => {\n        try {\n            // 1. State \uac80\uc99d\n            const savedState = sessionStorage.getItem('oauth_state');\n            if (state !== savedState) {\n                throw new Error('Invalid state');\n            }\n\n            // 2. Code Verifier \uac00\uc838\uc624\uae30\n            const codeVerifier = sessionStorage.getItem('code_verifier');\n            if (!codeVerifier) {\n                throw new Error('Missing code verifier');\n            }\n\n            // 3. Token \uad50\ud658 (Backend Proxy\ub97c \ud1b5\ud574)\n            const response = await fetch(`${API_BASE_URL}/auth/token`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                credentials: 'include', // Cookie \ud3ec\ud568\n                body: JSON.stringify({\n                    code,\n                    code_verifier: codeVerifier,\n                    redirect_uri: oauthConfig.redirectUri\n                })\n            });\n\n            if (!response.ok) {\n                throw new Error('Token exchange failed');\n            }\n\n            // 4. \uc138\uc158 \uc815\ub9ac\n            sessionStorage.removeItem('code_verifier');\n            sessionStorage.removeItem('oauth_state');\n\n            // 5. \uc0ac\uc6a9\uc790 \uc815\ubcf4 \uac00\uc838\uc624\uae30\n            await fetchUser();\n\n        } catch (error) {\n            setState(prev => ({\n                ...prev,\n                error: error instanceof Error ? error.message : 'Login failed',\n                isLoading: false\n            }));\n        }\n    }, []);\n\n    /**\n     * \uc0ac\uc6a9\uc790 \uc815\ubcf4 \uac00\uc838\uc624\uae30\n     */\n    const fetchUser = useCallback(async () => {\n        try {\n            const response = await fetch(`${API_BASE_URL}/api/me`, {\n                credentials: 'include' // Cookie \ud3ec\ud568\n            });\n\n            if (response.ok) {\n                const user = await response.json();\n                setState({\n                    isAuthenticated: true,\n                    isLoading: false,\n                    user,\n                    error: null\n                });\n            } else {\n                setState(prev => ({\n                    ...prev,\n                    isAuthenticated: false,\n                    isLoading: false\n                }));\n            }\n        } catch (error) {\n            setState(prev => ({\n                ...prev,\n                isAuthenticated: false,\n                isLoading: false\n            }));\n        }\n    }, []);\n\n    /**\n     * \ub85c\uadf8\uc544\uc6c3\n     */\n    const logout = useCallback(async () => {\n        await fetch(`${API_BASE_URL}/auth/logout`, {\n            method: 'POST',\n            credentials: 'include'\n        });\n\n        setState({\n            isAuthenticated: false,\n            isLoading: false,\n            user: null,\n            error: null\n        });\n    }, []);\n\n    /**\n     * \ucd08\uae30\ud654\n     */\n    useEffect(() => {\n        fetchUser();\n    }, [fetchUser]);\n\n    return {\n        ...state,\n        login,\n        logout,\n        handleCallback\n    };\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"5-axios-\uc778\ud130\uc149\ud130",children:"5. Axios \uc778\ud130\uc149\ud130"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// src/api/axios.ts\nimport axios from 'axios';\nimport { API_BASE_URL } from '../config/oauth';\n\n// Axios \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131\nexport const api = axios.create({\n    baseURL: API_BASE_URL,\n    withCredentials: true, // Cookie \ud3ec\ud568\n    headers: {\n        'Content-Type': 'application/json'\n    }\n});\n\n// Response Interceptor (\uc790\ub3d9 \ud1a0\ud070 \uac31\uc2e0)\napi.interceptors.response.use(\n    response => response,\n    async error => {\n        const originalRequest = error.config;\n\n        // 401 \uc5d0\ub7ec && \uc7ac\uc2dc\ub3c4 \uc548 \ud588\uc73c\uba74\n        if (error.response?.status === 401 && !originalRequest._retry) {\n            originalRequest._retry = true;\n\n            try {\n                // Refresh Token\uc73c\ub85c \uac31\uc2e0\n                await axios.post(\n                    `${API_BASE_URL}/auth/refresh`,\n                    {},\n                    { withCredentials: true }\n                );\n\n                // \uc6d0\ub798 \uc694\uccad \uc7ac\uc2dc\ub3c4\n                return api(originalRequest);\n            } catch (refreshError) {\n                // Refresh \uc2e4\ud328 \u2192 \ub85c\uadf8\uc544\uc6c3\n                window.location.href = '/login';\n                return Promise.reject(refreshError);\n            }\n        }\n\n        return Promise.reject(error);\n    }\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"6-\ucf5c\ubc31-\ud398\uc774\uc9c0",children:"6. \ucf5c\ubc31 \ud398\uc774\uc9c0"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// src/pages/AuthCallback.tsx\nimport { useEffect } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { useOAuth } from '../hooks/useOAuth';\n\nexport const AuthCallback = () => {\n    const navigate = useNavigate();\n    const [searchParams] = useSearchParams();\n    const { handleCallback } = useOAuth();\n\n    useEffect(() => {\n        const code = searchParams.get('code');\n        const state = searchParams.get('state');\n        const error = searchParams.get('error');\n\n        if (error) {\n            console.error('OAuth error:', error);\n            navigate('/login?error=' + error);\n            return;\n        }\n\n        if (code && state) {\n            handleCallback(code, state).then(() => {\n                navigate('/');\n            });\n        } else {\n            navigate('/login');\n        }\n    }, [searchParams, handleCallback, navigate]);\n\n    return (\n        <div style={{ textAlign: 'center', marginTop: '100px' }}>\n            <h2>\ub85c\uadf8\uc778 \ucc98\ub9ac \uc911...</h2>\n            <p>\uc7a0\uc2dc\ub9cc \uae30\ub2e4\ub824\uc8fc\uc138\uc694.</p>\n        </div>\n    );\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"7-\uba54\uc778-\uc571",children:"7. \uba54\uc778 \uc571"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// src/App.tsx\nimport { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';\nimport { useOAuth } from './hooks/useOAuth';\nimport { AuthCallback } from './pages/AuthCallback';\n\nconst LoginPage = () => {\n    const { login } = useOAuth();\n\n    return (\n        <div style={{ textAlign: 'center', marginTop: '100px' }}>\n            <h1>OAuth SPA Demo</h1>\n            <button\n                onClick={login}\n                style={{\n                    padding: '12px 24px',\n                    fontSize: '16px',\n                    backgroundColor: '#4285f4',\n                    color: 'white',\n                    border: 'none',\n                    borderRadius: '4px',\n                    cursor: 'pointer'\n                }}\n            >\n                Google\ub85c \ub85c\uadf8\uc778\n            </button>\n        </div>\n    );\n};\n\nconst HomePage = () => {\n    const { user, logout } = useOAuth();\n\n    return (\n        <div style={{ padding: '40px' }}>\n            <h1>\ud658\uc601\ud569\ub2c8\ub2e4!</h1>\n            {user && (\n                <div>\n                    <img src={user.picture} alt={user.name} width=\"80\" style={{ borderRadius: '50%' }} />\n                    <h2>{user.name}</h2>\n                    <p>{user.email}</p>\n                </div>\n            )}\n            <button onClick={logout}>\ub85c\uadf8\uc544\uc6c3</button>\n        </div>\n    );\n};\n\nconst ProtectedRoute = ({ children }: { children: React.ReactNode }) => {\n    const { isAuthenticated, isLoading } = useOAuth();\n\n    if (isLoading) {\n        return <div>Loading...</div>;\n    }\n\n    return isAuthenticated ? <>{children}</> : <Navigate to=\"/login\" />;\n};\n\nexport const App = () => {\n    return (\n        <BrowserRouter>\n            <Routes>\n                <Route path=\"/login\" element={<LoginPage />} />\n                <Route path=\"/auth/callback\" element={<AuthCallback />} />\n                <Route\n                    path=\"/\"\n                    element={\n                        <ProtectedRoute>\n                            <HomePage />\n                        </ProtectedRoute>\n                    }\n                />\n            </Routes>\n        </BrowserRouter>\n    );\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-\ubc31\uc5d4\ub4dc-token-proxy",children:"\ud83d\udd10 \ubc31\uc5d4\ub4dc (Token Proxy)"}),"\n",(0,s.jsx)(n.h3,{id:"fastapi-\ubc31\uc5d4\ub4dc",children:"FastAPI \ubc31\uc5d4\ub4dc"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from fastapi import FastAPI, Request, Response, HTTPException\nfrom fastapi.middleware.cors import CORSMiddleware\nimport httpx\n\napp = FastAPI()\n\n# CORS \uc124\uc815\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"http://localhost:3000\"],  # Frontend URL\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\n@app.post(\"/auth/token\")\nasync def token_proxy(request: Request, response: Response):\n    \"\"\"Token Exchange Proxy\"\"\"\n\n    body = await request.json()\n    code = body.get('code')\n    code_verifier = body.get('code_verifier')\n    redirect_uri = body.get('redirect_uri')\n\n    # Google Token Endpoint\ub85c \uc694\uccad\n    async with httpx.AsyncClient() as client:\n        token_response = await client.post(\n            'https://oauth2.googleapis.com/token',\n            data={\n                'grant_type': 'authorization_code',\n                'code': code,\n                'redirect_uri': redirect_uri,\n                'client_id': GOOGLE_CLIENT_ID,\n                'client_secret': GOOGLE_CLIENT_SECRET,  # Backend\uc5d0\uc11c\ub9cc!\n                'code_verifier': code_verifier\n            }\n        )\n\n        if token_response.status_code != 200:\n            raise HTTPException(status_code=400, detail=\"Token exchange failed\")\n\n        tokens = token_response.json()\n\n    # HttpOnly Cookie\uc5d0 \uc800\uc7a5\n    response.set_cookie(\n        key=\"access_token\",\n        value=tokens['access_token'],\n        httponly=True,\n        secure=True,  # HTTPS\n        samesite='lax',\n        max_age=tokens.get('expires_in', 3600)\n    )\n\n    if 'refresh_token' in tokens:\n        response.set_cookie(\n            key=\"refresh_token\",\n            value=tokens['refresh_token'],\n            httponly=True,\n            secure=True,\n            samesite='lax',\n            max_age=2592000  # 30\uc77c\n        )\n\n    return {\"status\": \"ok\"}\n\n@app.post(\"/auth/refresh\")\nasync def refresh_proxy(request: Request, response: Response):\n    \"\"\"Refresh Token Proxy\"\"\"\n\n    refresh_token = request.cookies.get('refresh_token')\n    if not refresh_token:\n        raise HTTPException(status_code=401)\n\n    async with httpx.AsyncClient() as client:\n        token_response = await client.post(\n            'https://oauth2.googleapis.com/token',\n            data={\n                'grant_type': 'refresh_token',\n                'refresh_token': refresh_token,\n                'client_id': GOOGLE_CLIENT_ID,\n                'client_secret': GOOGLE_CLIENT_SECRET\n            }\n        )\n\n        if token_response.status_code != 200:\n            raise HTTPException(status_code=401)\n\n        tokens = token_response.json()\n\n    # \uc0c8 Access Token \uc800\uc7a5\n    response.set_cookie(\n        key=\"access_token\",\n        value=tokens['access_token'],\n        httponly=True,\n        secure=True,\n        samesite='lax',\n        max_age=tokens.get('expires_in', 3600)\n    )\n\n    return {\"status\": \"ok\"}\n\n@app.get(\"/api/me\")\nasync def get_me(request: Request):\n    \"\"\"\ud604\uc7ac \uc0ac\uc6a9\uc790 \uc815\ubcf4\"\"\"\n\n    access_token = request.cookies.get('access_token')\n    if not access_token:\n        raise HTTPException(status_code=401)\n\n    # UserInfo Endpoint \ud638\ucd9c\n    async with httpx.AsyncClient() as client:\n        user_response = await client.get(\n            'https://www.googleapis.com/oauth2/v2/userinfo',\n            headers={'Authorization': f'Bearer {access_token}'}\n        )\n\n        if user_response.status_code != 200:\n            raise HTTPException(status_code=401)\n\n        return user_response.json()\n\n@app.post(\"/auth/logout\")\nasync def logout(response: Response):\n    \"\"\"\ub85c\uadf8\uc544\uc6c3\"\"\"\n\n    response.delete_cookie(\"access_token\")\n    response.delete_cookie(\"refresh_token\")\n\n    return {\"status\": \"ok\"}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-bff-pattern-\uc120\ud0dd",children:"\ud83c\udfa8 BFF Pattern (\uc120\ud0dd)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Frontend (SPA)\n     \u2193\nBackend For Frontend (BFF)\n     \u2193\nOAuth Provider / Resource Server\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\uc7a5\uc810:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Client Secret \uc548\uc804\ud558\uac8c \ubcf4\uad00"}),"\n",(0,s.jsx)(n.li,{children:"\ud1a0\ud070\uc744 HttpOnly Cookie\uc5d0 \uc800\uc7a5 (XSS \ubc29\uc9c0)"}),"\n",(0,s.jsx)(n.li,{children:"CORS \uc774\uc288 \uc5c6\uc74c"}),"\n",(0,s.jsx)(n.li,{children:"\ucd94\uac00 \ubcf4\uc548 \ub808\uc774\uc5b4"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\ub2e8\uc810:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\ucd94\uac00 \uc11c\ubc84 \ud544\uc694"}),"\n",(0,s.jsx)(n.li,{children:"\ubcf5\uc7a1\ub3c4 \uc99d\uac00"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-\uad00\ub828-\ubb38\uc11c",children:"\ud83d\udd17 \uad00\ub828 \ubb38\uc11c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../advanced/pkce",children:"PKCE \uad6c\ud604"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../advanced/security",children:"\ubcf4\uc548 Best Practices"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"./social-login",children:"\uc18c\uc15c \ub85c\uadf8\uc778"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-\ub2e4\uc74c-\ub2e8\uacc4",children:"\ud83c\udfaf \ub2e4\uc74c \ub2e8\uacc4"}),"\n",(0,s.jsx)(n.p,{children:"SPA \ud1b5\ud569\uc744 \ub9c8\uc2a4\ud130\ud588\ub2e4\uba74, \uc774\uc81c \ubaa8\ubc14\uc77c \uc571 OAuth\ub97c \ubc30\uc6cc\ubd05\uc2dc\ub2e4!"}),"\n",(0,s.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,s.jsx)(n.a,{href:"./mobile-app",children:"\ubaa8\ubc14\uc77c \uc571 OAuth"})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\ud83d\udca1 \ud301"}),": SPA\uc5d0\uc11c\ub294 \ubc18\ub4dc\uc2dc PKCE\ub97c \uc0ac\uc6a9\ud558\uace0, \uac00\ub2a5\ud558\uba74 BFF \ud328\ud134\uc73c\ub85c Client Secret\uc744 \ubcf4\ud638\ud558\uc138\uc694!"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var r=t(6540);const s={},o=r.createContext(s);function a(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);