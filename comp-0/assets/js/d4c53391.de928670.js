"use strict";(globalThis.webpackChunkgithub_docs=globalThis.webpackChunkgithub_docs||[]).push([[5927],{2056:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"alembic/examples/scenario-02-schema-evolution","title":"\uc2dc\ub098\ub9ac\uc624 2: \uc218\uc9c4\uc758 \uae30\ub2a5 \ucd94\uac00","description":"\uc774\ucee4\uba38\uc2a4 \uc11c\ube44\uc2a4\uc5d0 \ub9ac\ubdf0 \uae30\ub2a5\uc744 \ucd94\uac00\ud558\ub294 \uc218\uc9c4\uc758 \uc774\uc57c\uae30\uc785\ub2c8\ub2e4.","source":"@site/docs/alembic/examples/scenario-02-schema-evolution.md","sourceDirName":"alembic/examples","slug":"/alembic/examples/scenario-02-schema-evolution","permalink":"/docs/alembic/examples/scenario-02-schema-evolution","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/alembic/examples/scenario-02-schema-evolution.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"alembicSidebar","previous":{"title":"\uc2dc\ub098\ub9ac\uc624 1: \uc9c0\uc6b0\uc758 \uccab \ud504\ub85c\uc81d\ud2b8","permalink":"/docs/alembic/examples/scenario-01-new-project"},"next":{"title":"\uc2dc\ub098\ub9ac\uc624 3: \ubbfc\ud638\uc640 \uc218\uc9c4\uc758 \ucda9\ub3cc \ud574\uacb0","permalink":"/docs/alembic/examples/scenario-03-team-conflict"}}');var a=i(4848),l=i(8453);const s={sidebar_position:3},d="\uc2dc\ub098\ub9ac\uc624 2: \uc218\uc9c4\uc758 \uae30\ub2a5 \ucd94\uac00",t={},c=[{value:"\ud83d\udccc \uc0c1\ud669 \uc124\uba85",id:"-\uc0c1\ud669-\uc124\uba85",level:2},{value:"\ud83c\udfaf \ubaa9\ud45c",id:"-\ubaa9\ud45c",level:2},{value:"\ud83d\udcac \ub300\ud654",id:"-\ub300\ud654",level:2},{value:"\u26a1 \uc2e4\uc2b5",id:"-\uc2e4\uc2b5",level:2},{value:"1\ub2e8\uacc4: \uc694\uad6c\uc0ac\ud56d \ubd84\uc11d",id:"1\ub2e8\uacc4-\uc694\uad6c\uc0ac\ud56d-\ubd84\uc11d",level:3},{value:"2\ub2e8\uacc4: SQLAlchemy \ubaa8\ub378 \uc218\uc815",id:"2\ub2e8\uacc4-sqlalchemy-\ubaa8\ub378-\uc218\uc815",level:3},{value:"3\ub2e8\uacc4: Autogenerate\ub85c \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uc0dd\uc131",id:"3\ub2e8\uacc4-autogenerate\ub85c-\ub9c8\uc774\uadf8\ub808\uc774\uc158-\uc0dd\uc131",level:3},{value:"4\ub2e8\uacc4: \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uac80\ud1a0 \ubc0f \uc218\uc815",id:"4\ub2e8\uacc4-\ub9c8\uc774\uadf8\ub808\uc774\uc158-\uac80\ud1a0-\ubc0f-\uc218\uc815",level:3},{value:"5\ub2e8\uacc4: \ub85c\uceec \ud14c\uc2a4\ud2b8",id:"5\ub2e8\uacc4-\ub85c\uceec-\ud14c\uc2a4\ud2b8",level:3},{value:"6\ub2e8\uacc4: \ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc \ud14c\uc2a4\ud2b8",id:"6\ub2e8\uacc4-\ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc-\ud14c\uc2a4\ud2b8",level:3},{value:"7\ub2e8\uacc4: \ud14c\uc2a4\ud2b8 \ub370\uc774\ud130 \uc0dd\uc131",id:"7\ub2e8\uacc4-\ud14c\uc2a4\ud2b8-\ub370\uc774\ud130-\uc0dd\uc131",level:3},{value:"8\ub2e8\uacc4: \ucd94\uac00 \uae30\ub2a5 - \uc778\ub371\uc2a4 \ucd5c\uc801\ud654",id:"8\ub2e8\uacc4-\ucd94\uac00-\uae30\ub2a5---\uc778\ub371\uc2a4-\ucd5c\uc801\ud654",level:3},{value:"9\ub2e8\uacc4: Git \ucee4\ubc0b",id:"9\ub2e8\uacc4-git-\ucee4\ubc0b",level:3},{value:"\u2705 \uac80\uc99d",id:"-\uac80\uc99d",level:2},{value:"\ud83c\udf93 \ubc30\uc6b4 \ub0b4\uc6a9",id:"-\ubc30\uc6b4-\ub0b4\uc6a9",level:2},{value:"Autogenerate \ud65c\uc6a9",id:"autogenerate-\ud65c\uc6a9",level:3},{value:"\uc2a4\ud0a4\ub9c8 \uc9c4\ud654 \ud328\ud134",id:"\uc2a4\ud0a4\ub9c8-\uc9c4\ud654-\ud328\ud134",level:3},{value:"\ub9c8\uc774\uadf8\ub808\uc774\uc158 \ubd84\ub9ac",id:"\ub9c8\uc774\uadf8\ub808\uc774\uc158-\ubd84\ub9ac",level:3},{value:"\ud83d\udca1 \uc2e4\uc804 \ud301",id:"-\uc2e4\uc804-\ud301",level:2},{value:"1. \uad00\uacc4(Relationship) \uc124\uc815",id:"1-\uad00\uacc4relationship-\uc124\uc815",level:3},{value:"2. JSON \uceec\ub7fc \ud65c\uc6a9 (PostgreSQL)",id:"2-json-\uceec\ub7fc-\ud65c\uc6a9-postgresql",level:3},{value:"3. \uc81c\uc57d\uc870\uac74 \ub124\uc774\ubc0d",id:"3-\uc81c\uc57d\uc870\uac74-\ub124\uc774\ubc0d",level:3},{value:"\ud83d\udea8 \uc8fc\uc758\uc0ac\ud56d",id:"-\uc8fc\uc758\uc0ac\ud56d",level:2},{value:"1. \uae30\uc874 \ub370\uc774\ud130 \uace0\ub824",id:"1-\uae30\uc874-\ub370\uc774\ud130-\uace0\ub824",level:3},{value:"2. \uc678\ub798 \ud0a4 \uc0ad\uc81c \uc635\uc158",id:"2-\uc678\ub798-\ud0a4-\uc0ad\uc81c-\uc635\uc158",level:3},{value:"\ud83d\udcca \uc131\ub2a5 \uace0\ub824\uc0ac\ud56d",id:"-\uc131\ub2a5-\uace0\ub824\uc0ac\ud56d",level:2},{value:"\ubcf5\ud569 \uc778\ub371\uc2a4 \uc21c\uc11c",id:"\ubcf5\ud569-\uc778\ub371\uc2a4-\uc21c\uc11c",level:3},{value:"\ud83d\udd17 \uad00\ub828 \ubb38\uc11c",id:"-\uad00\ub828-\ubb38\uc11c",level:2},{value:"\ud83c\udfaf \ub2e4\uc74c \uc2dc\ub098\ub9ac\uc624",id:"-\ub2e4\uc74c-\uc2dc\ub098\ub9ac\uc624",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"\uc2dc\ub098\ub9ac\uc624-2-\uc218\uc9c4\uc758-\uae30\ub2a5-\ucd94\uac00",children:"\uc2dc\ub098\ub9ac\uc624 2: \uc218\uc9c4\uc758 \uae30\ub2a5 \ucd94\uac00"})}),"\n",(0,a.jsx)(n.p,{children:"\uc774\ucee4\uba38\uc2a4 \uc11c\ube44\uc2a4\uc5d0 \ub9ac\ubdf0 \uae30\ub2a5\uc744 \ucd94\uac00\ud558\ub294 \uc218\uc9c4\uc758 \uc774\uc57c\uae30\uc785\ub2c8\ub2e4."}),"\n",(0,a.jsx)(n.h2,{id:"-\uc0c1\ud669-\uc124\uba85",children:"\ud83d\udccc \uc0c1\ud669 \uc124\uba85"}),"\n",(0,a.jsx)(n.p,{children:"\uc218\uc9c4\uc740 \uc628\ub77c\uc778 \uc1fc\ud551\ubab0 '\ub9c8\ucf13\ud50c\ub808\uc774\uc2a4'\uc758 \ubc31\uc5d4\ub4dc \uac1c\ubc1c\uc790\uc785\ub2c8\ub2e4. PM\uc73c\ub85c\ubd80\ud130 \"\uace0\uac1d\ub4e4\uc774 \uc81c\ud488 \ub9ac\ubdf0\ub97c \ub0a8\uae38 \uc218 \uc788\ub294 \uae30\ub2a5\uc774 \ud544\uc694\ud558\ub2e4\"\ub294 \uc694\uccad\uc744 \ubc1b\uc558\uc2b5\ub2c8\ub2e4. \uae30\uc874 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc0c8\ub85c\uc6b4 \ud14c\uc774\ube14\uc744 \ucd94\uac00\ud558\uace0, \uae30\uc874 \ud14c\uc774\ube14\ub3c4 \uc218\uc815\ud574\uc57c \ud569\ub2c8\ub2e4."}),"\n",(0,a.jsx)(n.h2,{id:"-\ubaa9\ud45c",children:"\ud83c\udfaf \ubaa9\ud45c"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\uae30\uc874 \uc2a4\ud0a4\ub9c8\uc5d0 \uc0c8 \ud14c\uc774\ube14 \ucd94\uac00"}),"\n",(0,a.jsx)(n.li,{children:"\uae30\uc874 \ud14c\uc774\ube14\uc5d0 \uceec\ub7fc \ucd94\uac00"}),"\n",(0,a.jsx)(n.li,{children:"autogenerate \ud65c\uc6a9"}),"\n",(0,a.jsx)(n.li,{children:"\uc5ec\ub7ec \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uad00\ub9ac"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"-\ub300\ud654",children:"\ud83d\udcac \ub300\ud654"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"PM \uc9c0\ud6c8"}),': "\uc218\uc9c4\ub2d8, \uc774\ubc88 \uc2a4\ud504\ub9b0\ud2b8\uc5d0\ub294 \ub9ac\ubdf0 \uae30\ub2a5\uc744 \ucd94\uac00\ud574\uc57c \ud574\uc694. \uace0\uac1d\ub4e4\uc774 \ubcc4\uc810\uacfc \ub9ac\ubdf0\ub97c \ub0a8\uae38 \uc218 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4."']}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\uc218\uc9c4"}),': "\uc54c\uaca0\uc2b5\ub2c8\ub2e4! \uc5b4\ub5a4 \uc815\ubcf4\ub4e4\uc774 \ud544\uc694\ud55c\uac00\uc694?"']}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\uc9c0\ud6c8"}),': "\uace0\uac1d\uc774 \uc81c\ud488\uc5d0 \ub300\ud574 \ubcc4\uc810(1-5), \ub9ac\ubdf0 \ud14d\uc2a4\ud2b8, \uadf8\ub9ac\uace0 \uc0ac\uc9c4\ub3c4 \uc62c\ub9b4 \uc218 \uc788\uc73c\uba74 \uc88b\uaca0\uc5b4\uc694. \uc544, \uadf8\ub9ac\uace0 \uc81c\ud488 \ud14c\uc774\ube14\uc5d0\ub3c4 \ud3c9\uade0 \ubcc4\uc810\uacfc \ub9ac\ubdf0 \uc218\ub97c \uc800\uc7a5\ud558\uba74 \uc131\ub2a5\uc5d0 \uc88b\uc744 \uac83 \uac19\uc544\uc694."']}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\uc218\uc9c4"}),': "\uc88b\uc544\uc694! \uadf8\ub7fc reviews \ud14c\uc774\ube14\uc744 \ub9cc\ub4e4\uace0, products \ud14c\uc774\ube14\uc5d0 \uceec\ub7fc\uc744 \ucd94\uac00\ud558\uba74 \ub418\uaca0\ub124\uc694."']}),"\n",(0,a.jsx)(n.h2,{id:"-\uc2e4\uc2b5",children:"\u26a1 \uc2e4\uc2b5"}),"\n",(0,a.jsx)(n.h3,{id:"1\ub2e8\uacc4-\uc694\uad6c\uc0ac\ud56d-\ubd84\uc11d",children:"1\ub2e8\uacc4: \uc694\uad6c\uc0ac\ud56d \ubd84\uc11d"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\uc218\uc9c4\uc758 \uba54\ubaa8"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"\ud544\uc694\ud55c \ubcc0\uacbd\uc0ac\ud56d:\n1. reviews \ud14c\uc774\ube14 \uc0dd\uc131\n   - \ub9ac\ubdf0 ID, \uc81c\ud488 ID, \uc0ac\uc6a9\uc790 ID\n   - \ubcc4\uc810, \ub9ac\ubdf0 \ub0b4\uc6a9, \uc774\ubbf8\uc9c0 URL\n   - \uc791\uc131\uc77c\uc2dc\n\n2. products \ud14c\uc774\ube14 \uc218\uc815\n   - average_rating \uceec\ub7fc \ucd94\uac00\n   - review_count \uceec\ub7fc \ucd94\uac00\n\n3. \uc81c\uc57d\uc870\uac74\n   - \ubcc4\uc810\uc740 1~5 \uc0ac\uc774\n   - \ud55c \uc0ac\uc6a9\uc790\uac00 \uac19\uc740 \uc81c\ud488\uc5d0 \uc5ec\ub7ec \ub9ac\ubdf0 \ubd88\uac00\n"})}),"\n",(0,a.jsx)(n.h3,{id:"2\ub2e8\uacc4-sqlalchemy-\ubaa8\ub378-\uc218\uc815",children:"2\ub2e8\uacc4: SQLAlchemy \ubaa8\ub378 \uc218\uc815"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# models.py - \uae30\uc874 Product \ubaa8\ub378 \uc218\uc815\nclass Product(Base):\n    __tablename__ = 'products'\n\n    id = Column(Integer, primary_key=True, index=True)\n    name = Column(String(200), nullable=False)\n    description = Column(Text)\n    price = Column(Numeric(10, 2), nullable=False)\n    stock = Column(Integer, default=0)\n    category_id = Column(Integer, ForeignKey('categories.id'))\n\n    # \uc0c8\ub85c \ucd94\uac00\ub41c \uceec\ub7fc\ub4e4\n    average_rating = Column(Numeric(3, 2), default=0.0)\n    review_count = Column(Integer, default=0)\n\n    created_at = Column(DateTime, default=datetime.utcnow)\n    updated_at = Column(DateTime, onupdate=datetime.utcnow)\n\n    # \uad00\uacc4 \ucd94\uac00\n    reviews = relationship('Review', back_populates='product')\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# models.py - \uc0c8\ub85c\uc6b4 Review \ubaa8\ub378 \ucd94\uac00\nclass Review(Base):\n    __tablename__ = 'reviews'\n\n    id = Column(Integer, primary_key=True, index=True)\n    product_id = Column(Integer, ForeignKey('products.id', ondelete='CASCADE'), nullable=False)\n    user_id = Column(Integer, ForeignKey('users.id', ondelete='CASCADE'), nullable=False)\n\n    rating = Column(Integer, nullable=False)  # 1-5\n    title = Column(String(200))\n    content = Column(Text, nullable=False)\n    images = Column(JSON)  # \uc774\ubbf8\uc9c0 URL \ubc30\uc5f4\n\n    is_verified_purchase = Column(Boolean, default=False)\n    helpful_count = Column(Integer, default=0)\n\n    created_at = Column(DateTime, default=datetime.utcnow)\n    updated_at = Column(DateTime, onupdate=datetime.utcnow)\n\n    # \uad00\uacc4\n    product = relationship('Product', back_populates='reviews')\n    user = relationship('User', back_populates='reviews')\n\n    # \ud14c\uc774\ube14 \uc218\uc900 \uc81c\uc57d\uc870\uac74\n    __table_args__ = (\n        CheckConstraint('rating >= 1 AND rating <= 5', name='check_rating_range'),\n        UniqueConstraint('product_id', 'user_id', name='uq_product_user_review'),\n    )\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# models.py - User \ubaa8\ub378\uc5d0 \uad00\uacc4 \ucd94\uac00\nclass User(Base):\n    __tablename__ = 'users'\n    # ... \uae30\uc874 \ud544\ub4dc\ub4e4\n    reviews = relationship('Review', back_populates='user')\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\uc218\uc9c4"}),': "\ubaa8\ub378 \uc900\ube44 \uc644\ub8cc! \uc774\uc81c \ub9c8\uc774\uadf8\ub808\uc774\uc158\uc744 \ub9cc\ub4e4\uc5b4\ubcfc\uae4c?"']}),"\n",(0,a.jsx)(n.h3,{id:"3\ub2e8\uacc4-autogenerate\ub85c-\ub9c8\uc774\uadf8\ub808\uc774\uc158-\uc0dd\uc131",children:"3\ub2e8\uacc4: Autogenerate\ub85c \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uc0dd\uc131"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# \ucd5c\uc2e0 \uc0c1\ud0dc\ub85c \uc5c5\ub370\uc774\ud2b8\ngit pull origin main\nalembic upgrade head\n\n# \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uc790\ub3d9 \uc0dd\uc131\nalembic revision --autogenerate -m "add reviews table and rating fields to products"\n'})}),"\n",(0,a.jsx)(n.p,{children:"\uc0dd\uc131\ub41c \ud30c\uc77c \ud655\uc778:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"\"\"\"add reviews table and rating fields to products\n\nRevision ID: def789\nRevises: abc123\nCreate Date: 2024-01-21 14:30:00.123456\n\"\"\"\n\ndef upgrade():\n    # Reviews \ud14c\uc774\ube14 \uc0dd\uc131\n    op.create_table('reviews',\n        sa.Column('id', sa.Integer(), nullable=False),\n        sa.Column('product_id', sa.Integer(), nullable=False),\n        sa.Column('user_id', sa.Integer(), nullable=False),\n        sa.Column('rating', sa.Integer(), nullable=False),\n        sa.Column('title', sa.String(length=200), nullable=True),\n        sa.Column('content', sa.Text(), nullable=False),\n        sa.Column('images', sa.JSON(), nullable=True),\n        sa.Column('is_verified_purchase', sa.Boolean(), nullable=True),\n        sa.Column('helpful_count', sa.Integer(), nullable=True),\n        sa.Column('created_at', sa.DateTime(), nullable=True),\n        sa.Column('updated_at', sa.DateTime(), nullable=True),\n        sa.CheckConstraint('rating >= 1 AND rating <= 5', name='check_rating_range'),\n        sa.ForeignKeyConstraint(['product_id'], ['products.id'], ondelete='CASCADE'),\n        sa.ForeignKeyConstraint(['user_id'], ['users.id'], ondelete='CASCADE'),\n        sa.PrimaryKeyConstraint('id'),\n        sa.UniqueConstraint('product_id', 'user_id', name='uq_product_user_review')\n    )\n    op.create_index(op.f('ix_reviews_id'), 'reviews', ['id'], unique=False)\n\n    # Products \ud14c\uc774\ube14\uc5d0 \uceec\ub7fc \ucd94\uac00\n    op.add_column('products', sa.Column('average_rating', sa.Numeric(precision=3, scale=2), nullable=True))\n    op.add_column('products', sa.Column('review_count', sa.Integer(), nullable=True))\n\ndef downgrade():\n    op.drop_column('products', 'review_count')\n    op.drop_column('products', 'average_rating')\n    op.drop_index(op.f('ix_reviews_id'), table_name='reviews')\n    op.drop_table('reviews')\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\uc218\uc9c4"}),': "\uc640, Alembic\uc774 \ubaa8\ub4e0 \ubcc0\uacbd\uc0ac\ud56d\uc744 \uc790\ub3d9\uc73c\ub85c \uac10\uc9c0\ud588\ub124\uc694!"']}),"\n",(0,a.jsx)(n.h3,{id:"4\ub2e8\uacc4-\ub9c8\uc774\uadf8\ub808\uc774\uc158-\uac80\ud1a0-\ubc0f-\uc218\uc815",children:"4\ub2e8\uacc4: \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uac80\ud1a0 \ubc0f \uc218\uc815"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\uc218\uc9c4"}),': "\uc7a0\uae50, products \ud14c\uc774\ube14\uc758 \uc0c8 \uceec\ub7fc\ub4e4\uc740 \uae30\ubcf8\uac12\uc744 \uc124\uc815\ud574\uc57c\uaca0\uc5b4\uc694."']}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud30c\uc77c \uc218\uc815\ndef upgrade():\n    # ... reviews \ud14c\uc774\ube14 \uc0dd\uc131 \ucf54\ub4dc\n\n    # Products \ud14c\uc774\ube14\uc5d0 \uceec\ub7fc \ucd94\uac00 (\uae30\ubcf8\uac12 \uc124\uc815)\n    op.add_column('products',\n        sa.Column('average_rating', sa.Numeric(precision=3, scale=2),\n                  server_default='0.0', nullable=False))\n    op.add_column('products',\n        sa.Column('review_count', sa.Integer(),\n                  server_default='0', nullable=False))\n"})}),"\n",(0,a.jsx)(n.h3,{id:"5\ub2e8\uacc4-\ub85c\uceec-\ud14c\uc2a4\ud2b8",children:"5\ub2e8\uacc4: \ub85c\uceec \ud14c\uc2a4\ud2b8"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uc2e4\ud589\nalembic upgrade head\n\n# \ucd9c\ub825:\n# INFO  [alembic.runtime.migration] Running upgrade abc123 -> def789, add reviews table and rating fields to products\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ud655\uc778\npsql -d marketplace_dev\n\n\\d reviews\n#                                Table \"public.reviews\"\n#      Column         |       Type        | Collation | Nullable |      Default\n# --------------------+-------------------+-----------+----------+-------------------\n#  id                 | integer           |           | not null | nextval('reviews_id_seq')\n#  product_id         | integer           |           | not null |\n#  user_id            | integer           |           | not null |\n#  rating             | integer           |           | not null |\n#  ...\n\n\\d products\n# average_rating      | numeric(3,2)      |           | not null | 0.0\n# review_count        | integer           |           | not null | 0\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\uc218\uc9c4"}),': "\uc644\ubcbd\ud574\uc694! \ud14c\uc774\ube14\uacfc \uceec\ub7fc\uc774 \ubaa8\ub450 \uc0dd\uc131\ub418\uc5c8\ub124\uc694."']}),"\n",(0,a.jsx)(n.h3,{id:"6\ub2e8\uacc4-\ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc-\ud14c\uc2a4\ud2b8",children:"6\ub2e8\uacc4: \ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc \ud14c\uc2a4\ud2b8"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# \ub864\ubc31 \ud14c\uc2a4\ud2b8\nalembic downgrade -1\n\n# \ud655\uc778\npsql -d marketplace_dev -c "\\dt reviews"\n# Did not find any relation named "reviews"\n\n# \ub2e4\uc2dc \uc5c5\uadf8\ub808\uc774\ub4dc\nalembic upgrade head\n'})}),"\n",(0,a.jsx)(n.h3,{id:"7\ub2e8\uacc4-\ud14c\uc2a4\ud2b8-\ub370\uc774\ud130-\uc0dd\uc131",children:"7\ub2e8\uacc4: \ud14c\uc2a4\ud2b8 \ub370\uc774\ud130 \uc0dd\uc131"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# test_reviews.py\nfrom models import Product, Review, User\nfrom database import SessionLocal\n\ndb = SessionLocal()\n\n# \ud14c\uc2a4\ud2b8 \uc0ac\uc6a9\uc790\uc640 \uc81c\ud488 \uc0dd\uc131\nuser = User(username='testuser', email='test@example.com', password_hash='hashed')\nproduct = Product(name='\ud14c\uc2a4\ud2b8 \uc0c1\ud488', price=10000, stock=100)\n\ndb.add(user)\ndb.add(product)\ndb.commit()\n\n# \ub9ac\ubdf0 \uc0dd\uc131\nreview = Review(\n    product_id=product.id,\n    user_id=user.id,\n    rating=5,\n    title='\uc815\ub9d0 \uc88b\uc544\uc694!',\n    content='\ubc30\uc1a1\ub3c4 \ube60\ub974\uace0 \ud488\uc9c8\ub3c4 \uc88b\uc2b5\ub2c8\ub2e4.',\n    is_verified_purchase=True\n)\n\ndb.add(review)\ndb.commit()\n\n# \uc81c\ud488 \ud3c9\uc810 \uc5c5\ub370\uc774\ud2b8\nproduct.average_rating = 5.0\nproduct.review_count = 1\ndb.commit()\n\nprint(f\"\ub9ac\ubdf0 \uc0dd\uc131 \uc644\ub8cc: {review.id}\")\nprint(f\"\uc81c\ud488 \ud3c9\uc810: {product.average_rating} ({product.review_count}\uac1c)\")\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"python test_reviews.py\n# \ub9ac\ubdf0 \uc0dd\uc131 \uc644\ub8cc: 1\n# \uc81c\ud488 \ud3c9\uc810: 5.0 (1\uac1c)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"8\ub2e8\uacc4-\ucd94\uac00-\uae30\ub2a5---\uc778\ub371\uc2a4-\ucd5c\uc801\ud654",children:"8\ub2e8\uacc4: \ucd94\uac00 \uae30\ub2a5 - \uc778\ub371\uc2a4 \ucd5c\uc801\ud654"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\uc218\uc9c4"}),': "\ub9ac\ubdf0\uac00 \ub9ce\uc544\uc9c0\uba74 \uc870\ud68c \uc131\ub2a5\uc774 \uc911\uc694\ud560 \uac83 \uac19\uc544\uc694. \uc778\ub371\uc2a4\ub97c \ucd94\uac00\ud574\uc57c\uaca0\uc5b4\uc694."']}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'alembic revision -m "add indexes for review queries"\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"\"\"\"add indexes for review queries\n\nRevision ID: ghi012\nRevises: def789\n\"\"\"\n\ndef upgrade():\n    # \uc81c\ud488\ubcc4 \ub9ac\ubdf0 \uc870\ud68c\uc6a9\n    op.create_index('idx_reviews_product_created', 'reviews',\n                    ['product_id', 'created_at'])\n\n    # \uc0ac\uc6a9\uc790\ubcc4 \ub9ac\ubdf0 \uc870\ud68c\uc6a9\n    op.create_index('idx_reviews_user', 'reviews', ['user_id'])\n\n    # \ub192\uc740 \ud3c9\uc810 \ub9ac\ubdf0 \ud544\ud130\ub9c1\uc6a9\n    op.create_index('idx_reviews_rating', 'reviews', ['rating'])\n\n    # \uc81c\ud488 \ud3c9\uc810 \uc815\ub82c\uc6a9\n    op.create_index('idx_products_rating', 'products', ['average_rating'])\n\ndef downgrade():\n    op.drop_index('idx_products_rating', table_name='products')\n    op.drop_index('idx_reviews_rating', table_name='reviews')\n    op.drop_index('idx_reviews_user', table_name='reviews')\n    op.drop_index('idx_reviews_product_created', table_name='reviews')\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"alembic upgrade head\n"})}),"\n",(0,a.jsx)(n.h3,{id:"9\ub2e8\uacc4-git-\ucee4\ubc0b",children:"9\ub2e8\uacc4: Git \ucee4\ubc0b"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'git add .\ngit commit -m "feat: add product review system\n\n- Add Review model with rating, content, and images\n- Add average_rating and review_count to Product model\n- Add unique constraint: one review per user per product\n- Add indexes for query optimization\n- Add check constraint: rating must be 1-5\n\nMigrations:\n- def789: add reviews table and rating fields\n- ghi012: add indexes for review queries"\n\ngit push origin feature/reviews\n'})}),"\n",(0,a.jsx)(n.h2,{id:"-\uac80\uc99d",children:"\u2705 \uac80\uc99d"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud788\uc2a4\ud1a0\ub9ac \ud655\uc778\nalembic history\n\n# \ucd9c\ub825:\n# def789 -> ghi012 (head), add indexes for review queries\n# abc123 -> def789, add reviews table and rating fields to products\n# <base> -> abc123, initial schema\n\n# \ud604\uc7ac \ubc84\uc804 \ud655\uc778\nalembic current\n# ghi012 (head)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"-\ubc30\uc6b4-\ub0b4\uc6a9",children:"\ud83c\udf93 \ubc30\uc6b4 \ub0b4\uc6a9"}),"\n",(0,a.jsx)(n.h3,{id:"autogenerate-\ud65c\uc6a9",children:"Autogenerate \ud65c\uc6a9"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"SQLAlchemy \ubaa8\ub378 \uc218\uc815"}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"alembic revision --autogenerate"}),"\ub85c \uc790\ub3d9 \uc0dd\uc131"]}),"\n",(0,a.jsx)(n.li,{children:"\uc0dd\uc131\ub41c \ud30c\uc77c \uac80\ud1a0 \ubc0f \uc218\uc815"}),"\n",(0,a.jsx)(n.li,{children:"\ud14c\uc2a4\ud2b8 \ud6c4 \ubc30\ud3ec"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"\uc2a4\ud0a4\ub9c8-\uc9c4\ud654-\ud328\ud134",children:"\uc2a4\ud0a4\ub9c8 \uc9c4\ud654 \ud328\ud134"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\uc0c8 \ud14c\uc774\ube14 \ucd94\uac00: \uc678\ub798 \ud0a4, \uc81c\uc57d\uc870\uac74 \ud3ec\ud568"}),"\n",(0,a.jsx)(n.li,{children:"\uae30\uc874 \ud14c\uc774\ube14 \uc218\uc815: \uceec\ub7fc \ucd94\uac00, \uae30\ubcf8\uac12 \uc124\uc815"}),"\n",(0,a.jsx)(n.li,{children:"\uc131\ub2a5 \ucd5c\uc801\ud654: \uc778\ub371\uc2a4 \ucd94\uac00"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"\ub9c8\uc774\uadf8\ub808\uc774\uc158-\ubd84\ub9ac",children:"\ub9c8\uc774\uadf8\ub808\uc774\uc158 \ubd84\ub9ac"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# \u274c \ub098\uc05c \uc608: \ubaa8\ub4e0 \ubcc0\uacbd\uc744 \ud558\ub098\uc5d0\nalembic revision -m "add everything"\n\n# \u2705 \uc88b\uc740 \uc608: \ub17c\ub9ac\uc801 \ub2e8\uc704\ub85c \ubd84\ub9ac\nalembic revision -m "add reviews table"\nalembic revision -m "add indexes for performance"\n'})}),"\n",(0,a.jsx)(n.h2,{id:"-\uc2e4\uc804-\ud301",children:"\ud83d\udca1 \uc2e4\uc804 \ud301"}),"\n",(0,a.jsx)(n.h3,{id:"1-\uad00\uacc4relationship-\uc124\uc815",children:"1. \uad00\uacc4(Relationship) \uc124\uc815"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# \uc591\ubc29\ud5a5 \uad00\uacc4 \uc124\uc815\nclass Product(Base):\n    reviews = relationship('Review', back_populates='product')\n\nclass Review(Base):\n    product = relationship('Product', back_populates='reviews')\n"})}),"\n",(0,a.jsx)(n.h3,{id:"2-json-\uceec\ub7fc-\ud65c\uc6a9-postgresql",children:"2. JSON \uceec\ub7fc \ud65c\uc6a9 (PostgreSQL)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# \uc774\ubbf8\uc9c0 URL \ubc30\uc5f4 \uc800\uc7a5\nimages = Column(JSON)\n\n# \uc0ac\uc6a9 \uc608:\nreview.images = [\n    'https://example.com/image1.jpg',\n    'https://example.com/image2.jpg'\n]\n"})}),"\n",(0,a.jsx)(n.h3,{id:"3-\uc81c\uc57d\uc870\uac74-\ub124\uc774\ubc0d",children:"3. \uc81c\uc57d\uc870\uac74 \ub124\uc774\ubc0d"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# \uba85\ud655\ud55c \uc774\ub984 \uc0ac\uc6a9\nCheckConstraint('rating >= 1 AND rating <= 5', name='check_rating_range')\nUniqueConstraint('product_id', 'user_id', name='uq_product_user_review')\n"})}),"\n",(0,a.jsx)(n.h2,{id:"-\uc8fc\uc758\uc0ac\ud56d",children:"\ud83d\udea8 \uc8fc\uc758\uc0ac\ud56d"}),"\n",(0,a.jsx)(n.h3,{id:"1-\uae30\uc874-\ub370\uc774\ud130-\uace0\ub824",children:"1. \uae30\uc874 \ub370\uc774\ud130 \uace0\ub824"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# \u274c \uc704\ud5d8: NOT NULL\uc744 \ubc14\ub85c \ucd94\uac00\nop.add_column('products', sa.Column('average_rating', sa.Numeric(3, 2), nullable=False))\n\n# \u2705 \uc548\uc804: \uae30\ubcf8\uac12 \uc124\uc815\nop.add_column('products',\n    sa.Column('average_rating', sa.Numeric(3, 2),\n              server_default='0.0', nullable=False))\n"})}),"\n",(0,a.jsx)(n.h3,{id:"2-\uc678\ub798-\ud0a4-\uc0ad\uc81c-\uc635\uc158",children:"2. \uc678\ub798 \ud0a4 \uc0ad\uc81c \uc635\uc158"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# CASCADE: \ubd80\ubaa8 \uc0ad\uc81c \uc2dc \uc790\uc2dd\ub3c4 \uc0ad\uc81c\nForeignKey('products.id', ondelete='CASCADE')\n\n# SET NULL: \ubd80\ubaa8 \uc0ad\uc81c \uc2dc NULL\ub85c \uc124\uc815\nForeignKey('categories.id', ondelete='SET NULL')\n"})}),"\n",(0,a.jsx)(n.h2,{id:"-\uc131\ub2a5-\uace0\ub824\uc0ac\ud56d",children:"\ud83d\udcca \uc131\ub2a5 \uace0\ub824\uc0ac\ud56d"}),"\n",(0,a.jsx)(n.h3,{id:"\ubcf5\ud569-\uc778\ub371\uc2a4-\uc21c\uc11c",children:"\ubcf5\ud569 \uc778\ub371\uc2a4 \uc21c\uc11c"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# \u2705 \uc88b\uc740 \uc608: \uc790\uc8fc \ud568\uaed8 \uc0ac\uc6a9\ub418\ub294 \uceec\ub7fc\nop.create_index('idx_reviews_product_created', 'reviews',\n    ['product_id', 'created_at DESC']  # \uc81c\ud488\ubcc4 \ucd5c\uc2e0 \ub9ac\ubdf0\n)\n\n# \u274c \ub098\uc05c \uc608: \uc120\ud0dd\ub3c4\uac00 \ub0ae\uc740 \uceec\ub7fc \uba3c\uc800\nop.create_index('idx_reviews_rating_product', 'reviews',\n    ['rating', 'product_id']  # rating\uc740 \uac12\uc774 1~5\ubfd0\n)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"-\uad00\ub828-\ubb38\uc11c",children:"\ud83d\udd17 \uad00\ub828 \ubb38\uc11c"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"../basic/tables",children:"\ud14c\uc774\ube14 \uc791\uc5c5"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"../basic/columns",children:"\uceec\ub7fc \uc791\uc5c5"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"../intermediate/autogenerate",children:"\uc790\ub3d9 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uc0dd\uc131"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"../basic/constraints",children:"\uc81c\uc57d\uc870\uac74\uacfc \uc778\ub371\uc2a4"})}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"-\ub2e4\uc74c-\uc2dc\ub098\ub9ac\uc624",children:"\ud83c\udfaf \ub2e4\uc74c \uc2dc\ub098\ub9ac\uc624"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"PM \uc9c0\ud6c8"}),': "\uc218\uc9c4\ub2d8, \ub9ac\ubdf0 \uae30\ub2a5 \uc798 \ub098\uc654\uc5b4\uc694! \uadf8\ub7f0\ub370 \ub2e4\ub978 \ud300\uc6d0\ub3c4 \ub9c8\uc774\uadf8\ub808\uc774\uc158\uc744 \ub9cc\ub4e4\uc5c8\ub300\uc694. \ube0c\ub79c\uce58\ub97c \ubcd1\ud569\ud574\uc57c \ud558\ub294\ub370..."']}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\uc218\uc9c4"}),': "\uc557, \ucda9\ub3cc\uc774 \ub0a0 \uc218\ub3c4 \uc788\uaca0\ub124\uc694?"']}),"\n",(0,a.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,a.jsx)(n.a,{href:"./scenario-03-team-conflict",children:"\uc2dc\ub098\ub9ac\uc624 3: \ud300 \ud611\uc5c5 \ucda9\ub3cc \ud574\uacb0"})]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\ud83d\udcac \ud1a0\ub860"}),": \ub9ac\ubdf0 \uc2dc\uc2a4\ud15c\uc744 \uc5b4\ub5bb\uac8c \uc124\uacc4\ud558\uc168\ub098\uc694? \uacbd\ud5d8\uc744 \uacf5\uc720\ud574\uc8fc\uc138\uc694!"]})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>d});var r=i(6540);const a={},l=r.createContext(a);function s(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);