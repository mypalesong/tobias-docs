"use strict";(globalThis.webpackChunkgithub_docs=globalThis.webpackChunkgithub_docs||[]).push([[9985],{2916:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"rabbitmq/intermediate/priority-queue","title":"Priority Queue - \uc6b0\uc120\uc21c\uc704 \ud050","description":"\uba54\uc2dc\uc9c0\uc5d0 \uc6b0\uc120\uc21c\uc704\ub97c \ubd80\uc5ec\ud558\uc5ec \uc911\uc694\ud55c \uc791\uc5c5\uc744 \uba3c\uc800 \ucc98\ub9ac\ud558\ub294 \ubc29\ubc95\uc744 \ubc30\uc6cc\ubd05\uc2dc\ub2e4!","source":"@site/docs/rabbitmq/intermediate/priority-queue.md","sourceDirName":"rabbitmq/intermediate","slug":"/rabbitmq/intermediate/priority-queue","permalink":"/docs/rabbitmq/intermediate/priority-queue","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/rabbitmq/intermediate/priority-queue.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"rabbitmqSidebar","previous":{"title":"Dead Letter Exchange (DLX)","permalink":"/docs/rabbitmq/intermediate/dead-letter-exchange"},"next":{"title":"Message TTL - \uba54\uc2dc\uc9c0 \ub9cc\ub8cc","permalink":"/docs/rabbitmq/intermediate/message-ttl"}}');var t=i(4848),s=i(8453);const o={sidebar_position:4},c="Priority Queue - \uc6b0\uc120\uc21c\uc704 \ud050",a={},l=[{value:"\ud83c\udfaf \ud559\uc2b5 \ubaa9\ud45c",id:"-\ud559\uc2b5-\ubaa9\ud45c",level:2},{value:"\ud83d\udcca \ud328\ud134 \uad6c\uc870",id:"-\ud328\ud134-\uad6c\uc870",level:2},{value:"\ud83d\udcdd \uc2dc\ub098\ub9ac\uc624",id:"-\uc2dc\ub098\ub9ac\uc624",level:2},{value:"\ud83d\udd27 \uad6c\ud604",id:"-\uad6c\ud604",level:2},{value:"\ubaa8\ub378 \uc815\uc758",id:"\ubaa8\ub378-\uc815\uc758",level:3},{value:"Queue \uc124\uc815",id:"queue-\uc124\uc815",level:3},{value:"Producer (\ud2f0\ucf13 \ubc1c\ud589)",id:"producer-\ud2f0\ucf13-\ubc1c\ud589",level:3},{value:"Consumer (\ud2f0\ucf13 \ucc98\ub9ac)",id:"consumer-\ud2f0\ucf13-\ucc98\ub9ac",level:3},{value:"\ud83e\uddea \ud14c\uc2a4\ud2b8 \ucf54\ub4dc",id:"-\ud14c\uc2a4\ud2b8-\ucf54\ub4dc",level:2},{value:"\ud83c\udfa8 \uc2e4\ud589 \uc608\uc81c",id:"-\uc2e4\ud589-\uc608\uc81c",level:2},{value:"1. Queue \uc124\uc815",id:"1-queue-\uc124\uc815",level:3},{value:"2. Consumer \uc2e4\ud589",id:"2-consumer-\uc2e4\ud589",level:3},{value:"3. \ud2f0\ucf13 \ubc1c\ud589",id:"3-\ud2f0\ucf13-\ubc1c\ud589",level:3},{value:"\ud83d\udca1 \ud575\uc2ec \uac1c\ub150",id:"-\ud575\uc2ec-\uac1c\ub150",level:2},{value:"1. Priority Queue \uc120\uc5b8",id:"1-priority-queue-\uc120\uc5b8",level:3},{value:"2. \uc6b0\uc120\uc21c\uc704 \uc124\uc815",id:"2-\uc6b0\uc120\uc21c\uc704-\uc124\uc815",level:3},{value:"3. \uc6b0\uc120\uc21c\uc704 \ucc98\ub9ac \uaddc\uce59",id:"3-\uc6b0\uc120\uc21c\uc704-\ucc98\ub9ac-\uaddc\uce59",level:3},{value:"\ud83d\udca1 \uc2e4\uc804 \ud65c\uc6a9 \uc0ac\ub840",id:"-\uc2e4\uc804-\ud65c\uc6a9-\uc0ac\ub840",level:2},{value:"1. \uc774\uba54\uc77c \ubc1c\uc1a1 \uc2dc\uc2a4\ud15c",id:"1-\uc774\uba54\uc77c-\ubc1c\uc1a1-\uc2dc\uc2a4\ud15c",level:3},{value:"2. \uc791\uc5c5 \ud050 \uc6b0\uc120\uc21c\uc704",id:"2-\uc791\uc5c5-\ud050-\uc6b0\uc120\uc21c\uc704",level:3},{value:"3. API \uc694\uccad \uc81c\ud55c (Rate Limiting)",id:"3-api-\uc694\uccad-\uc81c\ud55c-rate-limiting",level:3},{value:"\u26a0\ufe0f \uc8fc\uc758\uc0ac\ud56d",id:"\ufe0f-\uc8fc\uc758\uc0ac\ud56d",level:2},{value:"1. \uc131\ub2a5 \uace0\ub824",id:"1-\uc131\ub2a5-\uace0\ub824",level:3},{value:"2. \uc6b0\uc120\uc21c\uc704 \ubc94\uc704",id:"2-\uc6b0\uc120\uc21c\uc704-\ubc94\uc704",level:3},{value:"3. \uae30\uc544 \uc0c1\ud0dc (Starvation) \ubc29\uc9c0",id:"3-\uae30\uc544-\uc0c1\ud0dc-starvation-\ubc29\uc9c0",level:3},{value:"\ud83d\udcca \uc6b0\uc120\uc21c\uc704 \uad8c\uc7a5\uc0ac\ud56d",id:"-\uc6b0\uc120\uc21c\uc704-\uad8c\uc7a5\uc0ac\ud56d",level:2},{value:"\u2705 \uc2e4\uc2b5 \uacfc\uc81c",id:"-\uc2e4\uc2b5-\uacfc\uc81c",level:2},{value:"\ud83d\udcda \ud575\uc2ec \uc815\ub9ac",id:"-\ud575\uc2ec-\uc815\ub9ac",level:2},{value:"\ud83d\udcda \ub2e4\uc74c \ub2e8\uacc4",id:"-\ub2e4\uc74c-\ub2e8\uacc4",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"priority-queue---\uc6b0\uc120\uc21c\uc704-\ud050",children:"Priority Queue - \uc6b0\uc120\uc21c\uc704 \ud050"})}),"\n",(0,t.jsx)(n.p,{children:"\uba54\uc2dc\uc9c0\uc5d0 \uc6b0\uc120\uc21c\uc704\ub97c \ubd80\uc5ec\ud558\uc5ec \uc911\uc694\ud55c \uc791\uc5c5\uc744 \uba3c\uc800 \ucc98\ub9ac\ud558\ub294 \ubc29\ubc95\uc744 \ubc30\uc6cc\ubd05\uc2dc\ub2e4!"}),"\n",(0,t.jsx)(n.h2,{id:"-\ud559\uc2b5-\ubaa9\ud45c",children:"\ud83c\udfaf \ud559\uc2b5 \ubaa9\ud45c"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Priority Queue \uc774\ud574"}),"\n",(0,t.jsx)(n.li,{children:"\uc6b0\uc120\uc21c\uc704 \uc124\uc815 \ubc29\ubc95"}),"\n",(0,t.jsx)(n.li,{children:"VIP \uc694\uccad \ucc98\ub9ac"}),"\n",(0,t.jsx)(n.li,{children:"\uc6b0\uc120\uc21c\uc704 \uae30\ubc18 \uc2a4\ucf00\uc904\ub9c1"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"-\ud328\ud134-\uad6c\uc870",children:"\ud83d\udcca \ud328\ud134 \uad6c\uc870"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Producer (priority=10) \u2500\u2500\u2510\nProducer (priority=5)  \u2500\u2500\u253c\u2192 [Priority Queue] \u2192 Consumer\nProducer (priority=1)  \u2500\u2500\u2518        \u2193\n                                \ub192\uc740 \uc6b0\uc120\uc21c\uc704\ubd80\ud130 \ucc98\ub9ac\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud2b9\uc9d5"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"0-255 \ubc94\uc704\uc758 \uc6b0\uc120\uc21c\uc704 (\ub192\uc744\uc218\ub85d \uba3c\uc800 \ucc98\ub9ac)"}),"\n",(0,t.jsx)(n.li,{children:"\uac19\uc740 \uc6b0\uc120\uc21c\uc704\ub294 FIFO"}),"\n",(0,t.jsx)(n.li,{children:"\uae34\uae09 \uc791\uc5c5 \uc6b0\uc120 \ucc98\ub9ac"}),"\n",(0,t.jsx)(n.li,{children:"VIP \uace0\uac1d, \uc911\uc694 \uc54c\ub9bc\uc5d0 \uc720\uc6a9"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"-\uc2dc\ub098\ub9ac\uc624",children:"\ud83d\udcdd \uc2dc\ub098\ub9ac\uc624"}),"\n",(0,t.jsx)(n.p,{children:"\uace0\uac1d \uc9c0\uc6d0 \ud2f0\ucf13 \uc2dc\uc2a4\ud15c:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"VIP \uace0\uac1d (priority=10): \uc989\uc2dc \ucc98\ub9ac"}),"\n",(0,t.jsx)(n.li,{children:"\uae34\uae09 (priority=7): \ub192\uc740 \uc6b0\uc120\uc21c\uc704"}),"\n",(0,t.jsx)(n.li,{children:"\uc77c\ubc18 (priority=5): \ubcf4\ud1b5 \uc6b0\uc120\uc21c\uc704"}),"\n",(0,t.jsx)(n.li,{children:"\ubb38\uc758 (priority=1): \ub0ae\uc740 \uc6b0\uc120\uc21c\uc704"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"-\uad6c\ud604",children:"\ud83d\udd27 \uad6c\ud604"}),"\n",(0,t.jsx)(n.h3,{id:"\ubaa8\ub378-\uc815\uc758",children:"\ubaa8\ub378 \uc815\uc758"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# models.py\nfrom dataclasses import dataclass, asdict\nfrom typing import Literal\nimport json\n\nTicketPriority = Literal['vip', 'urgent', 'normal', 'inquiry']\n\n@dataclass\nclass SupportTicket:\n    \"\"\"\uace0\uac1d \uc9c0\uc6d0 \ud2f0\ucf13\"\"\"\n    ticket_id: str\n    customer_id: int\n    customer_name: str\n    issue: str\n    category: TicketPriority\n\n    def to_json(self) -> str:\n        return json.dumps(asdict(self))\n\n    @classmethod\n    def from_json(cls, json_str: str):\n        return cls(**json.loads(json_str))\n\n    def get_priority(self) -> int:\n        \"\"\"\uce74\ud14c\uace0\ub9ac\ubcc4 \uc6b0\uc120\uc21c\uc704 \ubc18\ud658\"\"\"\n        priority_map = {\n            'vip': 10,\n            'urgent': 7,\n            'normal': 5,\n            'inquiry': 1\n        }\n        return priority_map[self.category]\n"})}),"\n",(0,t.jsx)(n.h3,{id:"queue-\uc124\uc815",children:"Queue \uc124\uc815"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# queue_setup.py\nimport pika\n\ndef setup_priority_queue():\n    """Priority Queue \uc124\uc815"""\n    connection = pika.BlockingConnection(\n        pika.ConnectionParameters(\'localhost\')\n    )\n    channel = connection.channel()\n\n    # \ud83d\udd11 \ud575\uc2ec: x-max-priority \uc124\uc815\n    channel.queue_declare(\n        queue=\'support_tickets\',\n        durable=True,\n        arguments={\n            \'x-max-priority\': 10  # \ucd5c\ub300 \uc6b0\uc120\uc21c\uc704: 10\n        }\n    )\n\n    print(" [\u2713] Priority queue configured")\n    print(" [\u2713] Max priority: 10")\n    connection.close()\n\nif __name__ == \'__main__\':\n    setup_priority_queue()\n'})}),"\n",(0,t.jsx)(n.h3,{id:"producer-\ud2f0\ucf13-\ubc1c\ud589",children:"Producer (\ud2f0\ucf13 \ubc1c\ud589)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# ticket_producer.py\nimport pika\nfrom models import SupportTicket\n\nclass TicketProducer:\n    \"\"\"\ud2f0\ucf13 \ubc1c\ud589\uc790\"\"\"\n\n    def __init__(self, host='localhost'):\n        self.host = host\n\n    def submit_ticket(self, ticket: SupportTicket):\n        \"\"\"\ud2f0\ucf13 \uc81c\ucd9c\"\"\"\n        connection = pika.BlockingConnection(\n            pika.ConnectionParameters(self.host)\n        )\n        channel = connection.channel()\n\n        priority = ticket.get_priority()\n\n        # \ud83d\udd11 \ud575\uc2ec: properties\uc5d0 priority \uc124\uc815\n        channel.basic_publish(\n            exchange='',\n            routing_key='support_tickets',\n            body=ticket.to_json(),\n            properties=pika.BasicProperties(\n                delivery_mode=2,\n                priority=priority,  # \uc6b0\uc120\uc21c\uc704 \uc124\uc815\n                content_type='application/json'\n            )\n        )\n\n        print(f\" [x] Submitted [{ticket.category.upper()}] \"\n              f\"(priority={priority}): {ticket.ticket_id}\")\n\n        connection.close()\n\n# \uc0ac\uc6a9 \uc608\nif __name__ == '__main__':\n    producer = TicketProducer()\n\n    # \ub2e4\uc591\ud55c \uc6b0\uc120\uc21c\uc704\uc758 \ud2f0\ucf13\n    tickets = [\n        SupportTicket(\n            'TKT-001', 1001, 'Alice',\n            'General question about pricing', 'inquiry'\n        ),\n        SupportTicket(\n            'TKT-002', 1002, 'Bob VIP',\n            'Cannot access my account', 'vip'\n        ),\n        SupportTicket(\n            'TKT-003', 1003, 'Charlie',\n            'Website is down!', 'urgent'\n        ),\n        SupportTicket(\n            'TKT-004', 1004, 'Diana',\n            'Need help with settings', 'normal'\n        ),\n        SupportTicket(\n            'TKT-005', 1005, 'Eve VIP',\n            'Billing issue - duplicate charge', 'vip'\n        ),\n        SupportTicket(\n            'TKT-006', 1006, 'Frank',\n            'Feature request', 'inquiry'\n        ),\n    ]\n\n    for ticket in tickets:\n        producer.submit_ticket(ticket)\n\n    print(\"\\n [i] Tickets submitted in order: TKT-001 to TKT-006\")\n    print(\" [i] But they will be processed by priority, not submission order!\")\n"})}),"\n",(0,t.jsx)(n.h3,{id:"consumer-\ud2f0\ucf13-\ucc98\ub9ac",children:"Consumer (\ud2f0\ucf13 \ucc98\ub9ac)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# ticket_consumer.py\nimport pika\nimport time\nfrom models import SupportTicket\n\ndef process_ticket(ticket: SupportTicket):\n    \"\"\"\ud2f0\ucf13 \ucc98\ub9ac (\uc2dc\ubbac\ub808\uc774\uc158)\"\"\"\n    priority_labels = {\n        'vip': '\ud83c\udf1f VIP',\n        'urgent': '\ud83d\udea8 URGENT',\n        'normal': '\ud83d\udcdd NORMAL',\n        'inquiry': '\ud83d\udcac INQUIRY'\n    }\n\n    label = priority_labels.get(ticket.category, '\ud83d\udcdd')\n\n    print(f\"\"\"\n    \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n    {label} - Processing Ticket\n    \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n    Ticket ID: {ticket.ticket_id}\n    Customer: {ticket.customer_name} (ID: {ticket.customer_id})\n    Issue: {ticket.issue}\n    Priority: {ticket.get_priority()}\n    \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n    \"\"\")\n\n    # \ucc98\ub9ac \uc2dc\uac04 (\uc6b0\uc120\uc21c\uc704\uac00 \ub192\uc744\uc218\ub85d \ube60\ub974\uac8c)\n    process_time = {\n        'vip': 1,\n        'urgent': 2,\n        'normal': 3,\n        'inquiry': 4\n    }\n\n    time.sleep(process_time.get(ticket.category, 2))\n    print(f\" [\u2713] Ticket {ticket.ticket_id} resolved!\\n\")\n\ndef callback(ch, method, properties, body):\n    \"\"\"\uba54\uc2dc\uc9c0 \ucc98\ub9ac \ucf5c\ubc31\"\"\"\n    ticket = SupportTicket.from_json(body.decode())\n\n    # \uc6b0\uc120\uc21c\uc704 \ucd9c\ub825\n    priority = properties.priority if properties.priority else 0\n    print(f\" [\u2192] Received ticket with priority: {priority}\")\n\n    process_ticket(ticket)\n\n    ch.basic_ack(delivery_tag=method.delivery_tag)\n\ndef start():\n    \"\"\"Ticket Consumer \uc2dc\uc791\"\"\"\n    connection = pika.BlockingConnection(\n        pika.ConnectionParameters('localhost')\n    )\n    channel = connection.channel()\n\n    channel.basic_qos(prefetch_count=1)\n\n    channel.basic_consume(\n        queue='support_tickets',\n        on_message_callback=callback\n    )\n\n    print(' [*] Support Agent waiting for tickets...')\n    print(' [*] Higher priority tickets will be processed first')\n    print()\n    channel.start_consuming()\n\nif __name__ == '__main__':\n    try:\n        start()\n    except KeyboardInterrupt:\n        print('\\nSupport Agent stopped')\n"})}),"\n",(0,t.jsx)(n.h2,{id:"-\ud14c\uc2a4\ud2b8-\ucf54\ub4dc",children:"\ud83e\uddea \ud14c\uc2a4\ud2b8 \ucf54\ub4dc"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# test_priority_queue.py\nimport pytest\nimport pika\nimport time\n\nclass TestPriorityQueue:\n    \"\"\"Priority Queue \ud14c\uc2a4\ud2b8\"\"\"\n\n    @pytest.fixture\n    def setup(self):\n        \"\"\"\ud14c\uc2a4\ud2b8 \ud658\uacbd \uc124\uc815\"\"\"\n        connection = pika.BlockingConnection(\n            pika.ConnectionParameters('localhost')\n        )\n        channel = connection.channel()\n\n        try:\n            channel.queue_delete(queue='test_priority')\n        except:\n            pass\n\n        yield channel\n        connection.close()\n\n    def test_priority_ordering(self, setup):\n        \"\"\"\uc6b0\uc120\uc21c\uc704 \uc21c\uc11c\ub300\ub85c \ucc98\ub9ac\ub418\ub294\uc9c0 \ud14c\uc2a4\ud2b8\"\"\"\n        channel = setup\n\n        # Priority Queue \uc120\uc5b8\n        channel.queue_declare(\n            queue='test_priority',\n            arguments={'x-max-priority': 10}\n        )\n\n        # \ub0ae\uc740 \uc6b0\uc120\uc21c\uc704\ubd80\ud130 \ubc1c\ud589\n        messages = [\n            (1, 'Low priority'),\n            (5, 'Medium priority'),\n            (10, 'High priority'),\n        ]\n\n        for priority, message in messages:\n            channel.basic_publish(\n                exchange='',\n                routing_key='test_priority',\n                body=message,\n                properties=pika.BasicProperties(priority=priority)\n            )\n\n        # \uc7a0\uc2dc \ub300\uae30 (\uba54\uc2dc\uc9c0 \uc815\ub82c \uc2dc\uac04)\n        time.sleep(0.1)\n\n        # \ub192\uc740 \uc6b0\uc120\uc21c\uc704\ubd80\ud130 \uc218\uc2e0\ub418\uc5b4\uc57c \ud568\n        expected_order = [\n            'High priority',    # priority=10\n            'Medium priority',  # priority=5\n            'Low priority',     # priority=1\n        ]\n\n        for expected_message in expected_order:\n            method, properties, body = channel.basic_get(\n                queue='test_priority',\n                auto_ack=True\n            )\n            assert body.decode() == expected_message\n\n    def test_same_priority_fifo(self, setup):\n        \"\"\"\uac19\uc740 \uc6b0\uc120\uc21c\uc704\ub294 FIFO \uc21c\uc11c\"\"\"\n        channel = setup\n\n        channel.queue_declare(\n            queue='test_priority',\n            arguments={'x-max-priority': 10}\n        )\n\n        # \ub3d9\uc77c \uc6b0\uc120\uc21c\uc704\ub85c \ubc1c\ud589\n        for i in range(3):\n            channel.basic_publish(\n                exchange='',\n                routing_key='test_priority',\n                body=f'Message {i+1}',\n                properties=pika.BasicProperties(priority=5)\n            )\n\n        time.sleep(0.1)\n\n        # \ubc1c\ud589 \uc21c\uc11c\ub300\ub85c \uc218\uc2e0\n        for i in range(3):\n            method, properties, body = channel.basic_get(\n                queue='test_priority',\n                auto_ack=True\n            )\n            assert body.decode() == f'Message {i+1}'\n\n    def test_priority_range(self, setup):\n        \"\"\"\uc6b0\uc120\uc21c\uc704 \ubc94\uc704 \ud14c\uc2a4\ud2b8\"\"\"\n        channel = setup\n\n        channel.queue_declare(\n            queue='test_priority',\n            arguments={'x-max-priority': 10}\n        )\n\n        # \ub2e4\uc591\ud55c \uc6b0\uc120\uc21c\uc704 (0-10)\n        priorities = [0, 1, 5, 8, 10]\n\n        for priority in priorities:\n            channel.basic_publish(\n                exchange='',\n                routing_key='test_priority',\n                body=f'Priority {priority}',\n                properties=pika.BasicProperties(priority=priority)\n            )\n\n        time.sleep(0.1)\n\n        # \ub192\uc740 \uc6b0\uc120\uc21c\uc704\ubd80\ud130 \uc218\uc2e0\n        for priority in reversed(priorities):\n            method, properties, body = channel.basic_get(\n                queue='test_priority',\n                auto_ack=True\n            )\n            assert body.decode() == f'Priority {priority}'\n"})}),"\n",(0,t.jsx)(n.h2,{id:"-\uc2e4\ud589-\uc608\uc81c",children:"\ud83c\udfa8 \uc2e4\ud589 \uc608\uc81c"}),"\n",(0,t.jsx)(n.h3,{id:"1-queue-\uc124\uc815",children:"1. Queue \uc124\uc815"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"python queue_setup.py\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-consumer-\uc2e4\ud589",children:"2. Consumer \uc2e4\ud589"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"python ticket_consumer.py\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-\ud2f0\ucf13-\ubc1c\ud589",children:"3. \ud2f0\ucf13 \ubc1c\ud589"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"python ticket_producer.py\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ucd9c\ub825 \uacb0\uacfc"})," (\ucc98\ub9ac \uc21c\uc11c):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"# Producer (\uc81c\ucd9c \uc21c\uc11c)\n[x] Submitted [INQUIRY] (priority=1): TKT-001\n[x] Submitted [VIP] (priority=10): TKT-002\n[x] Submitted [URGENT] (priority=7): TKT-003\n[x] Submitted [NORMAL] (priority=5): TKT-004\n[x] Submitted [VIP] (priority=10): TKT-005\n[x] Submitted [INQUIRY] (priority=1): TKT-006\n\n# Consumer (\ucc98\ub9ac \uc21c\uc11c - \uc6b0\uc120\uc21c\uc704\ub300\ub85c!)\n[\u2192] Received ticket with priority: 10\n\ud83c\udf1f VIP - Processing Ticket\nTicket ID: TKT-002\nCustomer: Bob VIP\n[\u2713] Ticket TKT-002 resolved!\n\n[\u2192] Received ticket with priority: 10\n\ud83c\udf1f VIP - Processing Ticket\nTicket ID: TKT-005\nCustomer: Eve VIP\n[\u2713] Ticket TKT-005 resolved!\n\n[\u2192] Received ticket with priority: 7\n\ud83d\udea8 URGENT - Processing Ticket\nTicket ID: TKT-003\nIssue: Website is down!\n[\u2713] Ticket TKT-003 resolved!\n\n[\u2192] Received ticket with priority: 5\n\ud83d\udcdd NORMAL - Processing Ticket\nTicket ID: TKT-004\n[\u2713] Ticket TKT-004 resolved!\n\n[\u2192] Received ticket with priority: 1\n\ud83d\udcac INQUIRY - Processing Ticket\nTicket ID: TKT-001\n[\u2713] Ticket TKT-001 resolved!\n\n[\u2192] Received ticket with priority: 1\n\ud83d\udcac INQUIRY - Processing Ticket\nTicket ID: TKT-006\n[\u2713] Ticket TKT-006 resolved!\n"})}),"\n",(0,t.jsx)(n.h2,{id:"-\ud575\uc2ec-\uac1c\ub150",children:"\ud83d\udca1 \ud575\uc2ec \uac1c\ub150"}),"\n",(0,t.jsx)(n.h3,{id:"1-priority-queue-\uc120\uc5b8",children:"1. Priority Queue \uc120\uc5b8"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Queue \uc120\uc5b8 \uc2dc x-max-priority \uc124\uc815\nchannel.queue_declare(\n    queue='my_queue',\n    arguments={\n        'x-max-priority': 10  # \ucd5c\ub300 \uc6b0\uc120\uc21c\uc704 (0-255)\n    }\n)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-\uc6b0\uc120\uc21c\uc704-\uc124\uc815",children:"2. \uc6b0\uc120\uc21c\uc704 \uc124\uc815"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# \uba54\uc2dc\uc9c0 \ubc1c\ud589 \uc2dc priority \uc9c0\uc815\nchannel.basic_publish(\n    exchange='',\n    routing_key='my_queue',\n    body=message,\n    properties=pika.BasicProperties(\n        priority=10  # 0-255 (\ub192\uc744\uc218\ub85d \uba3c\uc800)\n    )\n)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-\uc6b0\uc120\uc21c\uc704-\ucc98\ub9ac-\uaddc\uce59",children:"3. \uc6b0\uc120\uc21c\uc704 \ucc98\ub9ac \uaddc\uce59"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# 1. \ub192\uc740 \uc6b0\uc120\uc21c\uc704\uac00 \uba3c\uc800 \ucc98\ub9ac\npriority=10  \u2192  \uba3c\uc800 \ucc98\ub9ac\npriority=5   \u2192  \ub098\uc911 \ucc98\ub9ac\npriority=1   \u2192  \uac00\uc7a5 \ub098\uc911\n\n# 2. \uac19\uc740 \uc6b0\uc120\uc21c\uc704\ub294 FIFO\npriority=5 (msg1)  \u2192  \uba3c\uc800\npriority=5 (msg2)  \u2192  \ub098\uc911\n"})}),"\n",(0,t.jsx)(n.h2,{id:"-\uc2e4\uc804-\ud65c\uc6a9-\uc0ac\ub840",children:"\ud83d\udca1 \uc2e4\uc804 \ud65c\uc6a9 \uc0ac\ub840"}),"\n",(0,t.jsx)(n.h3,{id:"1-\uc774\uba54\uc77c-\ubc1c\uc1a1-\uc2dc\uc2a4\ud15c",children:"1. \uc774\uba54\uc77c \ubc1c\uc1a1 \uc2dc\uc2a4\ud15c"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# email_sender.py\nimport pika\n\ndef send_email(to: str, subject: str, priority: str = 'normal'):\n    \"\"\"\uc774\uba54\uc77c \ubc1c\uc1a1\"\"\"\n    priority_map = {\n        'critical': 10,  # \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815\n        'high': 7,       # \uc8fc\ubb38 \ud655\uc778\n        'normal': 5,     # \ub274\uc2a4\ub808\ud130\n        'low': 1         # \ub9c8\ucf00\ud305\n    }\n\n    connection = pika.BlockingConnection(\n        pika.ConnectionParameters('localhost')\n    )\n    channel = connection.channel()\n\n    channel.basic_publish(\n        exchange='',\n        routing_key='email_queue',\n        body=f'{to}|{subject}',\n        properties=pika.BasicProperties(\n            priority=priority_map[priority]\n        )\n    )\n\n    connection.close()\n\n# \uc0ac\uc6a9 \uc608\nsend_email('user@example.com', 'Password Reset', 'critical')\nsend_email('user@example.com', 'Newsletter', 'low')\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-\uc791\uc5c5-\ud050-\uc6b0\uc120\uc21c\uc704",children:"2. \uc791\uc5c5 \ud050 \uc6b0\uc120\uc21c\uc704"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# task_scheduler.py\nimport pika\n\nclass TaskScheduler:\n    \"\"\"\uc791\uc5c5 \uc2a4\ucf00\uc904\ub7ec\"\"\"\n\n    def __init__(self):\n        self.connection = pika.BlockingConnection(\n            pika.ConnectionParameters('localhost')\n        )\n        self.channel = self.connection.channel()\n\n    def schedule_task(self, task_type: str, data: dict):\n        \"\"\"\uc791\uc5c5 \uc2a4\ucf00\uc904\ub9c1\"\"\"\n        # \uc791\uc5c5 \uc720\ud615\ubcc4 \uc6b0\uc120\uc21c\uc704\n        task_priorities = {\n            'user_signup': 10,      # \uc2e0\uaddc \uac00\uc785 \uc989\uc2dc \ucc98\ub9ac\n            'payment': 9,           # \uacb0\uc81c \ub192\uc740 \uc6b0\uc120\uc21c\uc704\n            'notification': 7,      # \uc54c\ub9bc \ubcf4\ud1b5 \uc6b0\uc120\uc21c\uc704\n            'analytics': 3,         # \ubd84\uc11d \ub0ae\uc740 \uc6b0\uc120\uc21c\uc704\n            'cleanup': 1            # \uc815\ub9ac \uc791\uc5c5 \uac00\uc7a5 \ub0ae\uc74c\n        }\n\n        priority = task_priorities.get(task_type, 5)\n\n        self.channel.basic_publish(\n            exchange='',\n            routing_key='tasks',\n            body=json.dumps({'type': task_type, 'data': data}),\n            properties=pika.BasicProperties(priority=priority)\n        )\n\n# \uc0ac\uc6a9 \uc608\nscheduler = TaskScheduler()\nscheduler.schedule_task('payment', {'amount': 100})\nscheduler.schedule_task('cleanup', {'old_logs': True})\n# payment\uac00 cleanup\ubcf4\ub2e4 \uba3c\uc800 \ucc98\ub9ac\ub428\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-api-\uc694\uccad-\uc81c\ud55c-rate-limiting",children:"3. API \uc694\uccad \uc81c\ud55c (Rate Limiting)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# api_queue.py\nimport pika\n\nclass APIRequestQueue:\n    \"\"\"API \uc694\uccad \ud050 (\uc6b0\uc120\uc21c\uc704 \uae30\ubc18)\"\"\"\n\n    def __init__(self):\n        self.connection = pika.BlockingConnection(\n            pika.ConnectionParameters('localhost')\n        )\n        self.channel = self.connection.channel()\n\n        self.channel.queue_declare(\n            queue='api_requests',\n            arguments={'x-max-priority': 10}\n        )\n\n    def queue_request(self, endpoint: str, user_tier: str):\n        \"\"\"API \uc694\uccad \ud050\uc789\"\"\"\n        # \uc0ac\uc6a9\uc790 \ub4f1\uae09\ubcc4 \uc6b0\uc120\uc21c\uc704\n        tier_priority = {\n            'enterprise': 10,\n            'pro': 7,\n            'basic': 3,\n            'free': 1\n        }\n\n        priority = tier_priority.get(user_tier, 1)\n\n        self.channel.basic_publish(\n            exchange='',\n            routing_key='api_requests',\n            body=endpoint,\n            properties=pika.BasicProperties(priority=priority)\n        )\n\n        print(f\" [x] Queued [{user_tier}] {endpoint} (priority={priority})\")\n\n# \uc0ac\uc6a9 \uc608\napi_queue = APIRequestQueue()\napi_queue.queue_request('/api/data', 'free')\napi_queue.queue_request('/api/data', 'enterprise')\n# Enterprise \uc694\uccad\uc774 \uba3c\uc800 \ucc98\ub9ac\ub428\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\ufe0f-\uc8fc\uc758\uc0ac\ud56d",children:"\u26a0\ufe0f \uc8fc\uc758\uc0ac\ud56d"}),"\n",(0,t.jsx)(n.h3,{id:"1-\uc131\ub2a5-\uace0\ub824",children:"1. \uc131\ub2a5 \uace0\ub824"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Priority Queue\ub294 \uc77c\ubc18 \ud050\ubcf4\ub2e4 \ub290\ub9bc\n# - \uc6b0\uc120\uc21c\uc704 \uc815\ub82c \uc624\ubc84\ud5e4\ub4dc\n# - \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9 \uc99d\uac00\n\n# \ud544\uc694\ud55c \uacbd\uc6b0\uc5d0\ub9cc \uc0ac\uc6a9\n# \u2713 VIP \ucc98\ub9ac, \uae34\uae09 \uc791\uc5c5\n# \u2717 \ubaa8\ub4e0 \uba54\uc2dc\uc9c0\uac00 \uac19\uc740 \uc6b0\uc120\uc21c\uc704\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-\uc6b0\uc120\uc21c\uc704-\ubc94\uc704",children:"2. \uc6b0\uc120\uc21c\uc704 \ubc94\uc704"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# x-max-priority \uc124\uc815\ud55c \uac12\uae4c\uc9c0\ub9cc \uc720\ud6a8\nchannel.queue_declare(\n    queue='my_queue',\n    arguments={'x-max-priority': 10}\n)\n\n# \u2713 priority=5  (\uc720\ud6a8)\n# \u2713 priority=10 (\uc720\ud6a8)\n# \u26a0 priority=15 (10\uc73c\ub85c \ucc98\ub9ac\ub428)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-\uae30\uc544-\uc0c1\ud0dc-starvation-\ubc29\uc9c0",children:"3. \uae30\uc544 \uc0c1\ud0dc (Starvation) \ubc29\uc9c0"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# \ub0ae\uc740 \uc6b0\uc120\uc21c\uc704\uac00 \uacc4\uc18d \ubc00\ub9b4 \uc218 \uc788\uc74c\n# \u2192 \uc6b0\uc120\uc21c\uc704 \ucc28\uc774\ub97c \ud06c\uac8c \ub450\uc9c0 \uc54a\uae30\n# \u2192 \ud0c0\uc784\uc544\uc6c3 \uc124\uc815\n\n# \u2713 \uc88b\uc740 \uc124\uacc4\nvip = 10\nnormal = 7\nlow = 5\n\n# \u2717 \ub098\uc05c \uc124\uacc4\nvip = 255\nnormal = 128\nlow = 1  # \uac70\uc758 \ucc98\ub9ac \uc548\ub428\n"})}),"\n",(0,t.jsx)(n.h2,{id:"-\uc6b0\uc120\uc21c\uc704-\uad8c\uc7a5\uc0ac\ud56d",children:"\ud83d\udcca \uc6b0\uc120\uc21c\uc704 \uad8c\uc7a5\uc0ac\ud56d"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# \uc77c\ubc18\uc801\uc778 \uc6b0\uc120\uc21c\uc704 \uccb4\uacc4\nPRIORITY_CRITICAL = 10   # \uae34\uae09 (\uc989\uc2dc \ucc98\ub9ac)\nPRIORITY_HIGH = 7        # \ub192\uc74c (\ube60\ub978 \ucc98\ub9ac)\nPRIORITY_NORMAL = 5      # \ubcf4\ud1b5 (\uae30\ubcf8)\nPRIORITY_LOW = 3         # \ub0ae\uc74c (\ub098\uc911 \ucc98\ub9ac)\nPRIORITY_BULK = 1        # \ub300\ub7c9 (\uc720\ud734 \uc2dc \ucc98\ub9ac)\n\n# \uc0ac\uc6a9 \uc608\nclass Priority:\n    CRITICAL = 10  # \uc2dc\uc2a4\ud15c \uc7a5\uc560, \ubcf4\uc548\n    HIGH = 7       # VIP \uace0\uac1d, \uacb0\uc81c\n    NORMAL = 5     # \uc77c\ubc18 \uc694\uccad\n    LOW = 3        # \ubd84\uc11d, \ub9ac\ud3ec\ud2b8\n    BULK = 1       # \ubc30\uce58 \uc791\uc5c5\n"})}),"\n",(0,t.jsx)(n.h2,{id:"-\uc2e4\uc2b5-\uacfc\uc81c",children:"\u2705 \uc2e4\uc2b5 \uacfc\uc81c"}),"\n",(0,t.jsx)(n.p,{children:"\ub2e4\uc74c \uc2dc\uc2a4\ud15c\uc744 \uad6c\ud604\ud558\uc138\uc694:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"\uc8fc\ubb38 \ucc98\ub9ac \uc2dc\uc2a4\ud15c"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"VIP \uace0\uac1d (priority=10)"}),"\n",(0,t.jsx)(n.li,{children:"\uae34\uae09 \ubc30\uc1a1 (priority=8)"}),"\n",(0,t.jsx)(n.li,{children:"\uc77c\ubc18 \uc8fc\ubb38 (priority=5)"}),"\n",(0,t.jsx)(n.li,{children:"\ub300\ub7c9 \uc8fc\ubb38 (priority=2)"}),"\n"]}),"\n",(0,t.jsxs)(i,{children:[(0,t.jsx)("summary",{children:"\uc815\ub2f5 \ubcf4\uae30"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# order_system.py\nimport pika\nimport json\n\nclass OrderPriority:\n    VIP = 10\n    EXPRESS = 8\n    STANDARD = 5\n    BULK = 2\n\ndef submit_order(order_id: str, customer_type: str, priority: int):\n    connection = pika.BlockingConnection(\n        pika.ConnectionParameters('localhost')\n    )\n    channel = connection.channel()\n\n    channel.queue_declare(\n        queue='orders',\n        arguments={'x-max-priority': 10}\n    )\n\n    order_data = {\n        'order_id': order_id,\n        'customer_type': customer_type\n    }\n\n    channel.basic_publish(\n        exchange='',\n        routing_key='orders',\n        body=json.dumps(order_data),\n        properties=pika.BasicProperties(\n            priority=priority,\n            delivery_mode=2\n        )\n    )\n\n    print(f\" [x] Order {order_id} queued (priority={priority})\")\n    connection.close()\n\n# \ud14c\uc2a4\ud2b8\nsubmit_order('ORD-001', 'standard', OrderPriority.STANDARD)\nsubmit_order('ORD-002', 'vip', OrderPriority.VIP)\nsubmit_order('ORD-003', 'express', OrderPriority.EXPRESS)\n# \ucc98\ub9ac \uc21c\uc11c: ORD-002 \u2192 ORD-003 \u2192 ORD-001\n"})})]}),"\n",(0,t.jsx)(n.h2,{id:"-\ud575\uc2ec-\uc815\ub9ac",children:"\ud83d\udcda \ud575\uc2ec \uc815\ub9ac"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Priority Queue"}),": \uc6b0\uc120\uc21c\uc704 \uae30\ubc18 \uba54\uc2dc\uc9c0 \ucc98\ub9ac"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"x-max-priority"}),": \ud050 \uc120\uc5b8 \uc2dc \ucd5c\ub300 \uc6b0\uc120\uc21c\uc704 \uc124\uc815"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"priority"}),": \uba54\uc2dc\uc9c0 \ubc1c\ud589 \uc2dc \uc6b0\uc120\uc21c\uc704 \uc9c0\uc815 (0-255)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\ucc98\ub9ac \uc21c\uc11c"}),": \ub192\uc740 \uc6b0\uc120\uc21c\uc704 \uba3c\uc800, \uac19\uc740 \uc6b0\uc120\uc21c\uc704\ub294 FIFO"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"-\ub2e4\uc74c-\ub2e8\uacc4",children:"\ud83d\udcda \ub2e4\uc74c \ub2e8\uacc4"}),"\n",(0,t.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,t.jsx)(n.a,{href:"./message-ttl",children:"Message TTL - \uba54\uc2dc\uc9c0 \ub9cc\ub8cc"})]})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>c});var r=i(6540);const t={},s=r.createContext(t);function o(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);