"use strict";(globalThis.webpackChunkgithub_docs=globalThis.webpackChunkgithub_docs||[]).push([[2955],{405:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"crawling/examples/scenario-02-ecommerce-scraper","title":"\uc2dc\ub098\ub9ac\uc624 2: \uc1fc\ud551\ubab0 \uac00\uaca9 \ubaa8\ub2c8\ud130\ub9c1","description":"\uc628\ub77c\uc778 \uc1fc\ud551\ubab0\uc758 \uc0c1\ud488 \uac00\uaca9\uc744 \ubaa8\ub2c8\ud130\ub9c1\ud558\uace0 \uc774\ubbf8\uc9c0\ub97c \ub2e4\uc6b4\ub85c\ub4dc\ud558\ub294 \uc2a4\ud06c\ub798\ud37c\ub97c \ub9cc\ub4e4\uc5b4\ubd05\uc2dc\ub2e4!","source":"@site/docs/crawling/examples/scenario-02-ecommerce-scraper.md","sourceDirName":"crawling/examples","slug":"/crawling/examples/scenario-02-ecommerce-scraper","permalink":"/tobias-docs/comp-0/docs/crawling/examples/scenario-02-ecommerce-scraper","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/crawling/examples/scenario-02-ecommerce-scraper.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"crawlingSidebar","previous":{"title":"\uc2dc\ub098\ub9ac\uc624 1: \ub274\uc2a4 \uc2a4\ud06c\ub798\ud37c","permalink":"/tobias-docs/comp-0/docs/crawling/examples/scenario-01-news-scraper"},"next":{"title":"\uc2dc\ub098\ub9ac\uc624 3: \uc18c\uc15c \ubbf8\ub514\uc5b4 \ub370\uc774\ud130 \uc218\uc9d1","permalink":"/tobias-docs/comp-0/docs/crawling/examples/scenario-03-social-media"}}');var t=r(4848),s=r(8453);const o={sidebar_position:3},c="\uc2dc\ub098\ub9ac\uc624 2: \uc1fc\ud551\ubab0 \uac00\uaca9 \ubaa8\ub2c8\ud130\ub9c1",a={},l=[{value:"\ud83c\udfaf \ubaa9\ud45c",id:"-\ubaa9\ud45c",level:2},{value:"\ud83d\udcdd \uc644\uc804\ud55c \uad6c\ud604",id:"-\uc644\uc804\ud55c-\uad6c\ud604",level:2},{value:"\ud504\ub85c\uc81d\ud2b8 \uad6c\uc870",id:"\ud504\ub85c\uc81d\ud2b8-\uad6c\uc870",level:3},{value:"requirements.txt",id:"requirementstxt",level:3},{value:"config.py",id:"configpy",level:3},{value:"scraper/image_downloader.py",id:"scraperimage_downloaderpy",level:3},{value:"scraper/product_scraper.py",id:"scraperproduct_scraperpy",level:3},{value:"scraper/price_tracker.py",id:"scraperprice_trackerpy",level:3},{value:"main.py",id:"mainpy",level:3},{value:"\ud83d\uddbc\ufe0f \uc774\ubbf8\uc9c0 \ucc98\ub9ac \uae30\ub2a5",id:"\ufe0f-\uc774\ubbf8\uc9c0-\ucc98\ub9ac-\uae30\ub2a5",level:2},{value:"\uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc",id:"\uc774\ubbf8\uc9c0-\ub2e4\uc6b4\ub85c\ub4dc",level:3},{value:"\uc378\ub124\uc77c \uc0dd\uc131",id:"\uc378\ub124\uc77c-\uc0dd\uc131",level:3},{value:"\uc774\ubbf8\uc9c0 \ucd5c\uc801\ud654",id:"\uc774\ubbf8\uc9c0-\ucd5c\uc801\ud654",level:3},{value:"\ud83d\udcca \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc2a4\ud0a4\ub9c8",id:"-\ub370\uc774\ud130\ubca0\uc774\uc2a4-\uc2a4\ud0a4\ub9c8",level:2},{value:"products \ud14c\uc774\ube14",id:"products-\ud14c\uc774\ube14",level:3},{value:"price_history \ud14c\uc774\ube14",id:"price_history-\ud14c\uc774\ube14",level:3},{value:"\ud83d\udd14 \uac00\uaca9 \uc54c\ub9bc",id:"-\uac00\uaca9-\uc54c\ub9bc",level:2},{value:"\ud83d\udcda \ub2e4\uc74c \ub2e8\uacc4",id:"-\ub2e4\uc74c-\ub2e8\uacc4",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"\uc2dc\ub098\ub9ac\uc624-2-\uc1fc\ud551\ubab0-\uac00\uaca9-\ubaa8\ub2c8\ud130\ub9c1",children:"\uc2dc\ub098\ub9ac\uc624 2: \uc1fc\ud551\ubab0 \uac00\uaca9 \ubaa8\ub2c8\ud130\ub9c1"})}),"\n",(0,t.jsx)(n.p,{children:"\uc628\ub77c\uc778 \uc1fc\ud551\ubab0\uc758 \uc0c1\ud488 \uac00\uaca9\uc744 \ubaa8\ub2c8\ud130\ub9c1\ud558\uace0 \uc774\ubbf8\uc9c0\ub97c \ub2e4\uc6b4\ub85c\ub4dc\ud558\ub294 \uc2a4\ud06c\ub798\ud37c\ub97c \ub9cc\ub4e4\uc5b4\ubd05\uc2dc\ub2e4!"}),"\n",(0,t.jsx)(n.h2,{id:"-\ubaa9\ud45c",children:"\ud83c\udfaf \ubaa9\ud45c"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\uc1fc\ud551\ubab0 \uc0c1\ud488 \uc815\ubcf4 \uc218\uc9d1 (\uc81c\ubaa9, \uac00\uaca9, \ud3c9\uc810, \ub9ac\ubdf0 \uc218)"}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"\uc0c1\ud488 \uc774\ubbf8\uc9c0 \uc790\ub3d9 \ub2e4\uc6b4\ub85c\ub4dc"})}),"\n",(0,t.jsx)(n.li,{children:"\uac00\uaca9 \ubcc0\ub3d9 \ucd94\uc801 \ubc0f \uc54c\ub9bc"}),"\n",(0,t.jsx)(n.li,{children:"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc800\uc7a5"}),"\n",(0,t.jsx)(n.li,{children:"\uac00\uaca9 \ud788\uc2a4\ud1a0\ub9ac \ubd84\uc11d"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"-\uc644\uc804\ud55c-\uad6c\ud604",children:"\ud83d\udcdd \uc644\uc804\ud55c \uad6c\ud604"}),"\n",(0,t.jsx)(n.h3,{id:"\ud504\ub85c\uc81d\ud2b8-\uad6c\uc870",children:"\ud504\ub85c\uc81d\ud2b8 \uad6c\uc870"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ecommerce_scraper/\n\u251c\u2500\u2500 scraper/\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 product_scraper.py\n\u2502   \u251c\u2500\u2500 image_downloader.py\n\u2502   \u2514\u2500\u2500 price_tracker.py\n\u251c\u2500\u2500 data/\n\u2502   \u251c\u2500\u2500 products.db\n\u2502   \u2514\u2500\u2500 images/\n\u2502       \u2514\u2500\u2500 products/\n\u251c\u2500\u2500 config.py\n\u251c\u2500\u2500 main.py\n\u2514\u2500\u2500 requirements.txt\n"})}),"\n",(0,t.jsx)(n.h3,{id:"requirementstxt",children:"requirements.txt"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-txt",children:"playwright==1.40.0\npandas==2.1.0\npillow==10.1.0\nrequests==2.31.0\nsqlalchemy==2.0.23\npython-dotenv==1.0.0\naiofiles==23.2.1\n"})}),"\n",(0,t.jsx)(n.h3,{id:"configpy",children:"config.py"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import os\nfrom datetime import datetime\n\nclass Config:\n    # \ube0c\ub77c\uc6b0\uc800 \uc124\uc815\n    HEADLESS = True\n    TIMEOUT = 30000\n\n    # \ud0c0\uac9f \uc0ac\uc774\ud2b8\n    BASE_URL = 'https://books.toscrape.com'  # \uc608\uc81c \uc0ac\uc774\ud2b8\n    SEARCH_QUERY = 'python'\n\n    # \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc \uc124\uc815\n    DOWNLOAD_IMAGES = True\n    IMAGE_DIR = 'data/images/products'\n    IMAGE_FORMAT = 'jpg'\n    MAX_IMAGE_SIZE = 5 * 1024 * 1024  # 5MB\n\n    # \ub370\uc774\ud130\ubca0\uc774\uc2a4\n    DATABASE_URL = 'sqlite:///data/products.db'\n\n    # \uac00\uaca9 \uc54c\ub9bc\n    PRICE_DROP_THRESHOLD = 0.1  # 10% \uc774\uc0c1 \ud558\ub77d \uc2dc \uc54c\ub9bc\n\n    # \ud06c\ub864\ub9c1 \uc124\uc815\n    MAX_PAGES = 5\n    DELAY_BETWEEN_PAGES = 2\n\n    @classmethod\n    def ensure_directories(cls):\n        \"\"\"\ud544\uc694\ud55c \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131\"\"\"\n        os.makedirs(cls.IMAGE_DIR, exist_ok=True)\n        os.makedirs('data', exist_ok=True)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"scraperimage_downloaderpy",children:"scraper/image_downloader.py"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import requests\nfrom PIL import Image\nimport io\nimport os\nimport hashlib\nimport logging\nfrom pathlib import Path\n\nlogger = logging.getLogger(__name__)\n\nclass ImageDownloader:\n    def __init__(self, save_dir: str):\n        self.save_dir = save_dir\n        os.makedirs(save_dir, exist_ok=True)\n\n    def download_image(self, url: str, product_id: str) -> str:\n        """\uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc"""\n        try:\n            # \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc\n            response = requests.get(url, timeout=10)\n            response.raise_for_status()\n\n            # \uc774\ubbf8\uc9c0 \uac80\uc99d\n            img = Image.open(io.BytesIO(response.content))\n\n            # \ud30c\uc77c\uba85 \uc0dd\uc131 (product_id + hash)\n            url_hash = hashlib.md5(url.encode()).hexdigest()[:8]\n            filename = f"{product_id}_{url_hash}.jpg"\n            filepath = os.path.join(self.save_dir, filename)\n\n            # \uc774\ubbf8\uc9c0 \uc800\uc7a5 (JPEG\ub85c \ubcc0\ud658)\n            if img.mode in (\'RGBA\', \'LA\', \'P\'):\n                # \ud22c\uba85 \ubc30\uacbd\uc744 \ud770\uc0c9\uc73c\ub85c\n                background = Image.new(\'RGB\', img.size, (255, 255, 255))\n                background.paste(img, mask=img.split()[-1] if img.mode == \'RGBA\' else None)\n                img = background\n\n            img.save(filepath, \'JPEG\', quality=85, optimize=True)\n\n            logger.info(f"\u2705 \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc \uc644\ub8cc: {filename}")\n            return filepath\n\n        except Exception as e:\n            logger.error(f"\u274c \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc \uc2e4\ud328: {url} - {e}")\n            return None\n\n    def create_thumbnail(self, image_path: str, size=(200, 200)) -> str:\n        """\uc378\ub124\uc77c \uc0dd\uc131"""\n        try:\n            img = Image.open(image_path)\n            img.thumbnail(size, Image.Resampling.LANCZOS)\n\n            # \uc378\ub124\uc77c \uc800\uc7a5\n            thumb_path = image_path.replace(\'.jpg\', \'_thumb.jpg\')\n            img.save(thumb_path, \'JPEG\', quality=85)\n\n            return thumb_path\n\n        except Exception as e:\n            logger.error(f"\uc378\ub124\uc77c \uc0dd\uc131 \uc2e4\ud328: {e}")\n            return None\n'})}),"\n",(0,t.jsx)(n.h3,{id:"scraperproduct_scraperpy",children:"scraper/product_scraper.py"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from playwright.sync_api import sync_playwright\nfrom typing import List, Dict\nimport logging\nimport time\nimport random\nfrom urllib.parse import urljoin\n\nlogger = logging.getLogger(__name__)\n\nclass ProductScraper:\n    def __init__(self, config):\n        self.config = config\n\n    def scrape(self) -> List[Dict]:\n        \"\"\"\uc0c1\ud488 \uc2a4\ud06c\ub798\ud551\"\"\"\n        logger.info(\"\uc0c1\ud488 \uc2a4\ud06c\ub798\ud551 \uc2dc\uc791\")\n\n        with sync_playwright() as p:\n            browser = p.chromium.launch(headless=self.config.HEADLESS)\n            page = browser.new_page()\n\n            try:\n                products = []\n\n                for page_num in range(1, self.config.MAX_PAGES + 1):\n                    url = f\"{self.config.BASE_URL}/catalogue/page-{page_num}.html\"\n                    logger.info(f\"\ud398\uc774\uc9c0 {page_num} \uc2a4\ud06c\ub798\ud551: {url}\")\n\n                    page.goto(url, timeout=self.config.TIMEOUT)\n\n                    # \uc0c1\ud488 \ucd94\ucd9c\n                    page_products = self._extract_products(page)\n                    products.extend(page_products)\n\n                    logger.info(f\"\ud398\uc774\uc9c0 {page_num}: {len(page_products)}\uac1c \uc0c1\ud488 \uc218\uc9d1\")\n\n                    # \ub300\uae30\n                    if page_num < self.config.MAX_PAGES:\n                        time.sleep(random.uniform(\n                            self.config.DELAY_BETWEEN_PAGES,\n                            self.config.DELAY_BETWEEN_PAGES + 1\n                        ))\n\n                logger.info(f\"\u2705 \ucd1d {len(products)}\uac1c \uc0c1\ud488 \uc218\uc9d1 \uc644\ub8cc\")\n                return products\n\n            finally:\n                browser.close()\n\n    def _extract_products(self, page) -> List[Dict]:\n        \"\"\"\uc0c1\ud488 \uc815\ubcf4 \ucd94\ucd9c\"\"\"\n        products = []\n        product_elements = page.query_selector_all('.product_pod')\n\n        for elem in product_elements:\n            try:\n                product = self._parse_product(elem, page)\n                products.append(product)\n\n            except Exception as e:\n                logger.error(f\"\uc0c1\ud488 \ud30c\uc2f1 \uc2e4\ud328: {e}\")\n                continue\n\n        return products\n\n    def _parse_product(self, elem, page) -> Dict:\n        \"\"\"\uac1c\ubcc4 \uc0c1\ud488 \ud30c\uc2f1\"\"\"\n        # \uc81c\ubaa9\n        title_elem = elem.query_selector('h3 > a')\n        title = title_elem.get_attribute('title') if title_elem else 'N/A'\n\n        # URL\n        url = title_elem.get_attribute('href') if title_elem else ''\n        full_url = urljoin(self.config.BASE_URL, url)\n\n        # \uac00\uaca9\n        price_elem = elem.query_selector('.price_color')\n        price_text = price_elem.inner_text() if price_elem else '\xa30.00'\n        price = float(price_text.replace('\xa3', ''))\n\n        # \uc7ac\uace0 \uc5ec\ubd80\n        stock_elem = elem.query_selector('.availability')\n        in_stock = 'In stock' in (stock_elem.inner_text() if stock_elem else '')\n\n        # \ud3c9\uc810\n        star_elem = elem.query_selector('.star-rating')\n        rating_class = star_elem.get_attribute('class') if star_elem else ''\n        rating_map = {'One': 1, 'Two': 2, 'Three': 3, 'Four': 4, 'Five': 5}\n        rating = 0\n        for word, value in rating_map.items():\n            if word in rating_class:\n                rating = value\n                break\n\n        # \uc774\ubbf8\uc9c0 URL\n        img_elem = elem.query_selector('img')\n        img_url = img_elem.get_attribute('src') if img_elem else ''\n        full_img_url = urljoin(self.config.BASE_URL, img_url)\n\n        # \uc0c1\ud488 ID \uc0dd\uc131 (URL\uc5d0\uc11c \ucd94\ucd9c)\n        import re\n        product_id_match = re.search(r'/([^/]+)_\\d+/index.html', url)\n        product_id = product_id_match.group(1) if product_id_match else str(hash(title))\n\n        return {\n            'product_id': product_id,\n            'title': title,\n            'url': full_url,\n            'price': price,\n            'currency': 'GBP',\n            'in_stock': in_stock,\n            'rating': rating,\n            'image_url': full_img_url\n        }\n"})}),"\n",(0,t.jsx)(n.h3,{id:"scraperprice_trackerpy",children:"scraper/price_tracker.py"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from sqlalchemy import create_engine, Column, Integer, String, Float, Boolean, DateTime\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy.orm import sessionmaker\nfrom datetime import datetime\nimport logging\n\nlogger = logging.getLogger(__name__)\n\nBase = declarative_base()\n\nclass Product(Base):\n    __tablename__ = 'products'\n\n    id = Column(Integer, primary_key=True)\n    product_id = Column(String, unique=True, index=True)\n    title = Column(String)\n    url = Column(String)\n    current_price = Column(Float)\n    previous_price = Column(Float)\n    currency = Column(String)\n    in_stock = Column(Boolean)\n    rating = Column(Integer)\n    image_url = Column(String)\n    image_path = Column(String)\n    first_seen = Column(DateTime, default=datetime.utcnow)\n    last_updated = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)\n\nclass PriceHistory(Base):\n    __tablename__ = 'price_history'\n\n    id = Column(Integer, primary_key=True)\n    product_id = Column(String, index=True)\n    price = Column(Float)\n    in_stock = Column(Boolean)\n    timestamp = Column(DateTime, default=datetime.utcnow)\n\nclass PriceTracker:\n    def __init__(self, database_url: str):\n        self.engine = create_engine(database_url)\n        Base.metadata.create_all(self.engine)\n        self.Session = sessionmaker(bind=self.engine)\n\n    def update_products(self, products: list, image_paths: dict):\n        \"\"\"\uc0c1\ud488 \uc815\ubcf4 \uc5c5\ub370\uc774\ud2b8\"\"\"\n        session = self.Session()\n\n        try:\n            for product_data in products:\n                product_id = product_data['product_id']\n\n                # \uae30\uc874 \uc0c1\ud488 \uc870\ud68c\n                existing = session.query(Product).filter_by(\n                    product_id=product_id\n                ).first()\n\n                if existing:\n                    # \uac00\uaca9 \ubcc0\ub3d9 \ud655\uc778\n                    if existing.current_price != product_data['price']:\n                        logger.info(f\"\uac00\uaca9 \ubcc0\ub3d9: {existing.title} \"\n                                  f\"\xa3{existing.current_price} \u2192 \xa3{product_data['price']}\")\n\n                        # \uac00\uaca9 \ud788\uc2a4\ud1a0\ub9ac \uc800\uc7a5\n                        history = PriceHistory(\n                            product_id=product_id,\n                            price=product_data['price'],\n                            in_stock=product_data['in_stock']\n                        )\n                        session.add(history)\n\n                        # \uac00\uaca9 \uc54c\ub9bc \ud655\uc778\n                        self._check_price_alert(existing, product_data['price'])\n\n                    # \uc5c5\ub370\uc774\ud2b8\n                    existing.previous_price = existing.current_price\n                    existing.current_price = product_data['price']\n                    existing.in_stock = product_data['in_stock']\n                    existing.rating = product_data['rating']\n                    existing.image_path = image_paths.get(product_id)\n\n                else:\n                    # \uc0c8 \uc0c1\ud488 \ucd94\uac00\n                    new_product = Product(\n                        product_id=product_id,\n                        title=product_data['title'],\n                        url=product_data['url'],\n                        current_price=product_data['price'],\n                        previous_price=product_data['price'],\n                        currency=product_data['currency'],\n                        in_stock=product_data['in_stock'],\n                        rating=product_data['rating'],\n                        image_url=product_data['image_url'],\n                        image_path=image_paths.get(product_id)\n                    )\n                    session.add(new_product)\n\n                    # \ud788\uc2a4\ud1a0\ub9ac \ucd94\uac00\n                    history = PriceHistory(\n                        product_id=product_id,\n                        price=product_data['price'],\n                        in_stock=product_data['in_stock']\n                    )\n                    session.add(history)\n\n            session.commit()\n            logger.info(f\"\u2705 \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5c5\ub370\uc774\ud2b8 \uc644\ub8cc: {len(products)}\uac1c \uc0c1\ud488\")\n\n        except Exception as e:\n            session.rollback()\n            logger.error(f\"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5c5\ub370\uc774\ud2b8 \uc2e4\ud328: {e}\")\n            raise\n\n        finally:\n            session.close()\n\n    def _check_price_alert(self, product: Product, new_price: float):\n        \"\"\"\uac00\uaca9 \ud558\ub77d \uc54c\ub9bc\"\"\"\n        if product.current_price > 0:\n            drop_percent = (product.current_price - new_price) / product.current_price\n\n            if drop_percent >= 0.1:  # 10% \uc774\uc0c1 \ud558\ub77d\n                logger.warning(f\"\ud83d\udd14 \uac00\uaca9 \ud558\ub77d \uc54c\ub9bc: {product.title}\")\n                logger.warning(f\"   {drop_percent*100:.1f}% \ud558\ub77d: \"\n                             f\"\xa3{product.current_price} \u2192 \xa3{new_price}\")\n\n    def get_price_history(self, product_id: str) -> list:\n        \"\"\"\uac00\uaca9 \ud788\uc2a4\ud1a0\ub9ac \uc870\ud68c\"\"\"\n        session = self.Session()\n\n        try:\n            history = session.query(PriceHistory).filter_by(\n                product_id=product_id\n            ).order_by(PriceHistory.timestamp).all()\n\n            return [{\n                'price': h.price,\n                'in_stock': h.in_stock,\n                'timestamp': h.timestamp\n            } for h in history]\n\n        finally:\n            session.close()\n\n    def get_top_rated_products(self, limit: int = 10) -> list:\n        \"\"\"\ucd5c\uace0 \ud3c9\uc810 \uc0c1\ud488\"\"\"\n        session = self.Session()\n\n        try:\n            products = session.query(Product).filter(\n                Product.in_stock == True\n            ).order_by(Product.rating.desc()).limit(limit).all()\n\n            return [{\n                'title': p.title,\n                'price': p.current_price,\n                'rating': p.rating,\n                'url': p.url\n            } for p in products]\n\n        finally:\n            session.close()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"mainpy",children:"main.py"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import logging\nfrom datetime import datetime\nfrom config import Config\nfrom scraper.product_scraper import ProductScraper\nfrom scraper.image_downloader import ImageDownloader\nfrom scraper.price_tracker import PriceTracker\n\ndef setup_logger():\n    """\ub85c\uac70 \uc124\uc815"""\n    Config.ensure_directories()\n\n    logging.basicConfig(\n        level=logging.INFO,\n        format=\'%(asctime)s - %(name)s - %(levelname)s - %(message)s\',\n        handlers=[\n            logging.FileHandler(f\'scraper_{datetime.now().strftime("%Y%m%d")}.log\'),\n            logging.StreamHandler()\n        ]\n    )\n\ndef main():\n    setup_logger()\n    logger = logging.getLogger(__name__)\n\n    try:\n        logger.info("="*60)\n        logger.info("\uc1fc\ud551\ubab0 \uc2a4\ud06c\ub798\ud37c \uc2dc\uc791")\n        logger.info("="*60)\n\n        # 1. \uc0c1\ud488 \uc2a4\ud06c\ub798\ud551\n        scraper = ProductScraper(Config)\n        products = scraper.scrape()\n\n        if not products:\n            logger.warning("\uc218\uc9d1\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4")\n            return\n\n        # 2. \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc\n        image_paths = {}\n\n        if Config.DOWNLOAD_IMAGES:\n            logger.info("\uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc \uc2dc\uc791...")\n            downloader = ImageDownloader(Config.IMAGE_DIR)\n\n            for product in products:\n                if product[\'image_url\']:\n                    image_path = downloader.download_image(\n                        product[\'image_url\'],\n                        product[\'product_id\']\n                    )\n\n                    if image_path:\n                        image_paths[product[\'product_id\']] = image_path\n\n                        # \uc378\ub124\uc77c \uc0dd\uc131\n                        downloader.create_thumbnail(image_path)\n\n            logger.info(f"\u2705 {len(image_paths)}\uac1c \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc \uc644\ub8cc")\n\n        # 3. \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc800\uc7a5 \ubc0f \uac00\uaca9 \ucd94\uc801\n        tracker = PriceTracker(Config.DATABASE_URL)\n        tracker.update_products(products, image_paths)\n\n        # 4. \ud1b5\uacc4 \ucd9c\ub825\n        print("\\n" + "="*60)\n        print("\ud83d\udcca \uc2a4\ud06c\ub798\ud551 \uacb0\uacfc")\n        print("="*60)\n        print(f"\ucd1d \uc0c1\ud488 \uc218: {len(products)}")\n        print(f"\uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc: {len(image_paths)}\uac1c")\n\n        # \ucd5c\uace0 \ud3c9\uc810 \uc0c1\ud488\n        top_rated = tracker.get_top_rated_products(5)\n        print("\\n\u2b50 \ucd5c\uace0 \ud3c9\uc810 \uc0c1\ud488 TOP 5:")\n        for idx, product in enumerate(top_rated, 1):\n            print(f"{idx}. {product[\'title\']}")\n            print(f"   \uac00\uaca9: \xa3{product[\'price\']} | \ud3c9\uc810: {product[\'rating\']}")\n\n        print("="*60)\n        logger.info("\u2705 \ubaa8\ub4e0 \uc791\uc5c5 \uc644\ub8cc!")\n\n    except Exception as e:\n        logger.error(f"\u274c \uc5d0\ub7ec \ubc1c\uc0dd: {e}", exc_info=True)\n\nif __name__ == "__main__":\n    main()\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\ufe0f-\uc774\ubbf8\uc9c0-\ucc98\ub9ac-\uae30\ub2a5",children:"\ud83d\uddbc\ufe0f \uc774\ubbf8\uc9c0 \ucc98\ub9ac \uae30\ub2a5"}),"\n",(0,t.jsx)(n.h3,{id:"\uc774\ubbf8\uc9c0-\ub2e4\uc6b4\ub85c\ub4dc",children:"\uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# URL\uc5d0\uc11c \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc\ndownloader = ImageDownloader('data/images')\nimage_path = downloader.download_image(\n    'https://example.com/product.jpg',\n    'product_123'\n)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\uc378\ub124\uc77c-\uc0dd\uc131",children:"\uc378\ub124\uc77c \uc0dd\uc131"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# 200x200 \uc378\ub124\uc77c\nthumb_path = downloader.create_thumbnail(image_path, size=(200, 200))\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\uc774\ubbf8\uc9c0-\ucd5c\uc801\ud654",children:"\uc774\ubbf8\uc9c0 \ucd5c\uc801\ud654"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RGBA \u2192 RGB \ubcc0\ud658 (\ud22c\uba85 \ubc30\uacbd \u2192 \ud770\uc0c9)"}),"\n",(0,t.jsx)(n.li,{children:"JPEG \uc555\ucd95 (quality=85)"}),"\n",(0,t.jsx)(n.li,{children:"\ud30c\uc77c \ud06c\uae30 \ucd5c\uc801\ud654"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"-\ub370\uc774\ud130\ubca0\uc774\uc2a4-\uc2a4\ud0a4\ub9c8",children:"\ud83d\udcca \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc2a4\ud0a4\ub9c8"}),"\n",(0,t.jsx)(n.h3,{id:"products-\ud14c\uc774\ube14",children:"products \ud14c\uc774\ube14"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\ud544\ub4dc"}),(0,t.jsx)(n.th,{children:"\ud0c0\uc785"}),(0,t.jsx)(n.th,{children:"\uc124\uba85"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"product_id"}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"\uc0c1\ud488 ID (\uc720\ub2c8\ud06c)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"title"}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"\uc0c1\ud488\uba85"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"current_price"}),(0,t.jsx)(n.td,{children:"Float"}),(0,t.jsx)(n.td,{children:"\ud604\uc7ac \uac00\uaca9"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"previous_price"}),(0,t.jsx)(n.td,{children:"Float"}),(0,t.jsx)(n.td,{children:"\uc774\uc804 \uac00\uaca9"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"in_stock"}),(0,t.jsx)(n.td,{children:"Boolean"}),(0,t.jsx)(n.td,{children:"\uc7ac\uace0 \uc5ec\ubd80"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"rating"}),(0,t.jsx)(n.td,{children:"Integer"}),(0,t.jsx)(n.td,{children:"\ud3c9\uc810"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"image_url"}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"\uc774\ubbf8\uc9c0 URL"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"image_path"}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"\ub85c\uceec \uc774\ubbf8\uc9c0 \uacbd\ub85c"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"price_history-\ud14c\uc774\ube14",children:"price_history \ud14c\uc774\ube14"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\ud544\ub4dc"}),(0,t.jsx)(n.th,{children:"\ud0c0\uc785"}),(0,t.jsx)(n.th,{children:"\uc124\uba85"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"product_id"}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"\uc0c1\ud488 ID"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"price"}),(0,t.jsx)(n.td,{children:"Float"}),(0,t.jsx)(n.td,{children:"\uac00\uaca9"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"in_stock"}),(0,t.jsx)(n.td,{children:"Boolean"}),(0,t.jsx)(n.td,{children:"\uc7ac\uace0 \uc5ec\ubd80"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"timestamp"}),(0,t.jsx)(n.td,{children:"DateTime"}),(0,t.jsx)(n.td,{children:"\uae30\ub85d \uc2dc\uac04"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"-\uac00\uaca9-\uc54c\ub9bc",children:"\ud83d\udd14 \uac00\uaca9 \uc54c\ub9bc"}),"\n",(0,t.jsx)(n.p,{children:"10% \uc774\uc0c1 \uac00\uaca9 \ud558\ub77d \uc2dc \uc790\ub3d9 \uc54c\ub9bc:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\ud83d\udd14 \uac00\uaca9 \ud558\ub77d \uc54c\ub9bc: Product Name\n   15.0% \ud558\ub77d: \xa320.00 \u2192 \xa317.00\n"})}),"\n",(0,t.jsx)(n.h2,{id:"-\ub2e4\uc74c-\ub2e8\uacc4",children:"\ud83d\udcda \ub2e4\uc74c \ub2e8\uacc4"}),"\n",(0,t.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,t.jsx)(n.a,{href:"./scenario-03-social-media",children:"\uc18c\uc15c \ubbf8\ub514\uc5b4 \ub370\uc774\ud130 \uc218\uc9d1"})]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>c});var i=r(6540);const t={},s=i.createContext(t);function o(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);